var Te=Object.defineProperty;var le=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var de=(t,e,r)=>e in t?Te(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ce=(t,e)=>{for(var r in e||(e={}))Se.call(e,r)&&de(t,r,e[r]);if(le)for(var r of le(e))Ie.call(e,r)&&de(t,r,e[r]);return t};import{c as a,r as q,o as n,a as g,b as k,w as f,d as o,e as w,t as v,F as C,f as _,g as N,n as D,h as S,i as B,v as U,j as E,k as m,l as L,m as H,p as xe,_ as he,q as $e,C as pe,D as me,s as Be,u as De,x as Ue,y as Le,z as Oe,A as Ae,B as Ne,U as Me,E as Ee}from"./vendor.4737d2fb.js";const Je=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};Je();var T=(t,e)=>{const r=t.__vccOpts||t;for(const[l,i]of e)r[l]=i;return r};const Fe={},Ge={class:"backdrop"};function Re(t,e){return n(),a("main",Ge,[q(t.$slots,"default")])}var M=T(Fe,[["render",Re]]),ge="/assets/board.17ad90ee.jpg";const je={components:{backdrop:M},methods:{goToBoard(t){this.$emit("closeCmp"),this.$router.push(`/board/${t}`)}},computed:{boards(){return this.$store.getters.boards}}},Pe={class:"cmp-header"},Ve=o("p",{class:"cmp-container-title"},"Recent",-1),qe=o("span",null,null,-1),He=[qe],We=o("hr",{class:"thin-hr"},null,-1),Ye={class:"recent-boards-list"},ze=["onClick"],Xe=["src"],Qe={key:1,class:"recent-board-preview-img",src:ge},Ze={class:"recent-board-title"};function Ke(t,e,r,l,i,s){const d=g("backdrop");return n(),k(d,{onClick:e[2]||(e[2]=p=>t.$emit("closeCmp"))},{default:f(()=>[o("section",{class:"board-recent",onClick:e[1]||(e[1]=_(()=>{},["stop"]))},[o("div",Pe,[Ve,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=p=>t.$emit("closeCmp"))},He)]),We,o("div",Ye,[(n(!0),a(C,null,w(s.boards,p=>(n(),a("div",{class:"recent-board-preview flex",key:p._id,onClick:u=>s.goToBoard(p._id)},[p.style.bgImg?(n(),a("img",{key:0,class:"recent-board-preview-img",src:p.style.bgImg.urls.thumb},null,8,Xe)):(n(),a("img",Qe)),o("p",Ze,v(p.title),1)],8,ze))),128))])])]),_:1})}var et=T(je,[["render",Ke]]);const tt={},st={class:"list-slot-container"},ot={class:"list-title"},it={class:"slot-options-list"};function rt(t,e){return n(),a("article",st,[o("div",ot,[q(t.$slots,"title")]),o("div",it,[q(t.$slots,"list")])])}var V=T(tt,[["render",rt]]),nt="/assets/groups.80c5d532.svg";const at={data(){return{title:"",bgClr:"",bgImg:"",selectedBg:"",photos:["https://images.unsplash.com/photo-1648138754706-4fccd621a5f9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=Mnw3MDY2fDB8MXxjb2xsZWN0aW9ufDR8MzE3MDk5fHx8fHwyfHwxNjQ4NjUyNTQ3&ixlib=rb-1.2.1&q=80&w=400","https://images.unsplash.com/photo-1648537949908-25fc530b5f7d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=Mnw3MDY2fDB8MXxjb2xsZWN0aW9ufDF8MzE3MDk5fHx8fHwyfHwxNjQ4NjUyNTQ3&ixlib=rb-1.2.1&q=80&w=400","https://images.unsplash.com/photo-1647960666864-01fdaed3431f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=Mnw3MDY2fDB8MXxjb2xsZWN0aW9ufDE0fDMxNzA5OXx8fHx8Mnx8MTY0ODY1MjU0Nw&ixlib=rb-1.2.1&q=80&w=400"],isRequired:!1,bgColors:[{id:"l101",color:"#61bd4f",isSelected:!1},{id:"l102",color:"#f2d600",isSelected:!1},{id:"l103",color:"#ff9f1a",isSelected:!1},{id:"l104",color:"#eb5a46",isSelected:!1},{id:"l105",color:"#c377e0",isSelected:!1},{id:"l106",color:"#0079bf",isSelected:!1},{id:"l107",color:"#00c2e0",isSelected:!1},{id:"l108",color:"#51e898",isSelected:!1},{id:"l109",color:"#ff78cb",isSelected:!1},{id:"l110",color:"#344563",isSelected:!1}]}},methods:{requiredTitle(){this.title||(this.isRequired=!0)},async addBoard(){const t=await this.$store.dispatch({type:"addBoard",title:this.title,bgClr:this.bgClr,bgImg:this.bgImg});this.$router.push(`/board/${t}`),this.$emit("closeCmp")},selectBg(t,e){this[t]=e,this.selectedBg=e}},computed:{required(){return{required:this.isRequired}}},components:{listSlot:V,backdrop:M}},lt={class:"cmp-header"},dt=o("p",{class:"cmp-container-title"},"Create board",-1),ct=o("span",null,null,-1),ut=[ct],ht=o("hr",{class:"thin-hr"},null,-1),pt={class:"choose-bg-container"},mt=o("p",{class:"choose-bg-title"},"Background",-1),gt=o("img",{class:"bg-preview-img",src:nt},null,-1),bt=[gt],_t=["src","onClick"],ft=["onClick"],kt={class:"add-title-container"},vt=o("p",{class:"add-title-title"},"Board title",-1),yt={key:0,class:"add-title-required"},Ct=["disabled"];function wt(t,e,r,l,i,s){const d=g("list-slot"),p=g("backdrop"),u=N("focus");return n(),k(p,{onClick:e[6]||(e[6]=h=>t.$emit("closeCmp"))},{default:f(()=>[o("section",{class:"create-board",onClick:e[5]||(e[5]=_(()=>{},["stop"]))},[o("div",lt,[dt,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=h=>t.$emit("closeCmp"))},ut)]),ht,o("div",pt,[mt,o("div",{class:"bg-preview",style:D({backgroundColor:i.selectedBg,backgroundImage:"url("+i.selectedBg+")"})},bt,4),S(d,null,{list:f(()=>[(n(!0),a(C,null,w(i.photos,(h,c)=>(n(),a("img",{key:c,class:"unsplash-result-small",src:h,alt:"img",onClick:I=>s.selectBg("bgImg",h)},null,8,_t))),128))]),_:1}),S(d,null,{list:f(()=>[(n(!0),a(C,null,w(i.bgColors,h=>(n(),a("div",{key:h.id,class:"label-option flex pointer",style:D({backgroundColor:h.color}),onClick:c=>s.selectBg("bgClr",h.color)},null,12,ft))),128))]),_:1})]),o("div",kt,[vt,B(o("input",{class:E(["add-title-input",s.required]),type:"text","onUpdate:modelValue":e[1]||(e[1]=h=>i.title=h),placeholder:"Enter title..",onBlur:e[2]||(e[2]=(...h)=>s.requiredTitle&&s.requiredTitle(...h)),onFocus:e[3]||(e[3]=h=>i.isRequired=!1)},null,34),[[U,i.title],[u]]),i.isRequired?(n(),a("p",yt," \u{1F44B} Board title is required ")):m("",!0)]),o("button",{class:"create-board-btn",onClick:e[4]||(e[4]=(...h)=>s.addBoard&&s.addBoard(...h)),disabled:!i.title}," Create ",8,Ct)])]),_:1})}var be=T(at,[["render",wt]]);const Tt={props:{user:Object},methods:{},computed:{imgAvatar(){if(this.user.imgUrl)return this.user.imgUrl},nameAvatar(){if(!this.user.imgUrl){const e=this.user.fullname.split(" ");var t="";return e.forEach(r=>{t+=r.charAt(0)}),t.toUpperCase()}}}},St={class:"user-avatar"},It={key:0,class:"user-avatar-guest flex"},xt=["src"],$t={key:2,class:"user-avatar-name flex"};function Bt(t,e,r,l,i,s){return n(),a("div",St,[r.user.username==="Guest"?(n(),a("span",It)):r.user.imgUrl?(n(),a("img",{key:1,class:"user-avatar-img",src:s.imgAvatar},null,8,xt)):(n(),a("span",$t,v(s.nameAvatar),1))])}var G=T(Tt,[["render",Bt]]),Dt="/assets/trello.92b2080b.svg",Ut="/assets/bell.adefe4be.svg";const Lt={data(){return{handles:{isRecent:!1,isCreateBoard:!1},isHome:!0,isBoards:!1,isLogin:!1}},methods:{openCmp(t){if(typeof t!="string"){for(let e in this.handles)this.handles[e]=!1;return}if(this.handles[t]===!0)this.handles[t]=!1;else{for(let e in this.handles)this.handles[e]=!1;this.handles[t]=!0}}},computed:{bgc(){return{blue:this.isBoards||this.isLogin}},currLoggedInUser(){const t=this.$store.getters.loggedinUser;return t&&(this.userLoggedIn=!0),t||this.$store.getters.getGuestUser},userIsLoggedIn(){if(this.$store.getters.loggedinUser)return!0}},watch:{"$route.path":{immediate:!0,handler(){const t=this.$route.path;t==="/"?this.isHome=!0:this.isHome=!1,t==="/login"?this.isLogin=!0:this.isLogin=!1,t==="/board"?this.isBoards=!0:this.isBoards=!1}}},components:{boardRecent:et,createBoard:be,userAvatar:G}},Ot={class:"app-header-inner flex"},At=o("img",{class:"logo-img",src:Dt,alt:""},null,-1),Nt=o("h3",{class:"logo"},"Mellow",-1),Mt={class:"app-header-nav flex"},Et={class:"app-header-left-nav flex"},Jt=L(" Recent "),Ft=o("span",{class:"header-arrow-icon"},null,-1),Gt=[Jt,Ft],Rt=L(" Create "),jt={key:0,class:"header-arrow-icon"},Pt={class:"app-header-right-nav flex"},Vt=L("Log in"),qt=L("Sign up"),Ht=o("button",{class:"header-bell not-clickable"},[o("img",{src:Ut})],-1);function Wt(t,e,r,l,i,s){const d=g("router-link"),p=g("board-recent"),u=g("create-board"),h=g("user-avatar");return n(),a("header",{class:E(["app-header-container",s.bgc])},[o("div",Ot,[S(d,{class:"logo-link flex",to:"/"},{default:f(()=>[At,Nt]),_:1}),o("nav",Mt,[o("div",Et,[!i.isHome&&!i.isLogin&&!i.isBoards?(n(),a("button",{key:0,class:"btn-header flex",onClick:e[0]||(e[0]=c=>t.$router.push("/board"))}," Workspace ")):m("",!0),!i.isHome&&!i.isLogin?(n(),a("button",{key:1,class:"btn-header recent flex",onClick:e[1]||(e[1]=c=>s.openCmp("isRecent"))},Gt)):m("",!0),i.handles.isRecent?(n(),k(p,{key:2,onCloseCmp:s.openCmp},null,8,["onCloseCmp"])):m("",!0),!i.isHome&&!i.isLogin?(n(),a("button",{key:3,class:"btn-header create flex",onClick:e[2]||(e[2]=c=>s.openCmp("isCreateBoard"))},[Rt,i.handles.isCreateBoard?(n(),a("span",jt)):m("",!0)])):m("",!0),i.handles.isCreateBoard?(n(),k(u,{key:4,onCloseCmp:s.openCmp},null,8,["onCloseCmp"])):m("",!0)]),o("div",Pt,[!s.userIsLoggedIn&&!i.isLogin?(n(),a(C,{key:0},[S(d,{class:"login-btn",to:"/login"},{default:f(()=>[Vt]),_:1}),S(d,{class:"signup-btn",to:"/login"},{default:f(()=>[qt]),_:1})],64)):m("",!0),Ht,S(d,{to:"/login",class:"avatar-login-link"},{default:f(()=>[s.currLoggedInUser?(n(),k(h,{key:0,class:"pointer",user:s.currLoggedInUser},null,8,["user"])):m("",!0)]),_:1})])])])],2)}var Yt=T(Lt,[["render",Wt]]);const zt={components:{appHeader:Yt},created(){this.$store.dispatch({type:"loadBoards"}),this.$store.dispatch({type:"loadGuestUser"})}};function Xt(t,e,r,l,i,s){const d=g("app-header"),p=g("router-view");return n(),a(C,null,[S(d),S(p)],64)}var Qt=T(zt,[["render",Xt]]),Zt="/assets/mellow-cover.354e12f4.png",Kt="/assets/example-board.a4540770.png";const es={components:{},data(){return{}},created(){},methods:{},computed:{},unmounted(){}},ts={class:"home-page-container"},ss={class:"title-container"},os=o("h1",{class:"home-logo"}," Mellow helps teams move work forward ",-1),is=o("h3",{class:"title"},"Collaborate, manage projects, and reach new productivity peaks. From high rises to the home office, the way your your team works is unique - accomplish it all with Mellow",-1),rs=o("span",{class:"guest-login-button"},"See Demo",-1),ns=o("div",{class:"homepage-img"},[o("img",{class:"home-page-img",src:Zt})],-1),as=o("div",{class:"secondary-text"},[o("h1",null," It's more than work. It's a way of working together."),o("h3",null,"Start with a Mellow board, lists, and cards. Customize and expand with more features as your teamwork grows. Manage projects, organize tasks, and build team spirit\u2014all in one place."),o("img",{src:Kt,alt:""})],-1);function ls(t,e,r,l,i,s){const d=g("router-link");return n(),a("section",ts,[o("div",ss,[os,is,S(d,{class:"home-link",to:"/board"},{default:f(()=>[rs]),_:1}),ns]),as])}var ds=T(es,[["render",ls]]);const cs={},us={class:"about"},hs=o("h1",null,"This is an about page",-1),ps=[hs];function ms(t,e){return n(),a("div",us,ps)}var gs=T(cs,[["render",ms]]);const F={saveToStorage:bs,loadFromStorage:_s,makeId:ks,getRandomIntInclusive:vs,delay:fs,isDarkColor:ys};function bs(t,e){localStorage.setItem(t,JSON.stringify(e)||null)}function _s(t){let e=localStorage.getItem(t);return e?JSON.parse(e):void 0}function fs(t=1500){return new Promise(e=>{setTimeout(e,t)})}function ks(t=8){for(var e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=0;l<t;l++)e+=r.charAt(Math.floor(Math.random()*r.length));return e}function vs(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1)+t)}function ys(t){if(!t)return;t=t.substring(1);const e=parseInt(t,16),r=e>>16&255,l=e>>8&255,i=e>>0&255;var s=.2126*r+.7152*l+.0722*i;return s<100}const Cs="/api/";var ws=H.create({withCredentials:!0});const A={get(t,e){return P(t,"GET",e)},post(t,e){return P(t,"POST",e)},put(t,e){return P(t,"PUT",e)},delete(t,e){return P(t,"DELETE",e)}};async function P(t,e="GET",r=null){try{return(await ws({url:`${Cs}${t}`,method:e,data:r,params:e==="GET"?r:null})).data}catch(l){throw console.log(`Had Issues ${e}ing to the backend, endpoint: ${t}, with data:`,r),console.dir(l),l.response&&l.response.status,l}}const ue="user-updated",Ts="",O=Ss();O.setup();function Ss(){var t=null;return{async setup(){t=xe(Ts)},on(r,l){t.on(r,l)},off(r,l=null){!t||(l?t.off(r,l):t.removeAllListeners(r))},emit(r,l){t.emit(r,l)},terminate(){t=null}}}const W="loggedinUser",$={login:Ds,logout:Ls,signup:Us,getLoggedinUser:_e,getUsers:Is,getById:xs,remove:$s,update:Bs,getGuestUser:Os,getDefaultMembers:As};async function Is(){return await A.get("user")}async function xs(t){const e=await A.get(`user/${t}`);return gWatchedUser=e,e}function $s(t){return A.delete(`user/${t}`)}async function Bs(t){return t=await A.put(`user/${t._id}`,t),_e()._id===t._id&&Y(t),t}async function Ds(t){const e=await A.post("auth/login",t);if(O.emit("set-user-socket",e._id),e)return Y(e)}async function Us(t){const e=await A.post("auth/signup",t);return O.emit("set-user-socket",e._id),Y(e)}async function Ls(){return sessionStorage.removeItem(W),O.emit("unset-user-socket"),await A.post("auth/logout")}function Y(t){return sessionStorage.setItem(W,JSON.stringify(t)),t}function _e(){return JSON.parse(sessionStorage.getItem(W)||"null")}function Os(){return{_id:"624298a9e48762573484a9e5",username:"Guest",fullname:"Guest User",imgUrl:"../src/assets/svgs/guest.svg"}}function As(){return[{_id:"u105",fullname:"Yoni Lazarus",username:"Yoni",imgUrl:"https://res.cloudinary.com/cajan22a/image/upload/v1648369158/WhatsApp_Image_2022-03-27_at_11.02.12_gmtcrl.jpg"},{_id:"u106",fullname:"Almog Ben-Binyamin",username:"Almog",imgUrl:"https://res.cloudinary.com/cajan22a/image/upload/v1648369158/WhatsApp_Image_2021-12-10_at_16.38.26_sft38h.jpg"},{_id:"u107",fullname:"Zviki Zaks",username:"Zviki",imgUrl:"https://res.cloudinary.com/cajan22a/image/upload/v1648369158/WhatsApp_Image_2022-03-27_at_11.17.15_rq2ja9.jpg"}]}const j="board",J={query:Ns,getById:Ms,remove:Es,save:Js,getEmptyBoard:js,getEmptyGroup:Gs,getEmptyTask:Rs,uploadImg:Fs};async function Ns(t={}){return await A.get(j,t)}async function Ms(t){return await A.get(`${j}/${t}`)}async function Es(t){return await A.delete(`${j}/${t}`)}async function Js(t,e){if(e){e.id=F.makeId(),e.createdAt=Date.now();const l=$.getLoggedinUser()||$.getGuestUser();e.byMember={_id:l._id,fullname:l.fullname,imgUrl:l.imgUrl},t.activities.length>=30&&t.activities.shift(),t.activities.push(e)}const r=t._id?await A.put(`${j}/${t._id}`,t):await A.post(j,t);return O.emit("board updated"),r}async function Fs(t){const e="cajan_22",l="https://api.cloudinary.com/v1_1/cajan22a/image/upload",i=new FormData;return i.append("file",t.target.files[0]),i.append("upload_preset",e),fetch(l,{method:"POST",body:i}).then(s=>s.json()).then(s=>s).catch(s=>console.error(s))}function Gs(){return{id:"g-"+F.makeId(),title:"Enter Group Name",tasks:[],style:{}}}function Rs(){return{id:"t-"+F.makeId(),title:"",createdAt:Date.now(),style:{},attachments:[]}}function js(){return{title:"",isFavorite:!1,createdAt:Date.now(),archivedAt:null,createdBy:$.getLoggedinUser()||$.getGuestUser(),style:{bgClr:"",bgImg:""},labels:[],members:$.getDefaultMembers(),groups:[],activities:[]}}function Ps(t,e){const r=({detail:l})=>{e(l)};return window.addEventListener(t,r),()=>{window.removeEventListener(t,r)}}function Vs(t,e){window.dispatchEvent(new CustomEvent(t,{detail:e}))}const qs={on:Ps,emit:Vs},Hs={props:{imgUrls:Array},components:{backdrop:M},data(){return{isLoading:!1,input:null}},methods:{onAttachImg(t){this.isLoading=!0,this.$emit("attachImg",t),this.isLoading=!1},closeCmp(){this.$emit("closeCmp")}}},Ws={class:"attachment-preview cmp-preview"},Ys={class:"cmp-header"},zs=o("span",null,null,-1),Xs=[zs],Qs=o("p",{class:"attach-from"},"Attach from...",-1),Zs=o("hr",{class:"thin-hr"},null,-1),Ks=o("div",{class:"pointer"},"Computer",-1),eo=o("hr",{class:"thin-hr"},null,-1),to=o("div",{class:"attach-link-title"},"Attach a link",-1),so=o("div",{class:"attach-preview"},null,-1);function oo(t,e,r,l,i,s){const d=g("backdrop"),p=N("focus");return n(),k(d,{onClick:s.closeCmp},{default:f(()=>[o("section",Ws,[o("div",Ys,[o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=(...u)=>s.closeCmp&&s.closeCmp(...u))},Xs)]),o("label",null,[o("input",{type:"file",onChange:e[1]||(e[1]=(...u)=>s.onAttachImg&&s.onAttachImg(...u)),hidden:""},null,32),Qs,Zs,Ks]),eo,to,B(o("input",{"onUpdate:modelValue":e[2]||(e[2]=u=>i.input=u),class:"attach-input",type:"text",placeholder:"Paste any link here..."},null,512),[[p],[U,i.input]]),o("button",{class:"attach-link-btn",onClick:e[3]||(e[3]=(...u)=>t.showLink&&t.showLink(...u))},"Attach"),so])]),_:1},8,["onClick"])}var io=T(Hs,[["render",oo]]);const ro={name:"date-preview",props:{dueDate:String},components:{backdrop:M},created(){this.date.dueDate=this.dueDate},data(){return{date:{dueDate:null,isCompleted:!1}}},methods:{saveDate(){this.$emit("saveDate",this.date)},closeCmp(){this.date.dueDate=this.dueDate,this.$emit("closeCmp")}}},no={class:"date-header"},ao=o("h3",{class:"date-title"},"Dates",-1),lo=o("hr",{class:"thin-hr"},null,-1);function co(t,e,r,l,i,s){const d=g("v-date-picker"),p=g("backdrop");return n(),k(p,{onClick:s.closeCmp},{default:f(()=>[o("section",{class:"date-preview pointer",onClick:e[4]||(e[4]=_(()=>{},["stop"]))},[o("div",no,[ao,o("button",{class:"add-task-close-cmp-btn",onClick:e[0]||(e[0]=(...u)=>s.closeCmp&&s.closeCmp(...u))})]),lo,S(d,{modelValue:i.date.dueDate,"onUpdate:modelValue":e[1]||(e[1]=u=>i.date.dueDate=u),mode:"dateTime","minute-increment":5},null,8,["modelValue"]),o("button",{class:"save-btn date-btn",onClick:e[2]||(e[2]=(...u)=>s.saveDate&&s.saveDate(...u))},"Save"),o("button",{class:"remove-date-btn date-btn",onClick:e[3]||(e[3]=(...u)=>s.closeCmp&&s.closeCmp(...u))},"Remove")])]),_:1},8,["onClick"])}var uo=T(ro,[["render",co]]);const ho={components:{backdrop:M},props:{type:String},methods:{closeCmp(){this.$emit("closeCmp")},remove(){this.$emit("remove")}}},po={class:"delete-header flex"},mo={class:"cmp-header-title"},go=o("hr",{class:"thin-hr"},null,-1),bo={class:"delete-content-container"},_o={key:0},fo={key:1},ko={key:2};function vo(t,e,r,l,i,s){const d=g("backdrop");return n(),k(d,{onClick:s.closeCmp},{default:f(()=>[o("section",{class:"delete-preview",onClick:e[2]||(e[2]=_(()=>{},["stop"]))},[o("div",po,[o("span",mo,"Delete "+v(r.type)+"?",1),o("a",{onClick:e[0]||(e[0]=(...p)=>s.closeCmp&&s.closeCmp(...p)),class:"close-delete pointer"})]),go,o("div",bo,[r.type==="task"||r.type==="list"?(n(),a("p",_o," All actions will be removed from the activity feed and you won\u2019t be able to re-open the card. There is no undo. ")):r.type==="label"?(n(),a("p",fo," There is no undo. This will remove this label from all cards and destroy its history. ")):r.type==="checklist"?(n(),a("p",ko,"Deleting a checklist is permanent and there is no way to get it back.")):m("",!0),o("a",{onClick:e[1]||(e[1]=(...p)=>s.remove&&s.remove(...p)),class:"confirm-delete"},"Delete")])])]),_:1},8,["onClick"])}var z=T(ho,[["render",vo]]);const yo={props:{boardLabels:Array,taskLabelIds:Array},emits:["addLabelToTask","addLabelToBoard","updateBoardLabels"],components:{listSlot:V,deleteCmp:z,backdrop:M},data(){return{labels:[],filterTxt:"",defaultLabels:[{id:"l101",color:"#61bd4f",title:"",isSelected:!1},{id:"l102",color:"#f2d600",title:"",isSelected:!1},{id:"l103",color:"#ff9f1a",title:"",isSelected:!1},{id:"l104",color:"#eb5a46",title:"",isSelected:!1},{id:"l105",color:"#c377e0",title:"",isSelected:!1},{id:"l106",color:"#0079bf",title:"",isSelected:!1},{id:"l107",color:"#00c2e0",title:"",isSelected:!1},{id:"l108",color:"#51e898",title:"",isSelected:!1},{id:"l109",color:"#ff78cb",title:"",isSelected:!1},{id:"l110",color:"#344563",title:"",isSelected:!1}],isCreate:!1,isChange:!1,isRemove:!1,selectedLabel:null,labelToChange:{color:null,title:""}}},created(){this.aggregateLabels()},methods:{toggleLabel(t){this.$emit("addLabelToTask",t)},closeCmp(){this.$emit("closeCmp")},aggregateLabels(){this.labels=[],this.labels=this.boardLabels.map(t=>{var e;return t=JSON.parse(JSON.stringify(t)),(e=this.taskLabelIds)!=null&&e.includes(t.id)&&(t.inTask=!0),t})},openCreate(t){if(typeof t=="string"){this.labelToChange=JSON.parse(JSON.stringify(this.boardLabels.find(r=>r.id===t)));const e=this.defaultLabels.find(r=>r.color===this.labelToChange.color);this.selectLabel(e.id),this.isChange=!0;return}this.isCreate=!0},selectLabel(t){this.defaultLabels.forEach(r=>{r.isSelected=r.id===t});const e=this.defaultLabels.find(r=>r.id===t);this.labelToChange.color=e.color},async changeBoardLabels(){const t=JSON.parse(JSON.stringify(this.labelToChange));this.isCreate&&(t.id="l"+F.makeId()),await this.$emit("updateBoardLabels",t),this.aggregateLabels(),this.isCreate=!1,this.isChange=!1},async removeLabelFromBoard(){const t=this.labelToChange.id;await this.$emit("updateBoardLabels",t),this.aggregateLabels(),this.isCreate=!1,this.isChange=!1,this.isRemove=!1}},computed:{getLabels(){const t=new RegExp(this.filterTxt,"i");return this.labels.filter(e=>t.test(e.title))},cmpTitle(){return this.isChange?"Change label":this.isCreate?"Create label":"Labels"},createBtn(){if(this.isCreate)return"Create";if(this.isChange)return"Save"}},watch:{taskLabelIds(){this.aggregateLabels()},boardLabels(){this.aggregateLabels()}}},Co={class:"cmp-header"},wo=o("span",null,null,-1),To=[wo],So={class:"cmp-container-title"},Io=o("span",null,null,-1),xo=[Io],$o=o("hr",{class:"thin-hr"},null,-1),Bo={key:0,class:"select-label-container"},Do={class:"choose-labels-container"},Uo=o("p",{class:"labels-title"},"Labels",-1),Lo={class:"labels-list flex clean-list"},Oo=["onClick"],Ao={class:"label-title"},No={key:0,class:"v-icon"},Mo=["onClick"],Eo=o("a",null,null,-1),Jo=[Eo],Fo={key:1,class:"create-label-container"},Go=o("p",{class:"labels-title"},"Name",-1),Ro=L("Select a color"),jo=["onClick"],Po={key:0,class:"v-icon"},Vo={class:"create-label-buttons-container flex"};function qo(t,e,r,l,i,s){const d=g("list-slot"),p=g("delete-cmp"),u=g("backdrop"),h=N("focus");return n(),k(u,{onClick:s.closeCmp},{default:f(()=>[i.isRemove?(n(),k(p,{key:1,type:"label",onRemove:s.removeLabelFromBoard,onCloseCmp:s.closeCmp,onClick:e[8]||(e[8]=_(()=>{},["stop"]))},null,8,["onRemove","onCloseCmp"])):(n(),a("section",{key:0,class:"cmp-preview",onClick:e[7]||(e[7]=_(()=>{},["stop"]))},[o("div",Co,[i.isCreate||i.isChange||i.isRemove?(n(),a("a",{key:0,class:"back-to-cmp-btn",onClick:e[0]||(e[0]=c=>(i.isCreate=!1,i.isChange=!1))},To)):m("",!0),o("p",So,v(s.cmpTitle),1),o("a",{class:"close-cmp-btn",onClick:e[1]||(e[1]=(...c)=>s.closeCmp&&s.closeCmp(...c))},xo)]),$o,!i.isCreate&&!i.isChange&&!i.isRemove?(n(),a("section",Bo,[B(o("input",{class:"label-input",type:"text","onUpdate:modelValue":e[2]||(e[2]=c=>i.filterTxt=c),placeholder:"Search labels.."},null,512),[[U,i.filterTxt],[h]]),o("div",Do,[Uo,o("ul",Lo,[(n(!0),a(C,null,w(s.getLabels,c=>(n(),a("li",{class:"label-option-container flex",key:c.id},[o("div",{class:"label-option flex pointer",style:D({backgroundColor:c.color}),onClick:I=>s.toggleLabel(c.id)},[o("span",Ao,v(c.title),1),c.inTask?(n(),a("span",No)):m("",!0)],12,Oo),o("span",{class:"change-label-btn",onClick:I=>s.openCreate(c.id)},Jo,8,Mo)]))),128))])]),o("button",{class:"open-create-label-btn",onClick:e[3]||(e[3]=(...c)=>s.openCreate&&s.openCreate(...c))}," Create a new label ")])):(n(),a("section",Fo,[o("label",null,[Go,B(o("input",{type:"text",class:"label-input","onUpdate:modelValue":e[4]||(e[4]=c=>i.labelToChange.title=c)},null,512),[[U,i.labelToChange.title],[h]])]),S(d,null,{title:f(()=>[Ro]),list:f(()=>[(n(!0),a(C,null,w(i.defaultLabels,c=>(n(),a("div",{key:c.id,class:"label-option flex pointer",style:D({backgroundColor:c.color}),onClick:I=>s.selectLabel(c.id)},[c.isSelected?(n(),a("span",Po)):m("",!0)],12,jo))),128))]),_:1}),o("div",Vo,[o("button",{class:"create-label-btn",onClick:e[5]||(e[5]=_((...c)=>s.changeBoardLabels&&s.changeBoardLabels(...c),["stop"]))},v(s.createBtn),1),i.isChange?(n(),a("button",{key:0,class:"delete-label-btn",onClick:e[6]||(e[6]=_(c=>i.isRemove=!0,["stop"]))}," Delete ")):m("",!0)])]))]))]),_:1},8,["onClick"])}var Ho=T(yo,[["render",qo]]);const Wo={props:{boardMembers:Object,task:Object},components:{userAvatar:G,backdrop:M},data(){return{members:[],filterTxt:""}},created(){this.aggregateMembers()},methods:{closeCmp(){this.$emit("closeCmp")},toggleMemberInTask(t){this.$emit("toggleMemberInTask",t)},aggregateMembers(){var e;this.members=[];let t=(e=this.task.members)==null?void 0:e.map(r=>r._id);this.boardMembers.forEach(r=>{t!=null&&t.includes(r._id)&&(r.isCheck=!0),this.members.push(JSON.parse(JSON.stringify(r)))})}},computed:{getMembers(){const t=new RegExp(this.filterTxt,"i");return this.members.filter(e=>t.test(e.fullname))}},watch:{task:{handler(){this.aggregateMembers()},deep:!0}}},Yo={class:"cmp-header"},zo=o("p",{class:"cmp-container-title"},"Members",-1),Xo=o("span",null,null,-1),Qo=[Xo],Zo=o("hr",{class:"thin-hr"},null,-1),Ko={class:"members-container"},ei={class:"input-container"},ti=o("h4",{class:"members-preview-title"},"Board members",-1),si={class:"board-members-container"},oi=["onClick"],ii={class:"member-fullname"},ri={key:0,class:"member-check"},ni=o("div",null,null,-1);function ai(t,e,r,l,i,s){const d=g("user-avatar"),p=g("backdrop"),u=N("focus");return n(),k(p,{onClick:s.closeCmp},{default:f(()=>[o("section",{class:"members-preview cmp-preview",onClick:e[2]||(e[2]=_(()=>{},["stop"]))},[o("div",Yo,[zo,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=(...h)=>s.closeCmp&&s.closeCmp(...h))},Qo)]),Zo,o("div",Ko,[o("div",ei,[B(o("input",{"onUpdate:modelValue":e[1]||(e[1]=h=>i.filterTxt=h),class:"members-filter",type:"text",placeholder:"Search Members"},null,512),[[u],[U,i.filterTxt]])]),ti,o("ul",si,[(n(!0),a(C,null,w(s.getMembers,(h,c)=>(n(),a("li",{class:"board-member pointer",key:c,onClick:I=>s.toggleMemberInTask(h)},[S(d,{user:h},null,8,["user"]),o("div",ii,v(h.fullname)+v(`(${h.username})`),1),h.isCheck?(n(),a("div",ri)):m("",!0)],8,oi))),128)),ni])])])]),_:1},8,["onClick"])}var li=T(Wo,[["render",ai]]);const di={name:"cover-unsplash",components:{listSlot:V,backdrop:M},props:{style:Object,title:String,attachments:Array},data(){return{currStyle:{bgClr:"",bgImg:"",isFullCover:!1,uploadedImg:""},photos:[],currTitle:"",searchingUnsplash:!1,searchResults:!1,search:"",photo_url:null,download_url:null,searchTerms:["Productivity","Perspective","Organization","Colorful","Nature","Business","Minimal","Space","Animals"],bgColors:[{id:"l101",color:"#61bd4f",isSelected:!1},{id:"l102",color:"#f2d600",isSelected:!1},{id:"l103",color:"#ff9f1a",isSelected:!1},{id:"l104",color:"#eb5a46",isSelected:!1},{id:"l105",color:"#c377e0",isSelected:!1},{id:"l106",color:"#0079bf",isSelected:!1},{id:"l107",color:"#00c2e0",isSelected:!1},{id:"l108",color:"#51e898",isSelected:!1},{id:"l109",color:"#ff78cb",isSelected:!1},{id:"l110",color:"#344563",isSelected:!1}]}},created(){this.currStyle=JSON.parse(JSON.stringify(this.style)),this.currTitle=this.title,this.searchPhoto(this.title)},methods:{searchPhoto(t){const e="Y2X6Y_wdMpqvaYX_4jgO-dOBqVAsQMQpihsIFNOAX5E";let r=20,l=t;l||(l=(this==null?void 0:this.search)||"business"),H.get(`https://api.unsplash.com/search/photos?page=1&per_page=${r}&query=${l}&client_id=${e}`).then(i=>{this.photos=i.data.results}).catch(i=>{console.log(i)})},searchPhotoWithButton(t){this.searchResults=!0,this.searchPhoto(t)},applyPhoto(t){var e;this.currStyle.uploadedImg=((e=t==null?void 0:t.urls)==null?void 0:e.small)||t,this.currStyle.bgClr="",this.currStyle.bgImg="",this.searchResults=!1,this.searchingUnsplash=!1,this.search="",this.$emit("addStyle",this.currStyle)},waitSearch:he.debounce(function(){this.searchPhoto(),this.searchResults=!0,this.search=""},1e3),selectBgClr(t){this.currStyle.bgClr=t,this.currStyle.bgImg="",this.currStyle.uploadedImg="",this.$emit("addStyle",this.currStyle)},removeCover(){this.currStyle.bgClr="",this.currStyle.bgImg="",this.currStyle.uploadedImg="",this.$emit("addStyle",this.currStyle)},closeCmp(){this.$emit("closeCmp")},setFullCover(t){this.currStyle.isFullCover=t,this.$emit("addStyle",this.currStyle)},async onAttachImg(t){const e=await this.$store.dispatch({type:"attachImg",ev:t});this.currStyle.uploadedImg=e.url,this.currStyle.bgClr="",this.currStyle.bgImg="",this.$emit("addStyle",this.currStyle)}},computed:{pageTitle(){return this.searchingUnsplash?"Photo search":"Cover"},currCoverImg(){var t,e;return((t=this.style)==null?void 0:t.bgImg)||((e=this.style)==null?void 0:e.uploadedImg)||""},currCoverBg(){var e;return{"background-color":((e=this.style)==null?void 0:e.bgClr)||""}},deletable(){if(this.style.bgImg||this.style.uploadedImg||this.style.bgClr)return!0}}},ci={class:"cmp-header"},ui=o("span",null,null,-1),hi=[ui],pi={class:"cmp-container-title"},mi=o("span",null,null,-1),gi=[mi],bi=o("hr",{class:"thin-hr"},null,-1),_i={key:0,class:"main-cover-screen"},fi=o("p",{class:"labels-title"},"Size",-1),ki={class:"cover-size-select"},vi=["src"],yi=o("div",{class:"over-full-cover-select"},null,-1),Ci=o("div",{class:"dummy title"},null,-1),wi=o("div",{class:"dummy text"},null,-1),Ti=["src"],Si=o("div",{class:"over-full-cover-select"},null,-1),Ii=o("div",{class:"dummy title"},null,-1),xi=o("div",{class:"dummy text"},null,-1),$i=L("Color"),Bi=["onClick"],Di=L("Attachments"),Ui=["src","onClick"],Li=o("div",{class:"unsplash-btn full-width-btn pointer"},"Upload a cover image",-1),Oi=L("Photos from Unsplash"),Ai=["src","onClick"],Ni={key:1,class:"search-unsplash-screen"},Mi=L("Suggested searches"),Ei=["onClick"],Ji=L("Top photos"),Fi=["src","onClick"],Gi={key:2,class:"unsplash-results-screen"},Ri=["src","onClick"];function ji(t,e,r,l,i,s){const d=g("list-slot"),p=g("backdrop");return n(),k(p,{onClick:s.closeCmp},{default:f(()=>[o("section",{class:"cmp-preview cover-unsplash-preview",onClick:e[9]||(e[9]=_(()=>{},["stop"]))},[o("div",ci,[i.searchingUnsplash?(n(),a("a",{key:0,class:"back-to-cmp-btn",onClick:e[0]||(e[0]=u=>(i.searchingUnsplash=!1,i.searchResults=!1))},hi)):m("",!0),o("p",pi,v(s.pageTitle),1),o("a",{class:"close-cmp-btn",onClick:e[1]||(e[1]=(...u)=>s.closeCmp&&s.closeCmp(...u))},gi)]),bi,i.searchingUnsplash?m("",!0):(n(),a("section",_i,[fi,o("div",ki,[o("button",{class:"coverSelect pointer",onClick:e[2]||(e[2]=u=>s.setFullCover(!1))},[s.currCoverImg?(n(),a("img",{key:0,class:"coverSelectImg top",src:s.currCoverImg,alt:""},null,8,vi)):m("",!0),s.currCoverBg?(n(),a("div",{key:1,class:"coverSelectImg top",style:D(s.currCoverBg)},null,4)):m("",!0),yi,Ci,wi]),o("button",{class:"coverSelect pointer",onClick:e[3]||(e[3]=u=>s.setFullCover(!0))},[s.currCoverImg?(n(),a("img",{key:0,class:"coverSelectImg",src:s.currCoverImg,alt:""},null,8,Ti)):m("",!0),s.currCoverBg?(n(),a("div",{key:1,class:"coverSelectImg",style:D(s.currCoverBg)},null,4)):m("",!0),Si,Ii,xi])]),s.deletable?(n(),a("div",{key:0,onClick:e[4]||(e[4]=(...u)=>s.removeCover&&s.removeCover(...u)),class:"unsplash-btn full-width-btn remove-cover pointer"},"Remove cover ")):m("",!0),S(d,null,{title:f(()=>[$i]),list:f(()=>[(n(!0),a(C,null,w(i.bgColors,u=>(n(),a("div",{key:u.id,class:"label-option flex pointer",style:D({backgroundColor:u.color}),onClick:h=>s.selectBgClr(u.color)},null,12,Bi))),128))]),_:1}),o("section",null,[S(d,null,{title:f(()=>[Di]),list:f(()=>{var u;return[(n(!0),a(C,null,w((u=r.attachments)==null?void 0:u.slice(0,6),(h,c)=>(n(),a("img",{key:c,class:"unsplash-result-small pointer",src:h,alt:"img",onClick:I=>s.applyPhoto(h)},null,8,Ui))),128))]}),_:1}),o("label",null,[o("input",{type:"file",onChange:e[5]||(e[5]=(...u)=>s.onAttachImg&&s.onAttachImg(...u)),hidden:""},null,32),Li])]),S(d,null,{title:f(()=>[Oi]),list:f(()=>[(n(!0),a(C,null,w(i.photos.slice(0,6),u=>(n(),a("img",{key:u.id,class:"unsplash-result-small pointer",src:u.urls.thumb,alt:"img",onClick:h=>s.applyPhoto(u)},null,8,Ai))),128))]),_:1}),o("button",{class:"unsplash-btn full-width-btn pointer",onClick:e[6]||(e[6]=u=>i.searchingUnsplash=!0)},"Search for photos")])),i.searchingUnsplash&&!i.searchResults?(n(),a("section",Ni,[B(o("input",{type:"text",placeholder:"Search Unsplash for photos",class:"unsplash-search","onUpdate:modelValue":e[7]||(e[7]=u=>i.search=u),onInput:e[8]||(e[8]=(...u)=>s.waitSearch&&s.waitSearch(...u))},null,544),[[U,i.search]]),S(d,null,{title:f(()=>[Mi]),list:f(()=>[(n(!0),a(C,null,w(i.searchTerms,(u,h)=>(n(),a("button",{class:"unsplash-btn pointer",key:h,onClick:c=>s.searchPhotoWithButton(u)},v(u),9,Ei))),128))]),_:1}),S(d,null,{title:f(()=>[Ji]),list:f(()=>[(n(!0),a(C,null,w(i.photos.slice(0,12),u=>(n(),a("img",{key:u.id,class:"unsplash-result-small pointer",src:u.urls.thumb,alt:"img",onClick:h=>s.applyPhoto(u)},null,8,Fi))),128))]),_:1})])):m("",!0),i.searchResults?(n(),a("section",Gi,[S(d,null,{list:f(()=>[(n(!0),a(C,null,w(i.photos,u=>(n(),a("img",{key:u.id,class:"unsplash-result-large pointer",src:u.urls.thumb,alt:"img",onClick:h=>s.applyPhoto(u)},null,8,Ri))),128))]),_:1})])):m("",!0)])]),_:1},8,["onClick"])}var Pi=T(di,[["render",ji]]);const Vi={data(){return{title:"Checklist"}},methods:{closeCmp(){this.$emit("closeCmp")},addChecklist(){this.$emit("createChecklist",this.title)}},components:{backdrop:M}},qi={class:"checklist-header flex"},Hi=o("span",{class:"cmp-header-title"},"Add checklist",-1),Wi=o("hr",{class:"thin-hr"},null,-1),Yi={class:"create-checklist-form"},zi=o("label",{class:"form-title",for:"txt"},"Title",-1),Xi=o("button",{class:"create-form-done pointer"},"Add",-1);function Qi(t,e,r,l,i,s){const d=g("backdrop"),p=N("focus");return n(),k(d,{onClick:s.closeCmp},{default:f(()=>[o("section",{class:"create-checklist-container",onClick:e[3]||(e[3]=_(()=>{},["stop"]))},[o("div",qi,[Hi,o("a",{onClick:e[0]||(e[0]=(...u)=>s.closeCmp&&s.closeCmp(...u)),class:"close-checklist pointer"})]),Wi,o("div",Yi,[o("div",null,[zi,o("form",{onSubmit:e[2]||(e[2]=_(u=>s.addChecklist(i.title),["prevent"]))},[B(o("input",{class:"checklist-form","onUpdate:modelValue":e[1]||(e[1]=u=>i.title=u),type:"text",name:"txt",id:"txt"},null,512),[[U,i.title],[p]]),Xi],32)])])])]),_:1},8,["onClick"])}var Zi=T(Vi,[["render",Qi]]);const Ki={props:{task:Object},data(){return{isCreateTodo:!1,newTodo:[],isCheckbox:[],isUpdateTodo:!1,editingTodoId:"",addNewTodo:"",isDonePercentages:[],todoCount:[],isRemove:!1,checklistId:""}},methods:{createTodo(t){this.addNewTodo=t},addTodo(t){console.log(this.newTodo),!(!this.newTodo||!this.newTodo.length)&&(this.$emit("addTodo",this.newTodo,t),this.newTodo="")},removeChecklist(t){this.$emit("removeChecklist",t)},updateTodo(t,e,r){r.stopPropagation();const l=r.currentTarget.textContent;if(!l||!l.length){this.editingTodoId="",this.addNewTodo="";return}this.$emit("updateTodo",t,e,l),this.editingTodoId="",this.addNewTodo=""},removeTodo(t,e){this.$emit("removeTodo",t,e)},openUpdateBar(t){this.editingTodoId=t,this.addNewTodo=""},closeCreateTodo(){this.editingTodoId="",this.addNewTodo=""},checkboxValue(t,e,r){const l=e.id,i=r.target.checked;this.$emit("updateTodoDone",t,l,i)}},computed:{progressBar(){let t=[];return this.task.checklists.forEach(e=>{let r=0,l=e.todos.length;if(l===0){t.push(0);return}e.todos.forEach(s=>{s.isDone&&r++});const i=r/l*100;t.push(i.toFixed(0))}),this.isDonePercentages=t,t},todoDone(){return this.task.checklists.forEach(t=>{t.todos.filter(e=>{if(e.isDone)return"task-done"})})}}},er={key:0,class:"td-checklist-preview"},tr={class:"checklist-title-container"},sr={class:"checklist-title"},or=["onClick"],ir={class:"progress-bar-percentage"},rr={class:"progress-bar-container flex"},nr={class:"checklist-pb-full"},ar={class:"checklist-todo-title"},lr=o("label",{class:"todo-content-edit pointer",for:"todo.id"},null,-1),dr=["onClick","checked"],cr=["onClick","onBlur","onUpdate:modelValue"],ur={key:0,class:"update-todo-btn-container"},hr={class:"update-todo-btn flex"},pr=o("a",{class:"update-todo-text btn"},"Save",-1),mr={class:"remove-todo-btn-wrapper"},gr=["onMousedown"],br={key:0,class:"add-todo-container"},_r=["onClick"],fr={class:"todo-btn-container"},kr=["onClick"],vr={class:"close-btn-wrapper"};function yr(t,e,r,l,i,s){const d=N("focus");return r.task?(n(),a("section",er,[(n(!0),a(C,null,w(r.task.checklists,(p,u)=>(n(),a("div",{key:u},[o("div",tr,[o("h3",sr,v(p.title),1),o("a",{class:"delete-checklist btn",onClick:_(h=>s.removeChecklist(p.id),["stop"])},"Delete",8,or)]),o("span",ir,v(s.progressBar[u])+"%",1),o("div",rr,[o("div",nr,[o("div",{class:E(["checklist-progress-bar",{green:s.progressBar[u]==="100"}]),style:D({width:s.progressBar[u]+"%",opacity:s.progressBar[u]})},null,6)])]),(n(!0),a(C,null,w(p.todos,h=>(n(),a("div",{key:h.id},[o("div",ar,[lr,o("input",{onClick:_(c=>s.checkboxValue(p.id,h,c),["stop"]),class:"checkbox-input pointer",type:"checkbox",name:"todo.isDone",id:"todo.id",value:"todo.isDone",checked:h.isDone},null,8,dr),B(o("textarea",{onClick:_(c=>s.openUpdateBar(h.id),["stop"]),class:"todo-clickable-area",onBlur:c=>s.updateTodo(p.id,h.id,c),spellcheck:"false",cols:"100",rows:"20","onUpdate:modelValue":c=>h.title=c,ref_for:!0,ref:"textarea"},null,40,cr),[[U,h.title]]),i.editingTodoId===h.id?(n(),a("div",ur,[o("div",hr,[pr,o("span",{onClick:e[0]||(e[0]=(...c)=>s.closeCreateTodo&&s.closeCreateTodo(...c)),class:"close-update pointer"})]),o("div",mr,[o("span",{onMousedown:c=>s.removeTodo(p.id,h.id),class:"remove-todo-btn pointer"},null,40,gr)])])):m("",!0)])]))),128)),i.addNewTodo?m("",!0):(n(),a("div",br,[o("button",{class:"add-an-item btn",onClick:_(h=>s.createTodo(p.id),["stop"])},"Add an item",8,_r)])),i.addNewTodo===p.id?(n(),a("div",{key:1,class:"add-item-container",onBlur:e[3]||(e[3]=(...h)=>s.createTodo&&s.createTodo(...h))},[o("div",null,[B(o("textarea",{class:"add-item-input",placeholder:"Add an item",type:"text","onUpdate:modelValue":e[1]||(e[1]=h=>i.newTodo=h),cols:"30",rows:"10"},null,512),[[d],[U,i.newTodo]]),o("div",fr,[o("button",{class:"add-todo btn",onClick:_(h=>s.addTodo(p.id),["stop"])},"Add",8,kr),o("div",vr,[o("a",{onClick:e[2]||(e[2]=_((...h)=>s.closeCreateTodo&&s.closeCreateTodo(...h),["stop"])),class:"close-add-todo-btn pointer"})])])])],32)):m("",!0)]))),128))])):m("",!0)}var Cr=T(Ki,[["render",yr]]);const wr={props:{activity:Object},data(){return{guestUser:$.getGuestUser()}},computed:{activityTime(){return $e(new Date(this.activity.createdAt),new Date(Date.now()),{includeSeconds:!0,addSuffix:!0})}},components:{userAvatar:G}},Tr={class:"activity-preview flex"},Sr={class:"activity-details flex"},Ir={class:"activity-username-txt-container flex"},xr={class:"activity-username"},$r={class:"activity-txt"},Br={class:"activity-time"};function Dr(t,e,r,l,i,s){var p;const d=g("user-avatar");return n(),a("section",Tr,[S(d,{user:r.activity.byMember||i.guestUser},null,8,["user"]),o("div",Sr,[o("div",Ir,[o("h3",xr,v(((p=r.activity.byMember)==null?void 0:p.fullname)||i.guestUser.fullname),1),o("p",$r,v(r.activity.txt),1)]),o("p",Br,v(s.activityTime),1)])])}var fe=T(wr,[["render",Dr]]);const Ur={name:"attached-img-preview",props:{attachment:String,idx:Number},methods:{deleteAttachment(){this.$emit("deleteAttachment",this.idx)},makeCover(){this.$emit("makeCover",this.attachment)}}},Lr={class:"attached-img-preview"},Or=["src"],Ar={class:"attachment-options-container flex"},Nr=o("div",{class:"make-cover-icon"},null,-1);function Mr(t,e,r,l,i,s){return n(),a("section",Lr,[o("img",{src:r.attachment,alt:""},null,8,Or),o("div",Ar,[Nr,o("p",{class:"make-cover pointer",onClick:e[0]||(e[0]=(...d)=>s.makeCover&&s.makeCover(...d))},"Make Cover"),o("p",{class:"pointer",onClick:e[1]||(e[1]=(...d)=>s.deleteAttachment&&s.deleteAttachment(...d))},"Delete")])])}var Er=T(Ur,[["render",Mr]]),Jr="/assets/arrow-down.9f6ee7c2.svg",Fr="/assets/loading-task.05eb7451.gif";const Gr={name:"task-details",emits:["updateBoard","addLabelToBoard","updateBoardLabels"],data(){return{task:null,imgUrls:[],currBoard:null,currGroup:null,addingDescription:!1,newDescription:"",detailsShown:!1,checklistTitle:"",handles:{isLabel:!1,isAttachOn:!1,isDatesOn:!1,isMembers:!1,isCover:!1,isDelete:!1,isChecklist:!1}}},async created(){await this.loadTask(),O.on("someone updated",this.boardUpdated)},unmounted(){O.off("someone updated",this.boardUpdated)},methods:{async loadTask(){var i;const{boardId:t,groupId:e,taskId:r}=this.$route.params;this.currBoard=await this.$store.dispatch({type:"loadBoard",boardId:t}),this.currGroup=this.currBoard.groups.find(s=>s.id===e);const l=(i=this.currGroup.tasks)==null?void 0:i.find(s=>s.id===r);this.task=JSON.parse(JSON.stringify(l)),this.newDescription=this.task.description,this.imgUrls=this.task.attachments},boardUpdated(){this.loadTask()},moveToBoard(){const t=this.$store.getters.getCurrBoard;this.$router.push(`/board/${t._id}`)},async addStyle(t){this.task.style=t,await this.saveTask("Updated style"),this.loadTask()},openCmp(t){for(let e in this.handles)this.handles[e]=!1;this.handles[t]=!0},closeCmp(){for(let t in this.handles)this.handles[t]=!1},async saveTaskTitle(t){const e=t.currentTarget.textContent;!e||e===this.task.title||(this.task.title=e,await this.saveTask("Updated task title"),this.loadTask())},async saveDate(t){this.task.dueDate=t,await this.saveTask("Updated due date"),this.closeCmp(),this.loadTask()},async saveTask(t){const e=await this.$store.dispatch({type:"saveTask",boardId:this.currBoard._id,groupId:this.currGroup.id,task:JSON.parse(JSON.stringify(this.task)),changeType:t});this.$emit("updateBoard",e)},addDescription(){this.task.description="",this.addingDescription=!0},clearForm(){this.addingDescription=!1,this.newDescription=""},async saveDescription(){this.task.description=this.newDescription,await this.saveTask("Updated Description"),this.loadTask()},async addLabelToTask(t){this.task.labelIds||(this.task.labelIds=[]),this.task.labelIds.includes(t)?this.task.labelIds=this.task.labelIds.filter(e=>e!==t):this.task.labelIds.push(t),await this.saveTask("Changed Labels"),this.loadTask()},async updateBoardLabels(t){const e=await this.$store.dispatch({type:"editBoard",boardId:this.currBoard._id,changeType:"update labels",val:t});this.currBoard=e,await this.$emit("updateBoard",e)},async toggleMemberInTask(t){this.task.members||(this.task.members=[]);const e=this.task.members.findIndex(r=>r._id===t._id);e===-1?(this.task.members.push(t),this.task.members.isCheck=!0):(this.task.members.splice(e,1),this.task.members.isCheck=!1),await this.saveTask("Added member"),this.loadTask()},async toggleDueDateDone(){this.task.dueDate.isCompleted=!this.task.dueDate.isCompleted,await this.saveTask("updated due date status"),this.loadTask()},async attachImg(t){const e=await this.$store.dispatch({type:"attachImg",ev:t});this.task.attachments||(this.task.attachments=[]),this.task.attachments.push(e.url),this.task.style.uploadedImg="",this.task.style.bgClr="",this.task.style.bgImg=e.url,await this.saveTask("Added image"),this.loadTask()},async deleteAttachment(t){this.task.attachments.splice(t,1),await this.saveTask("Deleted attachment"),this.loadTask()},async makeCover(t){this.task.style.bgImg=t,this.task.style.bgClr="",this.task.style.uploadedImg="",await this.saveTask("Updated cover photo"),this.loadTask()},async removeTask(t){const e=await this.$store.dispatch({type:"removeTask",boardId:this.currBoard._id,groupId:this.currGroup.id,task:this.task,changeType:t});this.$emit("updateBoard",e),this.moveToBoard()},setActivities(){this.taskActivities=this.currBoard.activities.filter(t=>{var e;return((e=t.task)==null?void 0:e.id)===this.task.id})},async createChecklist(t){this.task.checklists||(this.task.checklists=[]);const e={id:F.makeId(),title:t,todos:[]};this.task.checklists.push(e),await this.saveTask("Added checklist"),this.loadTask(),this.closeCmp()},async addTodo(t,e){if(!t)return;this.task.checklists.find(l=>l.id===e).todos.push({id:F.makeId(),title:t,isDone:!1}),await this.saveTask("Added todo"),this.loadTask()},async removeChecklist(t){const e=this.task.checklists.findIndex(r=>r.id===t);this.task.checklists.splice(e,1),await this.saveTask("Removed checklist"),this.loadTask()},async updateTodo(t,e,r){const l=this.task.checklists.find(d=>d.id===t),i=l.todos.find(d=>d.id===e);if(!i)return;i.title=r;const s=l.todos.findIndex(d=>d.id===e);l.todos.splice(s,1,i),await this.saveTask("Updated todo"),this.loadTask()},async updateTodoDone(t,e,r){const l=this.task.checklists.find(d=>d.id===t),i=l.todos.find(d=>d.id===e);i.isDone=r;const s=l.todos.findIndex(d=>d.id===e);l.todos.splice(s,1,i),await this.saveTask("Updated todo"),this.loadTask()},async removeTodo(t,e){const r=this.task.checklists.find(i=>i.id===t),l=r.todos.findIndex(i=>i.id===e);console.log(l),r.todos.splice(l,1),await this.saveTask("removeTodo"),this.loadTask()}},computed:{areDetailsShown(){return this.detailsShown?"Hide Details":"Show Details"},labelsToDisplay(){return this.currBoard.labels.filter(e=>{var r;if((r=this.task.labelIds)!=null&&r.includes(e.id))return e})},formattedDate(){var t=new Date(this.task.dueDate.dueDate);return t.toString().slice(4,21)},dueDateCheckBox(){return this.task.dueDate.isCompleted},overdue(){if(new Date(this.task.dueDate.dueDate).getTime()<Date.now())return!0},coverStyle(){return this.task.style.uploadedImg?{"background-image":`url(${this.task.style.uploadedImg})`,height:"160px","background-color":"#ccd6e0","border-radius":"3px 3px 0 0"}:this.task.style.bgImg?{"background-image":`url(${this.task.style.bgImg})`,height:"160px","background-color":"#ccd6e0","border-radius":"3px 3px 0 0"}:this.task.style.bgClr?{"background-color":this.task.style.bgClr,height:"100px","border-radius":"3px 3px 0 0"}:{display:"none"}},taskActivities(){return this.currBoard.activities.filter(t=>{var e;return((e=t.task)==null?void 0:e.id)===this.task.id})}},components:{userAvatar:G,attachmentPreview:io,datePreview:uo,labelPreview:Ho,membersPreview:li,coverUnsplash:Pi,deleteCmp:z,createChecklist:Zi,checklistActive:Cr,activityPreview:fe,attachedImgPreview:Er}},Rr={key:1,class:"task-details-main-content"},jr={class:"task-details-container"},Pr={class:"task-title-container"},Vr={class:"task-group-title"},qr=L(" in list "),Hr={class:"show-member-label flex"},Wr={key:0,class:"edit-members-container"},Yr=o("p",{class:"members-header"},"Members",-1),zr={class:"members-container flex"},Xr={key:1,class:"edit-labels-container"},Qr=o("p",{class:"labels-header"},"Labels",-1),Zr={class:"labels-container flex"},Kr={key:2,class:"due-date-container"},en=o("p",{class:"due-date-title"},"Due date",-1),tn={class:"displayed-date-checkbox"},sn=["src"],on={key:0,class:"completed-overdue-label l101-label"},rn={key:1,class:"completed-overdue-label l104-label"},nn=o("img",{src:Jr,alt:""},null,-1),an={class:"edit-description-container"},ln={key:0,class:"description-container"},dn={class:"description-header-container flex"},cn=o("p",{class:"description-header"},"Description",-1),un={class:"task-description"},hn={key:1,class:"add-edit-description-container"},pn=o("p",{class:"description-header"},"Description",-1),mn={key:1,class:"add-description-container"},gn={class:"add-description-buttons-container flex"},bn={key:0,class:"img-container"},_n=o("p",{class:"img-container-header"},"Attachments",-1),fn={class:"activities"},kn={class:"activity-details-header"},vn=o("p",{class:"activity-header"},"Activity",-1),yn={key:0,class:"activities-list"},Cn=o("p",{class:"add-task-buttons-title"},"Add to card",-1),wn={class:"just-buttons-container"},Tn=o("h3",{class:"td-actions"},"Actions",-1),Sn=o("span",{class:"td-delete-icon"},null,-1),In=o("span",null,"Delete",-1),xn=[Sn,In],$n={key:2,class:"loading-task-details",src:Fr,alt:""};function Bn(t,e,r,l,i,s){var Z,K,ee,te,se,oe,ie,re,ne;const d=g("user-avatar"),p=g("attached-img-preview"),u=g("checklist-active"),h=g("activity-preview"),c=g("members-preview"),I=g("label-preview"),y=g("create-checklist"),x=g("date-preview"),ve=g("attachment-preview"),ye=g("cover-unsplash"),Ce=g("delete-cmp"),we=N("focus");return n(),a("div",{class:"task-details-dark",onClick:e[23]||(e[23]=(...b)=>s.moveToBoard&&s.moveToBoard(...b))},[o("section",{onClick:e[22]||(e[22]=_(()=>{},["stop"])),class:"task-details-page"},[o("button",{class:"go-back-btn",onClick:e[0]||(e[0]=(...b)=>s.moveToBoard&&s.moveToBoard(...b))}),i.task?(n(),a("div",{key:0,style:D(s.coverStyle),class:"task-cover-img"},null,4)):m("",!0),i.task?(n(),a("div",Rr,[o("div",jr,[o("h3",Pr,[o("p",{class:"task-title",contenteditable:"true",onBlur:e[1]||(e[1]=(...b)=>s.saveTaskTitle&&s.saveTaskTitle(...b))},v(i.task.title),33)]),o("p",Vr,[qr,o("span",null,v(i.currGroup.title),1)]),o("section",Hr,[(Z=i.task.members)!=null&&Z.length?(n(),a("div",Wr,[Yr,o("div",zr,[(n(!0),a(C,null,w(i.task.members,b=>(n(),k(d,{"v-if":i.task.members,key:b._id,user:b},null,8,["v-if","user"]))),128)),o("button",{class:"avatar-btn flex",onClick:e[2]||(e[2]=_(b=>s.openCmp("isMembers"),["stop"]))})])])):m("",!0),(K=s.labelsToDisplay)!=null&&K.length?(n(),a("div",Xr,[Qr,o("div",Zr,[(n(!0),a(C,null,w(s.labelsToDisplay,b=>(n(),a("div",{key:b.id,class:"label-show flex",onClick:e[3]||(e[3]=_(ae=>s.openCmp("isLabel"),["stop"])),style:D({backgroundColor:b.color})},v(b.title),5))),128)),o("button",{class:"label-show-btn flex",onClick:e[4]||(e[4]=_(b=>s.openCmp("isLabel"),["stop"]))})])])):m("",!0),i.task.dueDate?(n(),a("div",Kr,[en,o("div",tn,[o("input",{type:"checkbox",onClick:e[5]||(e[5]=(...b)=>s.toggleDueDateDone&&s.toggleDueDateDone(...b)),class:"due-date-checkbox",src:s.dueDateCheckBox},null,8,sn),o("div",{class:"date-label-container flex",onClick:e[6]||(e[6]=_(b=>s.openCmp("isDatesOn"),["stop"]))},[o("span",null,v(s.formattedDate),1),i.task.dueDate.isCompleted?(n(),a("span",on,"Completed")):m("",!0),s.overdue&&!i.task.dueDate.isCompleted?(n(),a("span",rn,"Overdue")):m("",!0),nn])])])):m("",!0)]),o("section",an,[i.task.description?(n(),a("div",ln,[o("div",dn,[cn,o("button",{onClick:e[7]||(e[7]=(...b)=>s.addDescription&&s.addDescription(...b)),class:"edit-description-btn btn"}," Edit ")]),o("p",un,v(i.task.description),1)])):(n(),a("div",hn,[pn,i.addingDescription?(n(),a("div",mn,[B(o("textarea",{"onUpdate:modelValue":e[9]||(e[9]=b=>i.newDescription=b),class:"description-text-area",placeholder:"Add a more detailed description..."},null,512),[[we],[U,i.newDescription]]),o("div",gn,[o("button",{class:"save-description-btn btn",onClick:e[10]||(e[10]=(...b)=>s.saveDescription&&s.saveDescription(...b))}," Save "),o("button",{class:"delete-description-btn",onClick:e[11]||(e[11]=(...b)=>s.clearForm&&s.clearForm(...b))})])])):(n(),a("div",{key:0,class:"fake-text-area",onClick:e[8]||(e[8]=(...b)=>s.addDescription&&s.addDescription(...b))}," Add a more detailed description... "))]))]),((te=(ee=i.task)==null?void 0:ee.attachments)==null?void 0:te.length)&&((oe=(se=i.task)==null?void 0:se.attachments)==null?void 0:oe.length)>0?(n(),a("section",bn,[_n,(n(!0),a(C,null,w(i.task.attachments,(b,ae)=>(n(),k(p,{key:ae,attachment:b,onMakeCover:s.makeCover,onDeleteAttachment:s.deleteAttachment},null,8,["attachment","onMakeCover","onDeleteAttachment"]))),128))])):m("",!0),(ie=i.task.checklists)!=null&&ie.length?(n(),k(u,{key:1,task:i.task,onAddTodo:s.addTodo,onRemoveChecklist:s.removeChecklist,onUpdateTodo:s.updateTodo,onUpdateTodoDone:s.updateTodoDone,onRemoveTodo:s.removeTodo},null,8,["task","onAddTodo","onRemoveChecklist","onUpdateTodo","onUpdateTodoDone","onRemoveTodo"])):m("",!0),o("section",fn,[o("div",kn,[vn,(re=i.currBoard.activities)!=null&&re.length?(n(),a("button",{key:0,class:"details-shown-btn btn",onClick:e[12]||(e[12]=b=>i.detailsShown=!i.detailsShown)},v(s.areDetailsShown),1)):m("",!0)]),i.detailsShown?(n(),a("div",yn,[(n(!0),a(C,null,w(s.taskActivities,b=>(n(),k(h,{key:b.id,activity:b},null,8,["activity"]))),128))])):m("",!0)])]),o("nav",{onClick:e[21]||(e[21]=_(()=>{},["stop"])),class:"add-task-buttons-container"},[Cn,o("div",wn,[o("button",{onClick:e[13]||(e[13]=_(b=>s.openCmp("isMembers"),["stop"])),class:"members-btn btn",title:"Members"}," Members "),i.handles.isMembers?(n(),k(c,{key:0,boardMembers:i.currBoard.members,task:i.task,onCloseCmp:s.closeCmp,onToggleMemberInTask:s.toggleMemberInTask},null,8,["boardMembers","task","onCloseCmp","onToggleMemberInTask"])):m("",!0),o("button",{onClick:e[14]||(e[14]=_(b=>s.openCmp("isLabel"),["stop"])),class:"labels-btn btn",title:"Labels"}," Labels "),i.handles.isLabel?(n(),k(I,{key:1,boardLabels:i.currBoard.labels,taskLabelIds:i.task.labelIds,onCloseCmp:s.closeCmp,onAddLabelToTask:s.addLabelToTask,onUpdateBoardLabels:s.updateBoardLabels},null,8,["boardLabels","taskLabelIds","onCloseCmp","onAddLabelToTask","onUpdateBoardLabels"])):m("",!0),o("button",{class:"checklist-btn btn",title:"Checklist",onClick:e[15]||(e[15]=_(b=>s.openCmp("isChecklist"),["stop"]))}," Checklist "),i.handles.isChecklist?(n(),k(y,{key:2,onCloseCmp:s.closeCmp,onCreateChecklist:s.createChecklist},null,8,["onCloseCmp","onCreateChecklist"])):m("",!0),o("button",{onClick:e[16]||(e[16]=_(b=>s.openCmp("isDatesOn"),["stop"])),class:"dates-btn btn",title:"Dates"}," Dates "),i.handles.isDatesOn?(n(),k(x,{key:3,dueDate:((ne=i.task.dueDate)==null?void 0:ne.dueDate)||Date.now(),onSaveDate:s.saveDate,onCloseCmp:s.closeCmp},null,8,["dueDate","onSaveDate","onCloseCmp"])):m("",!0),o("button",{onClick:e[17]||(e[17]=_(b=>s.openCmp("isAttachOn"),["stop"])),class:"attachment-img btn",title:"Attachment"}," Attachment "),i.handles.isAttachOn?(n(),k(ve,{key:4,imgUrls:i.imgUrls,onAttachImg:s.attachImg,onCloseCmp:s.closeCmp},null,8,["imgUrls","onAttachImg","onCloseCmp"])):m("",!0),o("button",{onClick:e[18]||(e[18]=_(b=>s.openCmp("isCover"),["stop"])),class:"cover-btn btn font-cmp-btn",title:"Cover"}," Cover "),i.handles.isCover?(n(),k(ye,{key:5,style:D(i.task.style),title:i.task.title,attachments:i.task.attachments,onCloseCmp:s.closeCmp,onAddStyle:s.addStyle},null,8,["style","title","attachments","onCloseCmp","onAddStyle"])):m("",!0)]),Tn,o("a",{onClick:e[19]||(e[19]=_(b=>s.openCmp("isDelete"),["stop"])),class:"td-delete-btn btn pointer"},xn),i.handles.isDelete?(n(),k(Ce,{key:0,type:"task",onRemove:e[20]||(e[20]=b=>s.removeTask("removed task")),onCloseCmp:s.closeCmp},null,8,["onCloseCmp"])):m("",!0)])])):(n(),a("img",$n))])])}var ke=T(Gr,[["render",Bn]]);const Dn={props:{task:Object,groupId:String,isLabelTitle:Boolean},data(){return{boardId:null}},components:{userAvatar:G,taskDetails:ke},methods:{toTaskDetails(t,e,r){this.$router.push(`/board/${t}/${e}/${r}`)},toggleLabelTitle(){this.$emit("toggleLabelTitle")}},created(){const{boardId:t}=this.$route.params;this.boardId=t},computed:{formattedDate(){var t=new Date(this.task.dueDate.dueDate);return t.toString().slice(4,10)},isTaskOverdue(){if(new Date(this.task.dueDate.dueDate).getTime()<Date.now())return this.task.dueDate.isCompleted?"l101-label":"l104-label"},isChecklistDone(){var r;let t=0,e=0;return(r=this.task.checklists)==null||r.forEach(l=>{t+=l.todos.length,l.todos.filter(i=>{i.isDone&&e++})}),t===e},labelsToDisplay(){return this.$store.getters.getCurrBoard.labels.filter(e=>{if(this.task.labelIds.includes(e.id))return e})},attachmentCount(){var t;return(t=this.task.attachments)==null?void 0:t.length},checkListsCount(){var r,l;var t=0;(r=this.task.checklists)==null||r.forEach(i=>t+=i.todos.length);var e=0;return(l=this.task.checklists)==null||l.forEach(i=>{e+=i.todos.filter(d=>d.isDone).length}),`${e}/${t}`},openLabel(){return{open:this.isLabelTitle}},taskImgUrl(){return this.task.style.uploadedImg?this.task.style.uploadedImg:this.task.style.bgImg?this.task.style.bgImg:void 0},fullCoverStyle(){var t;return this.task.style.uploadedImg?{backgroundImage:`url(${this.task.style.uploadedImg})`,height:"220px",backgroundColor:"#ccd6e0"}:this.task.style.bgImg?{backgroundImage:`url(${this.task.style.bgImg})`,height:"220px",backgroundColor:"#ccd6e0"}:{"background-color":((t=this.task.style)==null?void 0:t.bgClr)||"#FFFFFF",height:"54px"}},fullCoverTxt(){return this.task.style.uploadedImg||this.task.style.bgImg?"is-img":F.isDarkColor(this.task.style.bgClr)?"is-dark-bg":"is-light-bg"},coverStyle(){return this.task.style.bgClr?{"background-color":this.task.style.bgClr,height:"32px"}:{display:"none"}}}},Un={key:1,class:"top-cover-selected"},Ln=["src"],On={class:"task-preview-icons"},An={class:"task-content"},Nn={class:"task-snapshot flex"},Mn={key:0,class:"description-img-preview",title:"Card description"},En=o("span",{class:""},null,-1),Jn={key:2,class:"attachment-img-preview",title:"Attachment"},Fn={class:"user-avatar-pos flex"};function Gn(t,e,r,l,i,s){var p,u,h,c,I;const d=g("user-avatar");return n(),a("div",{onClick:e[2]||(e[2]=y=>s.toTaskDetails(this.boardId,this.groupId,this.task.id)),class:"task-preview-container"},[this.task.style.isFullCover?(n(),a("div",{key:0,style:D(s.fullCoverStyle),class:"full-cover-selected"},[o("p",{class:E([s.fullCoverTxt,"full-cover-title"])},v(r.task.title),3)],4)):(n(),a("div",Un,[o("div",{style:D(s.coverStyle),class:"task-preview-cover"},null,4),s.taskImgUrl&&!r.task.style.bgClr?(n(),a("img",{key:0,class:"top-cover-img",src:s.taskImgUrl,alt:"",draggable:"false"},null,8,Ln)):m("",!0),o("div",On,[(p=r.task.labelIds)!=null&&p.length?(n(),a("div",{key:0,class:"labels-container",onClick:e[1]||(e[1]=_((...y)=>t.showLabelTitle&&t.showLabelTitle(...y),["stop"]))},[(n(!0),a(C,null,w(s.labelsToDisplay,y=>(n(),a("div",{key:y.id,class:E(["task-preview-label",s.openLabel]),style:D({backgroundColor:y.color}),onClick:e[0]||(e[0]=_((...x)=>s.toggleLabelTitle&&s.toggleLabelTitle(...x),["stop"]))},[r.isLabelTitle?(n(),a("span",{key:0,class:E(s.openLabel)},v(y.title),3)):m("",!0)],6))),128))])):m("",!0),o("div",An,v(r.task.title),1),o("div",Nn,[(u=r.task.description)!=null&&u.length?(n(),a("div",Mn)):m("",!0),(h=r.task.checklists)!=null&&h.length?(n(),a("div",{key:1,class:E(["checklists-img-preview",{"todo-done":s.isChecklistDone}]),title:"Checklist items"},[o("span",{class:E(["checklist-img-font flex",{white:s.isChecklistDone}])},null,2),En,L(" "+v(s.checkListsCount),1)],2)):m("",!0),(c=r.task.attachments)!=null&&c.length?(n(),a("div",Jn,v(s.attachmentCount),1)):m("",!0),(I=r.task.dueDate)!=null&&I.dueDate?(n(),a("div",{key:3,class:E(["date-img-preview",s.isTaskOverdue])},v(s.formattedDate),3)):m("",!0),o("div",Fn,[(n(!0),a(C,null,w(r.task.members,y=>{var x;return n(),k(d,{class:"user-avatar","v-if":(x=r.task.members)==null?void 0:x.length,key:y._id,user:y},null,8,["v-if","user"])}),128))])])])]))])}var Rn=T(Dn,[["render",Gn]]);const jn={props:{group:Object,isLabelTitle:Boolean},components:{taskPreview:Rn,deleteCmp:z,Container:pe,Draggable:me},data(){return{isAdding:!1,newTaskTitle:"",isRemove:!1}},methods:{getPayload(t){return()=>t},onDrop(t){typeof t.removedIndex!="number"&&typeof t.addedIndex!="number"||this.$emit("dropped",{ev:t,groupToId:this.group.id})},async saveIfTxt(){await F.delay(100),this.newTaskTitle?this.addTask():this.clearForm()},clearForm(){this.isAdding=!1,this.newTaskTitle=""},async openAddTask(){this.isAdding=!0,await Be();var t=this.$refs.list,e=t.offsetTop;t.scrollTo(0,e+t.scrollHeight)},addTask(){if(this.newTaskTitle){const t=J.getEmptyTask();t.title=this.newTaskTitle,this.$emit("saveGroup",{groupId:this.group.id,changeType:"add task",newValue:t}),this.clearForm()}else{this.isAdding=!1;return}},saveTitle(t){const e=t.currentTarget.textContent;e!==this.group.title&&this.$emit("saveGroup",{groupId:this.group.id,changeType:"save group title",newValue:e})},toggleLabelTitle(){this.$emit("toggleLabelTitle")},toggleRemove(){this.isRemove=!this.isRemove},removeGroup(){this.$emit("removeGroup",this.group.id)}},computed:{calcHeight(){return{add:this.isAdding}}}},Pn={class:"groups-border"},Vn={class:"outside-group flex"},qn={key:1,class:"add-task-container"},Hn={class:"add-task-buttons-container flex"},Wn={class:"bottom-outside-group"};function Yn(t,e,r,l,i,s){var I;const d=g("delete-cmp"),p=g("task-preview"),u=g("Draggable"),h=g("Container"),c=N("focus");return n(),a("section",Pn,[o("div",Vn,[o("p",{class:"group-title pointer",contenteditable:"true",onBlur:e[0]||(e[0]=(...y)=>s.saveTitle&&s.saveTitle(...y))},v(r.group.title),33),o("span",{class:"remove-group-btn",onClick:e[1]||(e[1]=(...y)=>s.toggleRemove&&s.toggleRemove(...y))})]),i.isRemove?(n(),k(d,{key:0,type:"list",onRemove:s.removeGroup,onCloseCmp:s.toggleRemove},null,8,["onRemove","onCloseCmp"])):m("",!0),o("div",{class:E(["group-container",s.calcHeight]),ref:"list"},[(I=r.group.tasks)!=null&&I.length?(n(),k(h,{key:0,class:"tasks-container","group-name":"group",orientation:"vertical","get-child-payload":s.getPayload(r.group.id),onDrop:s.onDrop},{default:f(()=>[(n(!0),a(C,null,w(r.group.tasks,y=>(n(),k(u,{class:"draggable-container middle-group-list",key:y.id},{default:f(()=>[S(p,{task:y,groupId:r.group.id,isLabelTitle:r.isLabelTitle,onToggleLabelTitle:s.toggleLabelTitle},null,8,["task","groupId","isLabelTitle","onToggleLabelTitle"])]),_:2},1024))),128))]),_:1},8,["get-child-payload","onDrop"])):m("",!0),i.isAdding?(n(),a("div",qn,[B(o("textarea",{onBlur:e[2]||(e[2]=_((...y)=>s.saveIfTxt&&s.saveIfTxt(...y),["stop"])),"onUpdate:modelValue":e[3]||(e[3]=y=>i.newTaskTitle=y),placeholder:"Enter a title for this card..."},null,544),[[c],[U,i.newTaskTitle]]),o("div",Hn,[o("button",{class:"adding-task-btn btn",ref:"bottom",onClick:e[4]||(e[4]=(...y)=>s.addTask&&s.addTask(...y))}," Add card ",512),o("button",{class:"delete-task-btn",onClick:e[5]||(e[5]=(...y)=>s.clearForm&&s.clearForm(...y))})])])):m("",!0)],2),o("div",Wn,[i.isAdding?m("",!0):(n(),a("div",{key:0,class:"add-task-btn",onClick:e[6]||(e[6]=(...y)=>s.openAddTask&&s.openAddTask(...y))}," Add a card "))])])}var zn=T(jn,[["render",Yn]]);const Xn={props:{board:Object},data(){return{filterBy:{txt:""}}},methods:{setFilter(){this.$emit("setFilter",this.filterBy)}},computed:{checkBox(){return"../../src/assets/svgs/empty-checkbox.svg"}},components:{userAvatar:G}},Qn={class:"board-filter"},Zn={class:"cmp-header"},Kn=o("p",{class:"cmp-container-title"},"Filter",-1),ea=o("span",null,null,-1),ta=[ea],sa=o("hr",{class:"thin-hr"},null,-1),oa={class:"filter-search-container"},ia=o("p",{class:"filter-section-title"},"Keyword",-1),ra=o("p",{class:"search-description"},"Search cards, members, labels, and more.",-1),na={class:"filter-member-container"},aa=o("p",{class:"filter-section-title"},"Members",-1),la={class:"filter-no-member flex"},da=["src"],ca=o("div",{class:"filter-no-user-avatar flex"},null,-1),ua=o("p",{class:"filter-user-name"},"No members",-1),ha=o("input",{type:"checkbox",value:"no",hidden:""},null,-1),pa={class:"filter-members-list"},ma=["src"],ga={class:"filter-user-name"},ba=["value"];function _a(t,e,r,l,i,s){const d=g("user-avatar"),p=N("focus"),u=N("modal");return n(),a("section",Qn,[o("div",Zn,[Kn,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=h=>t.$emit("closeCmp"))},ta)]),sa,o("label",oa,[ia,B(o("input",{type:"text",class:"search-input",placeholder:"Enter a keyword...",onInput:e[1]||(e[1]=(...h)=>s.setFilter&&s.setFilter(...h))},null,544),[[p],[u,i.filterBy.txt]]),ra]),o("div",na,[aa,o("label",la,[o("img",{class:"checkbox-icon",src:s.checkBox},null,8,da),ca,ua,ha]),o("div",pa,[(n(!0),a(C,null,w(r.board.members,h=>(n(),a("label",{key:h._id,class:"filter-member flex"},[o("img",{class:"checkbox-icon",src:s.checkBox},null,8,ma),S(d,{user:h},null,8,["user"]),o("p",ga,v(h.fullname),1),o("input",{type:"checkbox",value:h._id,hidden:""},null,8,ba)]))),128))])])])}var fa=T(Xn,[["render",_a]]),ka="/assets/photos.2b952301.jpg",va="/assets/colors.05334064.jpg";const ya={props:{board:Object},data(){return{filterBy:"",handles:{isAbout:!1,isSearch:!1,isChangeBg:!1,isShowActivities:!1},bgOptions:{isChangClr:!1,isChangImg:!1},bgClr:"",bgImg:"",bgColors:[{id:"l101",color:"#61bd4f",isSelected:!1},{id:"l102",color:"#f2d600",isSelected:!1},{id:"l103",color:"#ff9f1a",isSelected:!1},{id:"l104",color:"#eb5a46",isSelected:!1},{id:"l105",color:"#c377e0",isSelected:!1},{id:"l106",color:"#0079bf",isSelected:!1},{id:"l107",color:"#00c2e0",isSelected:!1},{id:"l108",color:"#51e898",isSelected:!1},{id:"l109",color:"#ff78cb",isSelected:!1},{id:"l110",color:"#344563",isSelected:!1}],search:"",photos:[],isLoading:!1,attachments:[]}},methods:{searchPhoto(t){const e="Y2X6Y_wdMpqvaYX_4jgO-dOBqVAsQMQpihsIFNOAX5E";let r=20,l=t;l||(l=this.search),H.get(`https://api.unsplash.com/search/photos?page=1&per_page=${r}&query=${l}&client_id=${e}`).then(i=>{this.photos=i.data.results}).catch(i=>{console.log(i)})},waitSearch:he.debounce(function(){this.searchPhoto()},1e3),toggleMenuContent(t){if(this.bgOptions.isChangClr||this.bgOptions.isChangImg){this.toggleBgOption();return}for(let e in this.handles)this.handles[e]=!1;typeof t=="string"&&(this.handles[t]=!0)},toggleBgOption(t){for(const e in this.bgOptions)this.bgOptions[e]=!1;typeof t=="string"&&(this.bgOptions[t]=!0,t==="isChangImg"&&this.searchPhoto(this.board.title))},selectBg(t,e){this.$emit("editBoard",t,e)},async onAttachImg(t){this.isLoading=!0;const e=await this.$emit("attachImg",t);this.attachments.push(e),this.isLoading=!1}},computed:{activitiesToDisplay(){const t=this.board.activities.sort((e,r)=>e.createdAt>r.createdAt?-1:1);return this.handles.isShowActivities?t:t.slice(0,20)},cmpTitle(){return this.handles.isAbout?"About":this.handles.isSearch?"Search":this.bgOptions.isChangClr?"Colors":this.bgOptions.isChangImg?"Photos":this.handles.isChangeBg?"Change background":this.handles.isShowActivities?"Activity":"Menu"}},components:{activityPreview:fe,listSlot:V,backdrop:M}},Ca={class:"cmp-header"},wa=o("span",null,null,-1),Ta=[wa],Sa={class:"cmp-container-title"},Ia=o("span",null,null,-1),xa=[Ia],$a=o("hr",{class:"thin-hr"},null,-1),Ba={class:"menu-content"},Da={key:0,class:"menu-options flex"},Ua=o("span",{class:"trello-icon"},null,-1),La=o("div",null,[o("p",{class:"menu-option-about"},"About this board"),o("p",{class:"menu-option-about-description"}," Add description to your board ")],-1),Oa=[Ua,La],Aa=o("img",{class:"board-bg-preview",src:ge},null,-1),Na=o("p",{class:"menu-option-bgc"},"Change background",-1),Ma=[Aa,Na],Ea=o("hr",{class:"thin-hr"},null,-1),Ja={key:1,class:"menu-activities-container"},Fa={class:"activities-list"},Ga={key:2,class:"change-bg-container"},Ra={key:0,class:"change-bg-choose"},ja={class:"photos-colors-options flex"},Pa=o("img",{class:"photos-option",src:ka},null,-1),Va=o("p",{class:"photos-option-title"},"Photos",-1),qa=[Pa,Va],Ha=o("img",{class:"colors-option",src:va},null,-1),Wa=o("p",{class:"color-option-title"},"Colors",-1),Ya=[Ha,Wa],za=o("hr",{class:"thin-hr"},null,-1),Xa=o("p",{class:"custom-option-title"},"Custom",-1),Qa={class:"customs-container flex"},Za={class:"custom-input-label"},Ka=o("div",{class:"custom-option"},[o("span")],-1),el={class:"options-list"},tl=["onClick"],sl={key:1,class:"change-bg-img-screen"},ol=["src","onClick"];function il(t,e,r,l,i,s){const d=g("activity-preview"),p=g("list-slot"),u=g("backdrop"),h=N("focus");return n(),k(u,{onClick:e[12]||(e[12]=c=>t.$emit("closeCmp"))},{default:f(()=>[o("section",{class:"board-menu",onClick:e[11]||(e[11]=_(()=>{},["stop"]))},[o("div",Ca,[i.handles.isAbout||i.handles.isChangeBg||i.handles.isShowActivities?(n(),a("a",{key:0,class:"back-to-cmp-btn",onClick:e[0]||(e[0]=(...c)=>s.toggleMenuContent&&s.toggleMenuContent(...c))},Ta)):m("",!0),o("p",Sa,v(s.cmpTitle),1),o("a",{class:"close-cmp-btn",onClick:e[1]||(e[1]=c=>t.$emit("closeCmp"))},xa)]),$a,o("section",Ba,[!i.handles.isAbout&&!i.handles.isChangeBg&&!i.handles.isShowActivities?(n(),a("div",Da,[o("div",{class:"menu-option",onClick:e[2]||(e[2]=c=>s.toggleMenuContent("isAbout"))},Oa),o("div",{class:"menu-option",onClick:e[3]||(e[3]=c=>s.toggleMenuContent("isChangeBg"))},Ma),Ea])):m("",!0),!i.handles.isAbout&&!i.handles.isChangeBg?(n(),a("section",Ja,[i.handles.isShowActivities?m("",!0):(n(),a("p",{key:0,class:"activity-header",onClick:e[4]||(e[4]=c=>s.toggleMenuContent("isShowActivities"))}," Activity ")),o("div",Fa,[(n(!0),a(C,null,w(s.activitiesToDisplay,c=>(n(),k(d,{key:c.id,activity:c},null,8,["activity"]))),128))]),i.handles.isShowActivities?m("",!0):(n(),a("a",{key:1,class:"show-allActivities",onClick:e[5]||(e[5]=c=>s.toggleMenuContent("isShowActivities"))},"View all activity"))])):m("",!0),i.handles.isChangeBg?(n(),a("section",Ga,[!i.bgOptions.isChangClr&&!i.bgOptions.isChangImg?(n(),a("div",Ra,[o("div",ja,[o("div",{class:"photos-option-container",onClick:e[6]||(e[6]=c=>s.toggleBgOption("isChangImg"))},qa),o("div",{class:"colors-option-container",onClick:e[7]||(e[7]=c=>s.toggleBgOption("isChangClr"))},Ya)]),za,Xa,o("div",Qa,[o("label",Za,[o("input",{type:"file",onChange:e[8]||(e[8]=(...c)=>s.onAttachImg&&s.onAttachImg(...c)),hidden:""},null,32),Ka])])])):m("",!0),o("div",el,[i.bgOptions.isChangClr?(n(),k(p,{key:0},{list:f(()=>[(n(!0),a(C,null,w(i.bgColors,c=>(n(),a("div",{key:c.id,class:"colors-option",style:D({backgroundColor:c.color}),onClick:I=>s.selectBg("bgClr",c.color)},null,12,tl))),128))]),_:1})):m("",!0),i.bgOptions.isChangImg?(n(),a("div",sl,[B(o("input",{type:"text",placeholder:"Search Unsplash for photos",class:"unsplash-search","onUpdate:modelValue":e[9]||(e[9]=c=>i.search=c),onInput:e[10]||(e[10]=(...c)=>s.waitSearch&&s.waitSearch(...c))},null,544),[[h],[U,i.search]]),S(p,null,{list:f(()=>[(n(!0),a(C,null,w(i.photos,(c,I)=>(n(),a("img",{key:I,class:"photos-option",src:c.urls.thumb,alt:"img",onClick:y=>s.selectBg("bgImg",c)},null,8,ol))),128))]),_:1})])):m("",!0)])])):m("",!0)])])]),_:1})}var rl=T(ya,[["render",il]]);const nl={name:"invite-user",props:{members:Array},components:{userAvatar:G,backdrop:M},data(){return{users:null,selected:[]}},async created(){await this.$store.dispatch({type:"loadUsers"}),this.users=this.$store.getters.users},methods:{addMemberToBoard(){if(!this.selected.length)return;const t=this.users.filter(e=>{if(this.selected.includes(e._id))return e});this.$emit("addMemberToBoard","add members",t)}}},al={class:"invite-user-header"},ll=o("p",{class:"invite-user-title"},"Invite to board",-1),dl=o("span",null,null,-1),cl=[dl],ul=o("hr",{class:"thin-hr"},null,-1),hl={class:"invite-content"},pl={class:"select-container"},ml={class:"members-container"},gl=o("h4",{class:"members-preview-title"},"Board members",-1),bl={class:"board-members-container"},_l={class:"member-fullname"};function fl(t,e,r,l,i,s){const d=g("el-option"),p=g("el-select"),u=g("user-avatar"),h=g("backdrop");return n(),k(h,{onClick:e[4]||(e[4]=c=>t.$emit("closeCmp"))},{default:f(()=>[i.users?(n(),a("section",{key:0,class:"invite-user",onClick:e[3]||(e[3]=_(()=>{},["stop"]))},[o("div",al,[ll,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=c=>t.$emit("closeCmp"))},cl)]),ul,o("div",hl,[o("div",pl,[S(p,{modelValue:i.selected,"onUpdate:modelValue":e[1]||(e[1]=c=>i.selected=c),multiple:"",placeholder:"Select user",style:{width:"100%"}},{default:f(()=>[(n(!0),a(C,null,w(i.users,c=>(n(),k(d,{key:c._id,label:c.fullname,value:c._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o("button",{class:"add-members-btn",onClick:e[2]||(e[2]=(...c)=>s.addMemberToBoard&&s.addMemberToBoard(...c))}," Invite ")]),o("div",ml,[gl,o("ul",bl,[(n(!0),a(C,null,w(r.members,c=>(n(),a("li",{class:"board-member",key:c._id},[S(u,{user:c},null,8,["user"]),o("div",_l,v(c.fullname)+v(`(${c.username})`),1)]))),128))])])])])):m("",!0)]),_:1})}var kl=T(nl,[["render",fl]]),X="/assets/full-star.b170b7f3.png",Q="/assets/empty-star.b48fd479.png";const vl={name:"board-details",data(){return{board:null,dndInfo:{},isLabelTitle:!1,isOpenFilter:!1,isOpenMenu:!1,isOpenInvite:!1}},components:{boardGroup:zn,userAvatar:G,Container:pe,Draggable:me,boardFilter:fa,boardMenu:rl,inviteUser:kl},async created(){this.unsubscribe=qs.on("show-msg",this.showMsg);const{boardId:t}=this.$route.params;this.topic=t,O.emit("board topic",this.topic),O.on("someone updated",this.boardUpdated)},unmounted(){O.off("someone updated",this.boardUpdated)},methods:{onDrop(t){const e=this.board.groups.splice(t.removedIndex,1)[0];this.board.groups.splice(t.addedIndex,0,e),this.saveDnd()},dropCard({ev:t,groupToId:e}){this.dndInfo.groupFromId=t.payload,t.payload!==e&&(this.dndInfo.groupToId=e),(t.removedIndex||typeof t.removedIndex=="number")&&(this.dndInfo.removedIndex=t.removedIndex),(t.addedIndex||typeof t.addedIndex=="number")&&(this.dndInfo.addedIndex=t.addedIndex),(this.dndInfo.addedIndex||typeof this.dndInfo.addedIndex=="number")&&(this.dndInfo.removedIndex||typeof this.dndInfo.removedIndex=="number")&&this.moveTask()},moveTask(){const t=this.board.groups.find(l=>l.id===this.dndInfo.groupFromId),e=this.dndInfo.groupToId?this.board.groups.find(l=>l.id===this.dndInfo.groupToId):t,r=t.tasks.splice(this.dndInfo.removedIndex,1)[0];e.tasks.splice(this.dndInfo.addedIndex,0,r),this.saveDnd(),this.dndInfo={}},async loadBoard(t){this.board=await this.$store.dispatch({type:"loadBoard",boardId:t})},async saveDnd(){this.board=await this.$store.dispatch({type:"saveBoard",board:JSON.parse(JSON.stringify(this.board))})},async editBoard(t,e){try{this.board=await this.$store.dispatch({type:"editBoard",boardId:this.board._id,changeType:t,val:e})}catch{}},async attachImg(t){const{url:e}=await this.$store.dispatch({type:"attachImg",ev:t});return await this.editBoard("bgImg",e),e},async addGroup(){const t=J.getEmptyGroup();this.board=await this.$store.dispatch({type:"saveGroup",boardId:this.board._id,group:t,changeType:"Added a new group"})},async saveGroup({groupId:t,changeType:e,newValue:r}){const l=JSON.parse(JSON.stringify(this.board.groups.find(i=>i.id===t)));switch(e){case"save group title":l.title=r;break;case"add task":l.tasks.push(r);break}this.board=await this.$store.dispatch({type:"saveGroup",boardId:this.board._id,group:l,changeType:e})},async removeGroup(t){this.board=await this.$store.dispatch({type:"removeGroup",boardId:this.board._id,groupId:t})},toggleLabelTitle(){this.isLabelTitle=!this.isLabelTitle},toggleFilter(){this.isOpenFilter=!this.isOpenFilter},setFilter(t){this.$store.commit({type:"setFilter",filterBy:t})},boardUpdated(){this.loadBoard(this.board._id)},toggleMenu(){this.isOpenMenu=!this.isOpenMenu},moveToDashboard(t){this.$router.push(`/${t}/dashboard`)}},computed:{isStarred(){return this.board.isFavorite?"filled":"stroke"},background(){var r,l,i,s;const t=((i=(l=(r=this.board.style)==null?void 0:r.bgImg)==null?void 0:l.urls)==null?void 0:i.regular)||"",e=((s=this.board.style)==null?void 0:s.bgClr)||"";return{backgroundImage:`url(${t})`,backgroundColor:e}},updatedBoardFromStore(){return this.$store.getters.boards}},watch:{"$route.params.boardId":{immediate:!0,handler(){const{boardId:t}=this.$route.params;!t||this.loadBoard(t)}}},unmounted(){this.unsubscribe()}},yl={class:"board-header flex"},Cl={class:"board-title-container flex"},wl=o("button",{class:"btn-board-details btn-board"},"Board",-1),Tl={key:0,class:"star",src:X,alt:""},Sl={key:1,class:"star",src:Q},Il={class:"members-nav-bar flex"},xl={class:"board-members-container flex"},$l={class:"board-header-nav flex"},Bl={class:"groups-layout"},Dl={class:"groups-container flex"},Ul=o("span",null,null,-1),Ll=L(" Add another list "),Ol=[Ul,Ll];function Al(t,e,r,l,i,s){const d=g("router-view"),p=g("user-avatar"),u=g("invite-user"),h=g("board-menu"),c=g("board-group"),I=g("Draggable"),y=g("Container");return i.board?(n(),a("section",{key:0,class:"board-container",style:D(s.background)},[S(d,{onUpdateBoard:e[0]||(e[0]=x=>s.loadBoard(i.board._id))}),o("header",yl,[o("div",Cl,[wl,o("div",{class:"board-title",contenteditable:"true",onBlur:e[1]||(e[1]=x=>s.editBoard("board title",x))},v(i.board.title),33),o("button",{class:"star-btn btn-board btn",onClick:e[2]||(e[2]=_(x=>s.editBoard("toggle favorite"),["stop"]))},[i.board.isFavorite?(n(),a("img",Tl)):(n(),a("img",Sl))])]),o("div",Il,[o("div",xl,[(n(!0),a(C,null,w(i.board.members,x=>(n(),k(p,{"v-if":i.board.members,key:x._id,user:x},null,8,["v-if","user"]))),128))]),o("button",{class:"invite-btn btn-board btn",onClick:e[3]||(e[3]=x=>i.isOpenInvite=!i.isOpenInvite)}," Invite "),i.isOpenInvite?(n(),k(u,{key:0,members:i.board.members,onCloseCmp:e[4]||(e[4]=x=>i.isOpenInvite=!i.isOpenInvite),onAddMemberToBoard:s.editBoard},null,8,["members","onAddMemberToBoard"])):m("",!0)]),o("nav",$l,[o("button",{class:"show-menu-btn btn-board btn",onClick:e[5]||(e[5]=(...x)=>s.toggleMenu&&s.toggleMenu(...x))}," Show menu "),i.isOpenMenu?(n(),k(h,{key:0,board:i.board,onCloseCmp:s.toggleMenu,onEditBoard:s.editBoard,onAttachImg:s.attachImg},null,8,["board","onCloseCmp","onEditBoard","onAttachImg"])):m("",!0)])]),o("div",Bl,[o("article",Dl,[S(y,{onDrop:s.onDrop,orientation:"horizontal"},{default:f(()=>[(n(!0),a(C,null,w(i.board.groups,x=>(n(),k(I,{class:"draggable-container flex",key:x.id},{default:f(()=>[S(c,{group:x,isLabelTitle:i.isLabelTitle,onDropped:s.dropCard,onSaveGroup:s.saveGroup,onToggleLabelTitle:s.toggleLabelTitle,onRemoveGroup:s.removeGroup},null,8,["group","isLabelTitle","onDropped","onSaveGroup","onToggleLabelTitle","onRemoveGroup"])]),_:2},1024))),128))]),_:1},8,["onDrop"]),o("div",{class:"add-group",onClick:e[6]||(e[6]=(...x)=>s.addGroup&&s.addGroup(...x))},Ol)])])],4)):m("",!0)}var Nl=T(vl,[["render",Al]]);const Ml={name:"work-space",data(){return{isFavorite:!1,isCreateBoard:!1}},methods:{toBoardDetails(t){this.$router.push(`/board/${t}`)},async toggleFavorite(t){this.$store.dispatch({type:"editBoard",boardId:t,changeType:"toggle favorite"})},async removeBoard(t){this.$store.dispatch({type:"removeBoard",boardId:t})}},computed:{boards(){return this.$store.getters.boards},favoriteBoards(){return this.$store.getters.favoriteBoards},cardBackground(){var t;return this.board.style.bgImg?{backgroundImage:`url(${(t=board.style)==null?void 0:t.bgImg})`}:this.board.style.bgClr?{backgroundColor:`(${this.board.style.bgClr})`}:""}},components:{createBoard:be}},El={class:"workspace-page-container"},Jl={class:"all-boards-container"},Fl=o("h1",null,"Favorite boards",-1),Gl={class:"favorite-boards flex"},Rl=["onClick"],jl={class:"favorite-board-title"},Pl=["onClick"],Vl={key:0,class:"ws-full-star",src:X},ql={key:1,class:"ws-empty-star",src:Q},Hl=o("h3",{class:"all-boards-title"},"All boards",-1),Wl={class:"saved-boards"},Yl=["onClick"],zl={class:"title"},Xl=["onClick"],Ql={key:0,class:"ws-full-star",src:X},Zl={key:1,class:"ws-empty-star",src:Q};function Kl(t,e,r,l,i,s){const d=g("create-board");return n(),a("main",El,[o("section",Jl,[o("section",null,[Fl,o("ul",Gl,[(n(!0),a(C,null,w(s.favoriteBoards,p=>{var u,h,c,I;return n(),a("li",{key:p._id,onClick:y=>s.toBoardDetails(p._id),class:"board-preview img-pos style-font",style:D({backgroundImage:`url(${((c=(h=(u=p.style)==null?void 0:u.bgImg)==null?void 0:h.urls)==null?void 0:c.thumb)||""})`,backgroundColor:((I=p.style)==null?void 0:I.bgClr)||""})},[o("h2",jl,v(p.title),1),o("a",{class:"star-container",onClick:_(y=>s.toggleFavorite(p._id),["stop"])},[p.isFavorite?(n(),a("img",Vl)):(n(),a("img",ql))],8,Pl)],12,Rl)}),128))])]),Hl,o("article",Wl,[(n(!0),a(C,null,w(s.boards,p=>{var u,h,c,I;return n(),a("div",{key:p._id,onClick:y=>s.toBoardDetails(p._id),class:"board-preview img-pos style-font",style:D({backgroundImage:`url(${((c=(h=(u=p.style)==null?void 0:u.bgImg)==null?void 0:h.urls)==null?void 0:c.thumb)||""})`,backgroundColor:((I=p.style)==null?void 0:I.bgClr)||""})},[o("h2",zl,v(p.title),1),o("a",{class:"star-container",onClick:_(y=>s.toggleFavorite(p._id),["stop"])},[p.isFavorite?(n(),a("img",Ql)):(n(),a("img",Zl))],8,Xl)],12,Yl)}),128)),o("button",{onClick:e[0]||(e[0]=p=>i.isCreateBoard=!0),class:"board-preview justify-center add-card"}," Create new board "),i.isCreateBoard?(n(),k(d,{key:0,onCloseCmp:e[1]||(e[1]=p=>i.isCreateBoard=!1)})):m("",!0)])])])}var ed=T(Ml,[["render",Kl]]);const td={name:"home",data(){return{loginCred:{username:"",password:""},signupCred:{fullname:"",username:"",password:""},isSignIn:!0,msg:""}},computed:{loggedinUser(){return this.$store.getters.loggedinUser},loginSignUpButton(){return this.isSignIn?"Sign up for an account":"Back"}},created(){this.loadUsers()},methods:{async doLogin(){if(!this.loginCred.username){this.msg="Please enter username/password";return}try{await this.$store.dispatch({type:"login",userCred:this.loginCred}),this.$router.push("/board")}catch{this.msg="Failed to login"}},doLogout(){this.$store.dispatch({type:"logout"})},async doSignup(){if(!this.signupCred.fullname||!this.signupCred.password||!this.signupCred.username){this.msg="Please fill out all of the form details";return}try{await this.$store.dispatch({type:"signup",userCred:this.signupCred}),this.$router.push("/board")}catch{this.msg="Failed to sign up new user"}},toggleLoginSignUp(){this.isSignIn=!this.isSignIn},async removeUser(t){try{await this.$store.dispatch({type:"removeUser",userId:t}),this.msg="User removed"}catch{this.msg="Failed to remove user"}},async guestLogin(){try{await this.$store.dispatch({type:"loginGuest"}),this.$router.push("/board")}catch(t){console.log(t),this.msg="Failed to do guest login"}},loadUsers(){this.$store.dispatch({type:"loadUsers"})}}},sd={class:"login-page"},od=o("h1",{class:"login-logo-header"},[o("div",{class:"login-icon"},[o("span")]),L(" Mellow ")],-1),id={class:"main-login-container"},rd=o("p",{class:"login-welcome-msg"},"Log in to Mellow",-1),nd={key:1,class:"login-form-container"},ad=o("button",{class:"login-button pointer"},"Log In",-1),ld=o("div",{class:"or-div"},"OR",-1),dd=o("button",{class:"login-button pointer"},"Log In",-1),cd=o("hr",{class:"thin-hr"},null,-1),ud={class:"signup-select-container"},hd=o("span",{class:"trello-dot"},null,-1);function pd(t,e,r,l,i,s){return n(),a("section",sd,[od,o("div",id,[rd,s.loggedinUser?(n(),a("button",{key:0,class:"log-out-button pointer",onClick:e[0]||(e[0]=(...d)=>s.doLogout&&s.doLogout(...d))}," Log Out "+v(s.loggedinUser.username),1)):(n(),a("section",nd,[i.isSignIn?(n(),a("form",{key:0,class:"sign-in-form",onSubmit:e[4]||(e[4]=_((...d)=>s.doLogin&&s.doLogin(...d),["prevent"]))},[B(o("input",{class:"login-form-input",type:"text","onUpdate:modelValue":e[1]||(e[1]=d=>i.loginCred.username=d),placeholder:"Enter username"},null,512),[[U,i.loginCred.username]]),B(o("input",{class:"login-form-input",type:"password","onUpdate:modelValue":e[2]||(e[2]=d=>i.loginCred.password=d),placeholder:"Enter password"},null,512),[[U,i.loginCred.password]]),ad,ld,o("button",{class:"login-button guest pointer",onClick:e[3]||(e[3]=(...d)=>s.guestLogin&&s.guestLogin(...d))}," Log In as Guest ")],32)):m("",!0),i.isSignIn?m("",!0):(n(),a("form",{key:1,class:"sign-up-form",onSubmit:e[8]||(e[8]=_((...d)=>s.doSignup&&s.doSignup(...d),["prevent"]))},[B(o("input",{class:"login-form-input",type:"text","onUpdate:modelValue":e[5]||(e[5]=d=>i.signupCred.fullname=d),placeholder:"Enter your full name"},null,512),[[U,i.signupCred.fullname]]),B(o("input",{class:"login-form-input",type:"text","onUpdate:modelValue":e[6]||(e[6]=d=>i.signupCred.username=d),placeholder:"Enter username"},null,512),[[U,i.signupCred.username]]),B(o("input",{class:"login-form-input",type:"password","onUpdate:modelValue":e[7]||(e[7]=d=>i.signupCred.password=d),placeholder:"Enter password"},null,512),[[U,i.signupCred.password]]),dd],32)),cd,o("div",ud,[o("a",{class:"sign-up-toggle pointer",onClick:e[9]||(e[9]=(...d)=>s.toggleLoginSignUp&&s.toggleLoginSignUp(...d))}," Can't log in?"),hd,o("a",{class:"sign-up-toggle pointer",onClick:e[10]||(e[10]=(...d)=>s.toggleLoginSignUp&&s.toggleLoginSignUp(...d))},v(s.loginSignUpButton),1)])]))])])}var md=T(td,[["render",pd]]);const gd=De({history:Ue("/"),routes:[{path:"/",name:"home",component:ds},{path:"/login",name:"login",component:md},{path:"/board",name:"work-space",component:ed},{path:"/board/:boardId",name:"board-details",component:Nl,children:[{path:":groupId/:taskId",name:"task-details",component:ke}]},{path:"/about",name:"about",component:gs}]});var bd={state:{boards:[],currBoard:null,filterBy:null},getters:{boards({boards:t}){return JSON.parse(JSON.stringify(t))},favoriteBoards({boards:t}){return t.filter(e=>e.isFavorite)},getCurrBoard({currBoard:t}){return JSON.parse(JSON.stringify(t))}},mutations:{setFilter(t,{filterBy:e}){t.filterBy=e},setBoards(t,{boards:e}){t.boards=e},addBoard(t,{board:e}){t.boards.push(e)},removeBoard(t,{boardId:e}){t.boards=t.boards.filter(r=>r._id!==e)},setCurrBoard(t,{board:e}){t.currBoard=JSON.parse(JSON.stringify(e))},saveBoard(t,{savedBoard:e}){const r=t.boards.findIndex(l=>l._id===e._id);t.boards.splice(r,1,e)}},actions:{async loadBoards({commit:t}){try{const e=await J.query();t({type:"setBoards",boards:e})}catch(e){console.log("board module loadBoards cant load boards now",e)}},async loadBoard({commit:t},{boardId:e}){try{const r=await J.getById(e);return t({type:"setCurrBoard",board:r}),JSON.parse(JSON.stringify(r))}catch(r){console.log("board module loadBoard cant load board now",r)}},async addBoard({dispatch:t},{title:e,bgClr:r,bgImg:l}){try{const i=J.getEmptyBoard();i.title=e,i.style.bgClr=r,i.style.bgImg=l;const s={txt:"Add board"};return await t({type:"saveBoard",board:JSON.parse(JSON.stringify(boardToUpdate)),activity:JSON.parse(JSON.stringify(s))})}catch(i){console.log("board module addBoard cant load boards now",i)}},async removeBoard({commit:t},{boardId:e}){try{await J.remove(e),t({type:"removeBoard",boardId:e})}catch(r){console.log("board module removeBoard cant load boards now",r)}},async removeTask({dispatch:t,state:e},{boardId:r,groupId:l,task:i,changeType:s}){try{const d=JSON.parse(JSON.stringify(e.boards.find(c=>c._id===r))),p=d.groups.find(c=>c.id===l),u=p.tasks.findIndex(c=>c.id===i.id);p.tasks.splice(u,1);const h={txt:s,groupId:l,task:{id:i.id,title:i.title}};return await t({type:"saveBoard",board:JSON.parse(JSON.stringify(d)),activity:JSON.parse(JSON.stringify(h))})}catch(d){console.log("board module removeTask cant remove task now",d)}},async removeGroup({dispatch:t,state:e},{boardId:r,groupId:l}){try{const i=JSON.parse(JSON.stringify(e.boards.find(p=>p._id===r))),s=i.groups.findIndex(p=>p.id===l);i.groups.splice(s,1);const d={txt:"remove group",group:{id:l}};return await t({type:"saveBoard",board:JSON.parse(JSON.stringify(i)),activity:JSON.parse(JSON.stringify(d))})}catch(i){console.log("board module removeGroup cant remove group now",i)}},async editBoard({state:t,dispatch:e},{boardId:r,changeType:l,val:i}){try{const s=JSON.parse(JSON.stringify(t.boards.find(u=>u._id===r)));let d;switch(l){case"bgClr":s.style[l]=i,s.style.bgImg="",d="background";break;case"bgImg":s.style[l]=i,s.style.bgClr="",d="background";break;case"board title":s.title=i.currentTarget.textContent,d="title";break;case"toggle favorite":s.isFavorite=!s.isFavorite,d="toggle favorite";break;case"add members":let u=s.members.map(h=>h._id);i.forEach(h=>{u!=null&&u.includes(h._id)||s.members.push(JSON.parse(JSON.stringify(h)))}),d="members";break;case"update labels":if(typeof i=="string"){const h=s.labels.findIndex(c=>c.id===i);s.labels.splice(h,1)}else{const h=s.labels.findIndex(c=>c.id===i.id);h===-1?s.labels.push(i):s.labels.splice(h,1,i)}d="labels";break}const p={txt:`Change board ${d}`};return await e({type:"saveBoard",board:JSON.parse(JSON.stringify(s)),activity:JSON.parse(JSON.stringify(p))})}catch(s){throw console.log("board module editBoard cant edit board now",s),s}},async saveBoard({commit:t},{board:e,activity:r}){try{const l=await J.save(e,r);return t({type:"saveBoard",savedBoard:l}),t({type:"setCurrBoard",board:l}),JSON.parse(JSON.stringify(l))}catch(l){throw console.log("board module saveBoard cant save board now",l),l}},async attachImg({commit:t},{ev:e}){try{return await J.uploadImg(e)}catch(r){console.log("board module attachImg cant attach img now",r)}},async saveTask({dispatch:t,state:e},{boardId:r,groupId:l,task:i,changeType:s}){try{const d=JSON.parse(JSON.stringify(e.boards.find(c=>c._id===r))),p=d.groups.find(c=>c.id===l),u=p.tasks.findIndex(c=>c.id===i.id);u===-1?p.tasks.push(i):p.tasks.splice(u,1,i);const h={txt:s,groupId:l,task:{id:i.id,title:i.title}};return await t({type:"saveBoard",board:JSON.parse(JSON.stringify(d)),activity:JSON.parse(JSON.stringify(h))})}catch(d){console.log("board module saveTask cant save task now",d)}},async saveGroup({dispatch:t,state:e},{boardId:r,group:l,changeType:i}){try{const s=JSON.parse(JSON.stringify(e.boards.find(u=>u._id===r))),d=s.groups.findIndex(u=>u.id===l.id);d===-1?s.groups.push(l):s.groups.splice(d,1,l);const p={txt:i,group:{id:l.id,title:l.title}};return await t({type:"saveBoard",board:JSON.parse(JSON.stringify(s)),activity:JSON.parse(JSON.stringify(p))})}catch(s){console.log("board module saveGroup cant save group now",s)}}}},_d={state:{loggedinUser:$.getLoggedinUser(),users:[],watchedUser:null,guestUser:$.getGuestUser()},getters:{users({users:t}){return JSON.parse(JSON.stringify(t))},loggedinUser({loggedinUser:t}){return t},watchedUser({watchedUser:t}){return t},getGuestUser({guestUser:t}){return t}},mutations:{setLoggedinUser(t,{user:e}){t.loggedinUser=e?ce({},e):null},setWatchedUser(t,{user:e}){t.watchedUser=e},setUsers(t,{users:e}){t.users=e},removeUser(t,{userId:e}){t.users=t.users.filter(r=>r._id!==e)},setGuestUser(t,{guestUser:e}){t.guestUser=e}},actions:{async login({commit:t},{userCred:e}){try{const r=await $.login(e);return t({type:"setLoggedinUser",user:r}),r}catch(r){throw console.log("userStore: Error in login",r),r}},async signup({commit:t},{userCred:e}){try{const r=await $.signup(e);return t({type:"setLoggedinUser",user:r}),r}catch(r){throw console.log("userStore: Error in signup",r),r}},async logout({commit:t}){try{await $.logout(),t({type:"setLoggedinUser",user:null})}catch(e){throw console.log("userStore: Error in logout",e),e}},loginGuest({commit:t}){const e=$.getGuestUser();t({type:"setLoggedinUser",user:e})},async loadUsers({commit:t}){try{const e=await $.getUsers();t({type:"setUsers",users:e})}catch(e){throw console.log("userStore: Error in loadUsers",e),e}},async getUserById({commit:t},{userId:e}){try{const r=await $.getById(e);return JSON.parse(JSON.stringify(r))}catch(r){throw console.log("userStore: Error in getUserById",r),r}},async loadAndWatchUser({commit:t},{userId:e}){try{console.log("store");const r=await $.getById(e);t({type:"setWatchedUser",user:r}),O.off(ue),O.on(ue,l=>{t({type:"setWatchedUser",user:l})})}catch(r){throw console.log("userStore: Error in loadAndWatchUser",r),r}},async removeUser({commit:t},{userId:e}){try{await $.remove(e),t({type:"removeUser",userId:e})}catch(r){throw console.log("userStore: Error in removeUser",r),r}},async updateUser({commit:t},{user:e}){try{e=await $.update(e),t({type:"setUser",user:e})}catch(r){throw console.log("userStore: Error in updateUser",r),r}},loadGuestUser({commit:t}){const e=$.getGuestUser();t({type:"setGuestUser",guestUser:e})},async loadUsers({commit:t}){try{const e=await $.getUsers();t({type:"setUsers",users:e})}catch(e){throw console.log("userStore: Error in loadUsers",e),e}}}};const fd=Le({strict:!0,state:{},getters:{},mutations:{},actions:{},modules:{boardStore:bd,userStore:_d}}),kd={mounted(t){t.focus()}};const R=Oe(Qt);R.directive("focus",kd);R.use(Ae);R.use(Ne,{});R.use(Me,{accessKey:"Y2X6Y_wdMpqvaYX_4jgO-dOBqVAsQMQpihsIFNOAX5E",secret:"W5FeRrlFbgAz3i3d54dHnDm9okVhUeUIXZ6TyvZC_H4"});R.use(Ee);R.use(gd);R.use(fd);R.mount("#app");
