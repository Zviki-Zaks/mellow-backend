var we=Object.defineProperty;var ae=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var le=(t,e,i)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,de=(t,e)=>{for(var i in e||(e={}))Te.call(e,i)&&le(t,i,e[i]);if(ae)for(var i of ae(e))Ie.call(e,i)&&le(t,i,e[i]);return t};import{a as q,l as Se,o as n,c as a,b as o,F as f,r as k,t as b,d as ce,e as g,f as F,n as $,g as I,w,h as x,v as D,i as E,j as m,k as C,m as L,p as y,_ as he,q as Be,C as me,D as pe,s as xe,u as $e,x as De,y as Ue,z as Le,A as Ae,B as Oe,U as Me,E as Ne}from"./vendor.e9dda239.js";const Fe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}};Fe();const Ee="/api/";var Ge=q.create({withCredentials:!0});const N={get(t,e){return P(t,"GET",e)},post(t,e){return P(t,"POST",e)},put(t,e){return P(t,"PUT",e)},delete(t,e){return P(t,"DELETE",e)}};async function P(t,e="GET",i=null){try{return(await Ge({url:`${Ee}${t}`,method:e,data:i,params:e==="GET"?i:null})).data}catch(l){throw console.log(`Had Issues ${e}ing to the backend, endpoint: ${t}, with data:`,i),console.dir(l),l.response&&l.response.status,l}}const ue="user-updated",Re="",M=Je();M.setup();function Je(){var t=null;return{async setup(){t=Se(Re)},on(i,l){t.on(i,l)},off(i,l=null){!t||(l?t.off(i,l):t.removeAllListeners(i))},emit(i,l){t.emit(i,l)},terminate(){t=null}}}const W="loggedinUser",U={login:We,logout:Ye,signup:He,getLoggedinUser:ge,getUsers:je,getById:Pe,remove:Ve,update:qe,getGuestUser:ze};async function je(){return await N.get("user")}async function Pe(t){return await N.get(`user/${t}`)}function Ve(t){return N.delete(`user/${t}`)}async function qe(t){return t=await N.put(`user/${t._id}`,t),ge()._id===t._id&&H(t),t}async function We(t){const e=await N.post("auth/login",t);if(M.emit("set-user-socket",e._id),e)return H(e)}async function He(t){const e=await N.post("auth/signup",t);return M.emit("set-user-socket",e._id),H(e)}async function Ye(){return sessionStorage.removeItem(W),M.emit("unset-user-socket"),await N.post("auth/logout")}function H(t){return sessionStorage.setItem(W,JSON.stringify(t)),t}function ge(){return JSON.parse(sessionStorage.getItem(W)||"null")}function ze(){return{_id:"624298a9e48762573484a9e5",username:"Guest",fullname:"Guest User",imgUrl:"../src/assets/svgs/guest.svg"}}var _e="/assets/board.17ad90ee.jpg",T=(t,e)=>{const i=t.__vccOpts||t;for(const[l,r]of e)i[l]=r;return i};const Xe={methods:{goToBoard(t){this.$emit("closeCmp"),this.$router.push(`/board/${t}`)}},computed:{boards(){return this.$store.getters.boards}}},Qe={class:"board-recent"},Ze={class:"cmp-header"},Ke=o("p",{class:"cmp-container-title"},"Recent",-1),et=o("span",null,null,-1),tt=[et],st=o("hr",{class:"thin-hr"},null,-1),ot={class:"recent-boards-list"},rt=["onClick"],it=["src"],nt={key:1,class:"recent-board-preview-img",src:_e},at={class:"recent-board-title"};function lt(t,e,i,l,r,s){return n(),a("section",Qe,[o("div",Ze,[Ke,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=u=>t.$emit("closeCmp"))},tt)]),st,o("div",ot,[(n(!0),a(f,null,k(s.boards,u=>(n(),a("div",{class:"recent-board-preview flex",key:u._id,onClick:c=>s.goToBoard(u._id)},[u.style.bgImg?(n(),a("img",{key:0,class:"recent-board-preview-img",src:u.style.bgImg.urls.thumb},null,8,it)):(n(),a("img",nt)),o("p",at,b(u.title),1)],8,rt))),128))])])}var dt=T(Xe,[["render",lt]]);const ct={},ut={class:"list-slot-container"},ht={class:"list-title"},mt={class:"slot-options-list"};function pt(t,e){return n(),a("article",ut,[o("div",ht,[ce(t.$slots,"title")]),o("div",mt,[ce(t.$slots,"list")])])}var V=T(ct,[["render",pt]]),gt="/assets/groups.80c5d532.svg";const _t={data(){return{title:"",bgClr:"",bgImg:"",selectedBg:"",photos:["https://images.unsplash.com/photo-1648138754706-4fccd621a5f9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=Mnw3MDY2fDB8MXxjb2xsZWN0aW9ufDR8MzE3MDk5fHx8fHwyfHwxNjQ4NjUyNTQ3&ixlib=rb-1.2.1&q=80&w=400","https://images.unsplash.com/photo-1648537949908-25fc530b5f7d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=Mnw3MDY2fDB8MXxjb2xsZWN0aW9ufDF8MzE3MDk5fHx8fHwyfHwxNjQ4NjUyNTQ3&ixlib=rb-1.2.1&q=80&w=400","https://images.unsplash.com/photo-1647960666864-01fdaed3431f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=Mnw3MDY2fDB8MXxjb2xsZWN0aW9ufDE0fDMxNzA5OXx8fHx8Mnx8MTY0ODY1MjU0Nw&ixlib=rb-1.2.1&q=80&w=400"],isRequired:!1,bgColors:[{id:"l101",color:"#61bd4f",isSelected:!1},{id:"l102",color:"#f2d600",isSelected:!1},{id:"l103",color:"#ff9f1a",isSelected:!1},{id:"l104",color:"#eb5a46",isSelected:!1},{id:"l105",color:"#c377e0",isSelected:!1},{id:"l106",color:"#0079bf",isSelected:!1},{id:"l107",color:"#00c2e0",isSelected:!1},{id:"l108",color:"#51e898",isSelected:!1},{id:"l109",color:"#ff78cb",isSelected:!1},{id:"l110",color:"#344563",isSelected:!1}]}},methods:{requiredTitle(){this.title||(this.isRequired=!0)},async addBoard(){const t=await this.$store.dispatch({type:"addBoard",title:this.title,bgClr:this.bgClr,bgImg:this.bgImg});this.$router.push(`/board/${t}`),this.$emit("closeCmp")},selectBg(t,e){this[t]=e,this.selectedBg=e}},computed:{required(){return{required:this.isRequired}}},components:{listSlot:V}},bt={class:"create-board"},vt={class:"cmp-header"},ft=o("p",{class:"cmp-container-title"},"Create board",-1),kt=o("span",null,null,-1),yt=[kt],Ct=o("hr",{class:"thin-hr"},null,-1),wt={class:"choose-bg-container"},Tt=o("p",{class:"choose-bg-title"},"Background",-1),It=o("img",{class:"bg-preview-img",src:gt},null,-1),St=[It],Bt=["src","onClick"],xt=["onClick"],$t={class:"add-title-container"},Dt=o("p",{class:"add-title-title"},"Board title",-1),Ut={key:0,class:"add-title-required"},Lt=["disabled"];function At(t,e,i,l,r,s){const u=g("list-slot"),c=F("focus");return n(),a("section",bt,[o("div",vt,[ft,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=h=>t.$emit("closeCmp"))},yt)]),Ct,o("div",wt,[Tt,o("div",{class:"bg-preview",style:$({backgroundColor:r.selectedBg,backgroundImage:"url("+r.selectedBg+")"})},St,4),I(u,null,{list:w(()=>[(n(!0),a(f,null,k(r.photos,(h,d)=>(n(),a("img",{key:d,class:"unsplash-result-small",src:h,alt:"img",onClick:p=>s.selectBg("bgImg",h)},null,8,Bt))),128))]),_:1}),I(u,null,{list:w(()=>[(n(!0),a(f,null,k(r.bgColors,h=>(n(),a("div",{key:h.id,class:"label-option flex pointer",style:$({backgroundColor:h.color}),onClick:d=>s.selectBg("bgClr",h.color)},null,12,xt))),128))]),_:1})]),o("div",$t,[Dt,x(o("input",{class:E(["add-title-input",s.required]),type:"text","onUpdate:modelValue":e[1]||(e[1]=h=>r.title=h),placeholder:"Enter title..",onBlur:e[2]||(e[2]=(...h)=>s.requiredTitle&&s.requiredTitle(...h)),onFocus:e[3]||(e[3]=h=>r.isRequired=!1)},null,34),[[D,r.title],[c]]),r.isRequired?(n(),a("p",Ut," \u{1F44B} Board title is required ")):m("",!0)]),o("button",{class:"create-board-btn",onClick:e[4]||(e[4]=(...h)=>s.addBoard&&s.addBoard(...h)),disabled:!r.title}," Create ",8,Lt)])}var be=T(_t,[["render",At]]);const Ot={props:{user:Object},methods:{},computed:{imgAvatar(){if(this.user.imgUrl)return this.user.imgUrl},nameAvatar(){if(!this.user.imgUrl){const e=this.user.fullname.split(" ");var t="";return e.forEach(i=>{t+=i.charAt(0)}),t.toUpperCase()}}}},Mt={class:"user-avatar"},Nt={key:0,class:"user-avatar-guest flex"},Ft=["src"],Et={key:2,class:"user-avatar-name flex"};function Gt(t,e,i,l,r,s){return n(),a("div",Mt,[i.user.username==="Guest"?(n(),a("span",Nt)):i.user.imgUrl?(n(),a("img",{key:1,class:"user-avatar-img",src:s.imgAvatar},null,8,Ft)):(n(),a("span",Et,b(s.nameAvatar),1))])}var R=T(Ot,[["render",Gt]]),Rt="/assets/trello.92b2080b.svg",Jt="/assets/bell.adefe4be.svg";const jt={data(){return{handles:{isRecent:!1,isCreateBoard:!1},isBlue:!1,isLogin:!1}},created(){},methods:{openCmp(t){if(typeof t!="string"){for(let e in this.handles)this.handles[e]=!1;return}if(this.handles[t]===!0)this.handles[t]=!1;else{for(let e in this.handles)this.handles[e]=!1;this.handles[t]=!0}}},computed:{bgc(){return{blue:this.isBlue}},currLoggedInUser(){const t=this.$store.getters.loggedinUser;return t&&(this.userLoggedIn=!0),t||this.$store.getters.getGuestUser},userIsLoggedIn(){if(this.$store.getters.loggedinUser)return!0}},watch:{"$route.path":{immediate:!0,handler(){const t=this.$route.path;t==="/board"||t==="/login"?this.isBlue=!0:this.isBlue=!1}}},components:{boardRecent:dt,createBoard:be,userAvatar:R}},Pt={class:"app-header-inner flex"},Vt=o("img",{class:"logo-img",src:Rt,alt:""},null,-1),qt=o("h3",{class:"logo"},"Mellow",-1),Wt={class:"app-header-nav flex"},Ht={class:"app-header-left-nav flex"},Yt=L(" Workspace "),zt=o("span",{class:"header-arrow-icon"},null,-1),Xt=[Yt,zt],Qt=L(" Recent "),Zt=o("span",{class:"header-arrow-icon"},null,-1),Kt=[Qt,Zt],es=L(" Create "),ts={key:0,class:"header-arrow-icon"},ss={class:"app-header-right-nav flex"},os=L("Log in"),rs=L("Sign up"),is=o("img",{src:Jt},null,-1);function ns(t,e,i,l,r,s){const u=g("router-link"),c=g("board-recent"),h=g("create-board"),d=g("user-avatar");return n(),a("header",{class:E(["app-header-container",s.bgc])},[o("div",Pt,[I(u,{class:"logo-link flex",to:"/"},{default:w(()=>[Vt,qt]),_:1}),o("nav",Wt,[o("div",Ht,[o("button",{class:"btn-header flex",onClick:e[0]||(e[0]=p=>t.$router.push("/board"))},Xt),o("button",{class:"btn-header recent flex",onClick:e[1]||(e[1]=p=>s.openCmp("isRecent"))},Kt),r.handles.isRecent?(n(),C(c,{key:0,onCloseCmp:s.openCmp},null,8,["onCloseCmp"])):m("",!0),o("button",{class:"btn-header create flex",onClick:e[2]||(e[2]=p=>s.openCmp("isCreateBoard"))},[es,r.handles.isCreateBoard?(n(),a("span",ts)):m("",!0)]),r.handles.isCreateBoard?(n(),C(h,{key:1,onCloseCmp:s.openCmp},null,8,["onCloseCmp"])):m("",!0)]),o("div",ss,[s.userIsLoggedIn?m("",!0):(n(),C(u,{key:0,class:"login-btn",onClick:e[3]||(e[3]=p=>r.isLogin=!0),to:"/login"},{default:w(()=>[os]),_:1})),s.userIsLoggedIn?m("",!0):(n(),C(u,{key:1,class:"signup-btn",onClick:e[4]||(e[4]=p=>r.isLogin=!0),to:"/login"},{default:w(()=>[rs]),_:1})),I(u,{to:"/login",class:"header-bell pointer"},{default:w(()=>[is]),_:1}),I(u,{to:"/login",class:"avatar-login-link"},{default:w(()=>[s.currLoggedInUser?(n(),C(d,{key:0,class:"pointer",user:s.currLoggedInUser},null,8,["user"])):m("",!0)]),_:1})])])])],2)}var as=T(jt,[["render",ns]]);const ls={components:{appHeader:as},data(){return{}},created(){this.$store.dispatch({type:"loadBoards"}),this.$store.dispatch({type:"loadGuestUser"})},methods:{},computed:{},unmounted(){}};function ds(t,e,i,l,r,s){const u=g("app-header"),c=g("router-view");return n(),a(f,null,[I(u),I(c)],64)}var cs=T(ls,[["render",ds]]),us="/assets/mellow-cover.354e12f4.png",hs="/assets/example-board.a4540770.png";const ms={components:{},data(){return{}},created(){},methods:{},computed:{},unmounted(){}},ps={class:"home-page-container"},gs={class:"title-container"},_s=o("h1",{class:"home-logo"}," Mellow helps teams move work forward ",-1),bs=o("h3",{class:"title"},"Collaborate, manage projects, and reach new productivity peaks. From high rises to the home office, the way your your team works is unique - accomplish it all with Mellow",-1),vs=o("span",{class:"guest-login-button"},"See Demo",-1),fs=o("div",{class:"homepage-img"},[o("img",{class:"home-page-img",src:us})],-1),ks=o("div",{class:"secondary-text"},[o("h1",null," It's more than work. It's a way of working together."),o("h3",null,"Start with a Mellow board, lists, and cards. Customize and expand with more features as your teamwork grows. Manage projects, organize tasks, and build team spirit\u2014all in one place."),o("img",{src:hs,alt:""})],-1);function ys(t,e,i,l,r,s){const u=g("router-link");return n(),a("section",ps,[o("div",gs,[_s,bs,I(u,{class:"home-link",to:"/board"},{default:w(()=>[vs]),_:1}),fs]),ks])}var Cs=T(ms,[["render",ys]]);const ws={},Ts={class:"about"},Is=o("h1",null,"This is an about page",-1),Ss=[Is];function Bs(t,e){return n(),a("div",Ts,Ss)}var xs=T(ws,[["render",Bs]]);const O={saveToStorage:$s,loadFromStorage:Ds,makeId:Ls,getRandomIntInclusive:As,delay:Us,isDarkColor:Os};function $s(t,e){localStorage.setItem(t,JSON.stringify(e)||null)}function Ds(t){let e=localStorage.getItem(t);return e?JSON.parse(e):void 0}function Us(t=1500){return new Promise(e=>{setTimeout(e,t)})}function Ls(t=8){for(var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=0;l<t;l++)e+=i.charAt(Math.floor(Math.random()*i.length));return e}function As(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1)+t)}function Os(t){if(!t)return;t=t.substring(1);const e=parseInt(t,16),i=e>>16&255,l=e>>8&255,r=e>>0&255;var s=.2126*i+.7152*l+.0722*r;return s<100}const j="board",A={query:Ms,getById:Ns,remove:Fs,save:Es,getEmptyBoard:js,getEmptyGroup:Rs,getEmptyTask:Js,uploadImg:Gs};async function Ms(t={}){return await N.get(j,t)}async function Ns(t){return await N.get(`${j}/${t}`)}async function Fs(t){return await N.delete(`${j}/${t}`)}async function Es(t,e){t.activities.length<=30&&(t.activities.shift(),t.activities.push(e));const i=t._id?await N.put(`${j}/${t._id}`,t):await N.post(j,t);return M.emit("board updated"),i}async function Gs(t){const e="cajan_22",l="https://api.cloudinary.com/v1_1/cajan22a/image/upload",r=new FormData;return r.append("file",t.target.files[0]),r.append("upload_preset",e),fetch(l,{method:"POST",body:r}).then(s=>s.json()).then(s=>s).catch(s=>console.error(s))}function Rs(){return{id:"g-"+O.makeId(),title:"Enter Group Name",tasks:[],style:{}}}function Js(){return{id:"t-"+O.makeId(),title:"",createdAt:Date.now(),style:{},attachments:[]}}function js(){return{title:"",isFavorite:!1,createdAt:Date.now(),archivedAt:null,createdBy:U.getLoggedinUser()||U.getGuestUser(),style:{bgClr:"",bgImg:""},labels:[],members:[{_id:"u105",fullname:"Yoni Lazarus",username:"Yoni",imgUrl:"https://res.cloudinary.com/cajan22a/image/upload/v1648369158/WhatsApp_Image_2022-03-27_at_11.02.12_gmtcrl.jpg"},{_id:"u106",fullname:"Almog Ben-Binyamin",username:"Almog",imgUrl:"https://res.cloudinary.com/cajan22a/image/upload/v1648369158/WhatsApp_Image_2021-12-10_at_16.38.26_sft38h.jpg"},{_id:"u107",fullname:"Zviki Zaks",username:"Zviki",imgUrl:"https://res.cloudinary.com/cajan22a/image/upload/v1648369158/WhatsApp_Image_2022-03-27_at_11.17.15_rq2ja9.jpg"}],groups:[],activities:[]}}function Ps(t,e){const i=({detail:l})=>{e(l)};return window.addEventListener(t,i),()=>{window.removeEventListener(t,i)}}function Vs(t,e){window.dispatchEvent(new CustomEvent(t,{detail:e}))}const qs={on:Ps,emit:Vs},Ws={props:{imgUrls:Array},components:{},data(){return{isLoading:!1,input:null}},created(){},methods:{onAttachImg(t){this.isLoading=!0,this.$emit("attachImg",t),this.isLoading=!1},showLink(){console.log(this.input),console.log("not working till we fix img upload on second time")},closeCmp(){this.$emit("closeCmp")}},computed:{},unmounted(){}},Hs={class:"attachment-preview cmp-preview"},Ys={class:"cmp-header"},zs=o("span",null,null,-1),Xs=[zs],Qs=o("p",{class:"attach-from"},"Attach from...",-1),Zs=o("hr",{class:"thin-hr"},null,-1),Ks=o("div",{class:"pointer"},"Computer",-1),eo=o("hr",{class:"thin-hr"},null,-1),to=o("div",{class:"attach-link-title"},"Attach a link",-1),so=o("div",{class:"attach-preview"},null,-1);function oo(t,e,i,l,r,s){const u=F("focus");return n(),a("section",Hs,[o("div",Ys,[o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=(...c)=>s.closeCmp&&s.closeCmp(...c))},Xs)]),o("label",null,[o("input",{type:"file",onChange:e[1]||(e[1]=(...c)=>s.onAttachImg&&s.onAttachImg(...c)),hidden:""},null,32),Qs,Zs,Ks]),eo,to,x(o("input",{"onUpdate:modelValue":e[2]||(e[2]=c=>r.input=c),class:"attach-input",type:"text",placeholder:"Paste any link here..."},null,512),[[u],[D,r.input]]),o("button",{class:"attach-link-btn",onClick:e[3]||(e[3]=(...c)=>s.showLink&&s.showLink(...c))},"Attach"),so])}var ro=T(Ws,[["render",oo]]);const io={name:"date-preview",props:{dueDate:String},created(){this.date.dueDate=this.dueDate},data(){return{date:{dueDate:null,isCompleted:!1}}},methods:{saveDate(){this.$emit("saveDate",this.date)},closeCmp(){this.date.dueDate=this.dueDate,this.$emit("closeCmp")}}},no={class:"date-preview pointer"},ao={class:"date-header"},lo=o("h3",{class:"date-title"},"Dates",-1),co=o("hr",{class:"thin-hr"},null,-1);function uo(t,e,i,l,r,s){const u=g("v-date-picker");return n(),a("section",no,[o("div",ao,[lo,o("button",{class:"add-task-close-cmp-btn",onClick:e[0]||(e[0]=(...c)=>s.closeCmp&&s.closeCmp(...c))})]),co,I(u,{modelValue:r.date.dueDate,"onUpdate:modelValue":e[1]||(e[1]=c=>r.date.dueDate=c),mode:"dateTime","minute-increment":5},null,8,["modelValue"]),o("button",{class:"save-btn date-btn",onClick:e[2]||(e[2]=(...c)=>s.saveDate&&s.saveDate(...c))},"Save"),o("button",{class:"remove-date-btn date-btn",onClick:e[3]||(e[3]=(...c)=>s.closeCmp&&s.closeCmp(...c))},"Remove")])}var ho=T(io,[["render",uo]]);const mo={props:{type:String},components:{},data(){return{}},created(){},methods:{closeCmp(){this.$emit("closeCmp")},remove(){this.$emit("remove")}},computed:{},unmounted(){}},po={class:"delete-preview"},go={class:"delete-header flex"},_o={class:"cmp-header-title"},bo=o("hr",{class:"thin-hr"},null,-1),vo={class:"delete-content-container"},fo={key:0},ko={key:1},yo={key:2};function Co(t,e,i,l,r,s){return n(),a("section",po,[o("div",go,[o("span",_o,"Delete "+b(i.type)+"?",1),o("a",{onClick:e[0]||(e[0]=(...u)=>s.closeCmp&&s.closeCmp(...u)),class:"close-delete pointer"})]),bo,o("div",vo,[i.type==="task"||i.type==="list"?(n(),a("p",fo," All actions will be removed from the activity feed and you won\u2019t be able to re-open the card. There is no undo. ")):i.type==="label"?(n(),a("p",ko," There is no undo. This will remove this label from all cards and destroy its history. ")):i.type==="checklist"?(n(),a("p",yo,"Deleting a checklist is permanent and there is no way to get it back.")):m("",!0),o("a",{onClick:e[1]||(e[1]=(...u)=>s.remove&&s.remove(...u)),class:"confirm-delete"},"Delete")])])}var Y=T(mo,[["render",Co]]);const wo={props:{boardLabels:Array,taskLabelIds:Array},emits:["addLabelToTask","addLabelToBoard","updateBoardLabels"],components:{listSlot:V,deleteCmp:Y},data(){return{labels:[],filterTxt:"",defaultLabels:[{id:"l101",color:"#61bd4f",title:"",isSelected:!1},{id:"l102",color:"#f2d600",title:"",isSelected:!1},{id:"l103",color:"#ff9f1a",title:"",isSelected:!1},{id:"l104",color:"#eb5a46",title:"",isSelected:!1},{id:"l105",color:"#c377e0",title:"",isSelected:!1},{id:"l106",color:"#0079bf",title:"",isSelected:!1},{id:"l107",color:"#00c2e0",title:"",isSelected:!1},{id:"l108",color:"#51e898",title:"",isSelected:!1},{id:"l109",color:"#ff78cb",title:"",isSelected:!1},{id:"l110",color:"#344563",title:"",isSelected:!1}],isCreate:!1,isChange:!1,isRemove:!1,selectedLabel:null,labelToChange:{color:null,title:""}}},created(){this.aggregateLabels()},methods:{toggleLabel(t){this.$emit("addLabelToTask",t)},closeCmp(){this.$emit("closeCmp")},aggregateLabels(){this.labels=[],this.labels=this.boardLabels.map(t=>{var e;return t=JSON.parse(JSON.stringify(t)),(e=this.taskLabelIds)!=null&&e.includes(t.id)&&(t.inTask=!0),t})},openCreate(t){if(typeof t=="string"){this.labelToChange=JSON.parse(JSON.stringify(this.boardLabels.find(i=>i.id===t)));const e=this.defaultLabels.find(i=>i.color===this.labelToChange.color);this.selectLabel(e.id),this.isChange=!0;return}this.isCreate=!0},selectLabel(t){this.defaultLabels.forEach(i=>{i.isSelected=i.id===t});const e=this.defaultLabels.find(i=>i.id===t);this.labelToChange.color=e.color},async changeBoardLabels(){const t=JSON.parse(JSON.stringify(this.labelToChange));this.isCreate&&(t.id="l"+O.makeId()),await this.$emit("updateBoardLabels",t),this.aggregateLabels(),this.isCreate=!1,this.isChange=!1},async removeLabelFromBoard(){const t=this.labelToChange.id;await this.$emit("updateBoardLabels",t),this.aggregateLabels(),this.isCreate=!1,this.isChange=!1,this.isRemove=!1}},computed:{getLabels(){const t=new RegExp(this.filterTxt,"i");return this.labels.filter(e=>t.test(e.title))},cmpTitle(){return this.isChange?"Change label":this.isCreate?"Create label":"Labels"},createBtn(){if(this.isCreate)return"Create";if(this.isChange)return"Save"}},watch:{taskLabelIds(){this.aggregateLabels()}},unmounted(){}},To={key:0,class:"cmp-preview"},Io={class:"cmp-header"},So=o("span",null,null,-1),Bo=[So],xo={class:"cmp-container-title"},$o=o("span",null,null,-1),Do=[$o],Uo=o("hr",{class:"thin-hr"},null,-1),Lo={key:0,class:"select-label-container"},Ao={class:"choose-labels-container"},Oo=o("p",{class:"labels-title"},"Labels",-1),Mo={class:"labels-list flex clean-list"},No=["onClick"],Fo={class:"label-title"},Eo={key:0,class:"v-icon"},Go=["onClick"],Ro=o("a",null,null,-1),Jo=[Ro],jo={key:1,class:"create-label-container"},Po=o("p",{class:"labels-title"},"Name",-1),Vo=L("Select a color"),qo=["onClick"],Wo={key:0,class:"v-icon"},Ho={class:"create-label-buttons-container flex"};function Yo(t,e,i,l,r,s){const u=g("list-slot"),c=g("delete-cmp"),h=F("focus");return n(),a(f,null,[r.isRemove?m("",!0):(n(),a("section",To,[o("div",Io,[r.isCreate||r.isChange||r.isRemove?(n(),a("a",{key:0,class:"back-to-cmp-btn",onClick:e[0]||(e[0]=d=>(r.isCreate=!1,r.isChange=!1))},Bo)):m("",!0),o("p",xo,b(s.cmpTitle),1),o("a",{class:"close-cmp-btn",onClick:e[1]||(e[1]=(...d)=>s.closeCmp&&s.closeCmp(...d))},Do)]),Uo,!r.isCreate&&!r.isChange&&!r.isRemove?(n(),a("section",Lo,[x(o("input",{class:"label-input",type:"text","onUpdate:modelValue":e[2]||(e[2]=d=>r.filterTxt=d),placeholder:"Search labels.."},null,512),[[D,r.filterTxt],[h]]),o("div",Ao,[Oo,o("ul",Mo,[(n(!0),a(f,null,k(s.getLabels,d=>(n(),a("li",{class:"label-option-container flex",key:d.id},[o("div",{class:"label-option flex pointer",style:$({backgroundColor:d.color}),onClick:p=>s.toggleLabel(d.id)},[o("span",Fo,b(d.title),1),d.inTask?(n(),a("span",Eo)):m("",!0)],12,No),o("span",{class:"change-label-btn",onClick:p=>s.openCreate(d.id)},Jo,8,Go)]))),128))])]),o("button",{class:"open-create-label-btn",onClick:e[3]||(e[3]=(...d)=>s.openCreate&&s.openCreate(...d))},"Create a new label")])):(n(),a("section",jo,[o("label",null,[Po,x(o("input",{type:"text",class:"label-input","onUpdate:modelValue":e[4]||(e[4]=d=>r.labelToChange.title=d)},null,512),[[D,r.labelToChange.title],[h]])]),I(u,null,{title:w(()=>[Vo]),list:w(()=>[(n(!0),a(f,null,k(r.defaultLabels,d=>(n(),a("div",{key:d.id,class:"label-option flex pointer",style:$({backgroundColor:d.color}),onClick:p=>s.selectLabel(d.id)},[d.isSelected?(n(),a("span",Wo)):m("",!0)],12,qo))),128))]),_:1}),o("div",Ho,[o("button",{class:"create-label-btn",onClick:e[5]||(e[5]=y((...d)=>s.changeBoardLabels&&s.changeBoardLabels(...d),["stop"]))},b(s.createBtn),1),r.isChange?(n(),a("button",{key:0,class:"delete-label-btn",onClick:e[6]||(e[6]=y(d=>r.isRemove=!0,["stop"]))},"Delete")):m("",!0)])]))])),r.isRemove?(n(),C(c,{key:1,type:"label",onRemove:s.removeLabelFromBoard,onCloseCmp:s.closeCmp},null,8,["onRemove","onCloseCmp"])):m("",!0)],64)}var zo=T(wo,[["render",Yo]]);const Xo={props:{boardMembers:Object,task:Object},components:{userAvatar:R},data(){return{members:[],filterTxt:""}},created(){this.aggregateMembers()},methods:{closeCmp(){this.$emit("closeCmp")},toggleMemberInTask(t){this.$emit("toggleMemberInTask",t)},aggregateMembers(){var e;this.members=[];let t=(e=this.task.members)==null?void 0:e.map(i=>i._id);this.boardMembers.forEach(i=>{t!=null&&t.includes(i._id)&&(i.isCheck=!0),this.members.push(JSON.parse(JSON.stringify(i)))})}},computed:{getMembers(){const t=new RegExp(this.filterTxt,"i");return this.members.filter(e=>t.test(e.fullname))}},watch:{task:{handler(){this.aggregateMembers()},deep:!0}},unmounted(){}},Qo={class:"members-preview cmp-preview"},Zo={class:"cmp-header"},Ko=o("p",{class:"cmp-container-title"},"Members",-1),er=o("span",null,null,-1),tr=[er],sr=o("hr",{class:"thin-hr"},null,-1),or={class:"members-container"},rr={class:"input-container"},ir=o("h4",{class:"members-preview-title"},"Board members",-1),nr={class:"board-members-container"},ar=["onClick"],lr={class:"member-fullname"},dr={key:0,class:"member-check"},cr=o("div",null,null,-1);function ur(t,e,i,l,r,s){const u=g("user-avatar"),c=F("focus");return n(),a("section",Qo,[o("div",Zo,[Ko,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=(...h)=>s.closeCmp&&s.closeCmp(...h))},tr)]),sr,o("div",or,[o("div",rr,[x(o("input",{"onUpdate:modelValue":e[1]||(e[1]=h=>r.filterTxt=h),class:"members-filter",type:"text",placeholder:"Search Members"},null,512),[[c],[D,r.filterTxt]])]),ir,o("ul",nr,[(n(!0),a(f,null,k(s.getMembers,(h,d)=>(n(),a("li",{class:"board-member pointer",key:d,onClick:p=>s.toggleMemberInTask(h)},[I(u,{user:h},null,8,["user"]),o("div",lr,b(h.fullname)+b(`(${h.username})`),1),h.isCheck?(n(),a("div",dr)):m("",!0)],8,ar))),128)),cr])])])}var hr=T(Xo,[["render",ur]]);const mr={name:"cover-unsplash",components:{listSlot:V},props:{style:Object,title:String,attachments:Array},data(){return{currStyle:{bgClr:"",bgImg:"",isFullCover:!1,uploadedImg:""},photos:[],currTitle:"",searchingUnsplash:!1,searchResults:!1,search:"",photo_url:null,download_url:null,searchTerms:["Productivity","Perspective","Organization","Colorful","Nature","Business","Minimal","Space","Animals"],bgColors:[{id:"l101",color:"#61bd4f",isSelected:!1},{id:"l102",color:"#f2d600",isSelected:!1},{id:"l103",color:"#ff9f1a",isSelected:!1},{id:"l104",color:"#eb5a46",isSelected:!1},{id:"l105",color:"#c377e0",isSelected:!1},{id:"l106",color:"#0079bf",isSelected:!1},{id:"l107",color:"#00c2e0",isSelected:!1},{id:"l108",color:"#51e898",isSelected:!1},{id:"l109",color:"#ff78cb",isSelected:!1},{id:"l110",color:"#344563",isSelected:!1}]}},created(){this.currStyle=JSON.parse(JSON.stringify(this.style)),this.currTitle=this.title,this.searchPhoto(this.title)},methods:{searchPhoto(t){const e="Y2X6Y_wdMpqvaYX_4jgO-dOBqVAsQMQpihsIFNOAX5E";let i=20,l=t;l||(l=(this==null?void 0:this.search)||"business"),q.get(`https://api.unsplash.com/search/photos?page=1&per_page=${i}&query=${l}&client_id=${e}`).then(r=>{this.photos=r.data.results}).catch(r=>{console.log(r)})},searchPhotoWithButton(t){this.searchResults=!0,this.searchPhoto(t)},applyPhoto(t){var e;this.currStyle.uploadedImg=((e=t==null?void 0:t.urls)==null?void 0:e.small)||t,this.currStyle.bgClr="",this.currStyle.bgImg="",this.searchResults=!1,this.searchingUnsplash=!1,this.search="",this.$emit("addStyle",this.currStyle)},waitSearch:he.debounce(function(){this.searchPhoto(),this.searchResults=!0,this.search=""},1e3),selectBgClr(t){this.currStyle.bgClr=t,this.currStyle.bgImg="",this.currStyle.uploadedImg="",this.$emit("addStyle",this.currStyle)},removeCover(){this.currStyle.bgClr="",this.currStyle.bgImg="",this.currStyle.uploadedImg="",this.$emit("addStyle",this.currStyle)},closeCmp(){this.$emit("closeCmp")},setFullCover(t){this.currStyle.isFullCover=t,this.$emit("addStyle",this.currStyle)},async onAttachImg(t){const e=await this.$store.dispatch({type:"attachImg",ev:t});this.currStyle.uploadedImg=e.url,this.currStyle.bgClr="",this.currStyle.bgImg="",this.$emit("addStyle",this.currStyle)}},computed:{pageTitle(){return this.searchingUnsplash?"Photo search":"Cover"},currCoverImg(){var t,e;return((t=this.style)==null?void 0:t.bgImg)||((e=this.style)==null?void 0:e.uploadedImg)||""},currCoverBg(){var e;return{"background-color":((e=this.style)==null?void 0:e.bgClr)||""}},deletable(){if(this.style.bgImg||this.style.uploadedImg||this.style.bgClr)return!0}}},pr={class:"cmp-preview cover-unsplash-preview"},gr={class:"cmp-header"},_r=o("span",null,null,-1),br=[_r],vr={class:"cmp-container-title"},fr=o("span",null,null,-1),kr=[fr],yr=o("hr",{class:"thin-hr"},null,-1),Cr={key:0,class:"main-cover-screen"},wr=o("p",{class:"labels-title"},"Size",-1),Tr={class:"cover-size-select"},Ir=["src"],Sr=o("div",{class:"over-full-cover-select"},null,-1),Br=o("div",{class:"dummy title"},null,-1),xr=o("div",{class:"dummy text"},null,-1),$r=["src"],Dr=o("div",{class:"over-full-cover-select"},null,-1),Ur=o("div",{class:"dummy title"},null,-1),Lr=o("div",{class:"dummy text"},null,-1),Ar=L("Color"),Or=["onClick"],Mr=L("Attachments"),Nr=["src","onClick"],Fr=o("div",{class:"unsplash-btn full-width-btn pointer"},"Upload a cover image",-1),Er=L("Photos from Unsplash"),Gr=["src","onClick"],Rr={key:1,class:"search-unsplash-screen"},Jr=L("Suggested searches"),jr=["onClick"],Pr=L("Top photos"),Vr=["src","onClick"],qr={key:2,class:"unsplash-results-screen"},Wr=["src","onClick"];function Hr(t,e,i,l,r,s){const u=g("list-slot");return n(),a("section",pr,[o("div",gr,[r.searchingUnsplash?(n(),a("a",{key:0,class:"back-to-cmp-btn",onClick:e[0]||(e[0]=c=>(r.searchingUnsplash=!1,r.searchResults=!1))},br)):m("",!0),o("p",vr,b(s.pageTitle),1),o("a",{class:"close-cmp-btn",onClick:e[1]||(e[1]=(...c)=>s.closeCmp&&s.closeCmp(...c))},kr)]),yr,r.searchingUnsplash?m("",!0):(n(),a("section",Cr,[wr,o("div",Tr,[o("button",{class:"coverSelect pointer",onClick:e[2]||(e[2]=c=>s.setFullCover(!1))},[s.currCoverImg?(n(),a("img",{key:0,class:"coverSelectImg top",src:s.currCoverImg,alt:""},null,8,Ir)):m("",!0),s.currCoverBg?(n(),a("div",{key:1,class:"coverSelectImg top",style:$(s.currCoverBg)},null,4)):m("",!0),Sr,Br,xr]),o("button",{class:"coverSelect pointer",onClick:e[3]||(e[3]=c=>s.setFullCover(!0))},[s.currCoverImg?(n(),a("img",{key:0,class:"coverSelectImg",src:s.currCoverImg,alt:""},null,8,$r)):m("",!0),s.currCoverBg?(n(),a("div",{key:1,class:"coverSelectImg",style:$(s.currCoverBg)},null,4)):m("",!0),Dr,Ur,Lr])]),s.deletable?(n(),a("div",{key:0,onClick:e[4]||(e[4]=(...c)=>s.removeCover&&s.removeCover(...c)),class:"unsplash-btn full-width-btn remove-cover pointer"},"Remove cover")):m("",!0),I(u,null,{title:w(()=>[Ar]),list:w(()=>[(n(!0),a(f,null,k(r.bgColors,c=>(n(),a("div",{key:c.id,class:"label-option flex pointer",style:$({backgroundColor:c.color}),onClick:h=>s.selectBgClr(c.color)},null,12,Or))),128))]),_:1}),o("section",null,[I(u,null,{title:w(()=>[Mr]),list:w(()=>{var c;return[(n(!0),a(f,null,k((c=i.attachments)==null?void 0:c.slice(0,6),(h,d)=>(n(),a("img",{key:d,class:"unsplash-result-small pointer",src:h,alt:"img",onClick:p=>s.applyPhoto(h)},null,8,Nr))),128))]}),_:1}),o("label",null,[o("input",{type:"file",onChange:e[5]||(e[5]=(...c)=>s.onAttachImg&&s.onAttachImg(...c)),hidden:""},null,32),Fr])]),I(u,null,{title:w(()=>[Er]),list:w(()=>[(n(!0),a(f,null,k(r.photos.slice(0,6),c=>(n(),a("img",{key:c.id,class:"unsplash-result-small pointer",src:c.urls.thumb,alt:"img",onClick:h=>s.applyPhoto(c)},null,8,Gr))),128))]),_:1}),o("button",{class:"unsplash-btn full-width-btn pointer",onClick:e[6]||(e[6]=c=>r.searchingUnsplash=!0)},"Search for photos")])),r.searchingUnsplash&&!r.searchResults?(n(),a("section",Rr,[x(o("input",{type:"text",placeholder:"Search Unsplash for photos",class:"unsplash-search","onUpdate:modelValue":e[7]||(e[7]=c=>r.search=c),onInput:e[8]||(e[8]=(...c)=>s.waitSearch&&s.waitSearch(...c))},null,544),[[D,r.search]]),I(u,null,{title:w(()=>[Jr]),list:w(()=>[(n(!0),a(f,null,k(r.searchTerms,(c,h)=>(n(),a("button",{class:"unsplash-btn pointer",key:h,onClick:d=>s.searchPhotoWithButton(c)},b(c),9,jr))),128))]),_:1}),I(u,null,{title:w(()=>[Pr]),list:w(()=>[(n(!0),a(f,null,k(r.photos.slice(0,12),c=>(n(),a("img",{key:c.id,class:"unsplash-result-small pointer",src:c.urls.thumb,alt:"img",onClick:h=>s.applyPhoto(c)},null,8,Vr))),128))]),_:1})])):m("",!0),r.searchResults?(n(),a("section",qr,[I(u,null,{list:w(()=>[(n(!0),a(f,null,k(r.photos,c=>(n(),a("img",{key:c.id,class:"unsplash-result-large pointer",src:c.urls.thumb,alt:"img",onClick:h=>s.applyPhoto(c)},null,8,Wr))),128))]),_:1})])):m("",!0)])}var Yr=T(mr,[["render",Hr]]);const zr={components:{},data(){return{title:"Checklist"}},created(){},methods:{closeCmp(){this.$emit("closeCmp")},addChecklist(){this.$emit("createChecklist",this.title)}},computed:{},unmounted(){}},Xr={class:"create-checklist-container"},Qr={class:"checklist-header flex"},Zr=o("span",{class:"cmp-header-title"},"Add checklist",-1),Kr=o("hr",{class:"thin-hr"},null,-1),ei={class:"create-checklist-form"},ti=o("label",{class:"form-title",for:"txt"},"Title",-1),si=o("button",{class:"create-form-done pointer"},"Add",-1);function oi(t,e,i,l,r,s){const u=F("focus");return n(),a("section",Xr,[o("div",Qr,[Zr,o("a",{onClick:e[0]||(e[0]=(...c)=>s.closeCmp&&s.closeCmp(...c)),class:"close-checklist pointer"})]),Kr,o("div",ei,[o("div",null,[ti,o("form",{onSubmit:e[2]||(e[2]=y(c=>s.addChecklist(r.title),["prevent"]))},[x(o("input",{class:"checklist-form","onUpdate:modelValue":e[1]||(e[1]=c=>r.title=c),type:"text",name:"txt",id:"txt"},null,512),[[D,r.title],[u]]),si],32)])])])}var ri=T(zr,[["render",oi]]);const ii={props:{task:Object},components:{},data(){return{isCreateTodo:!1,newTodo:[],isCheckbox:[],isUpdateTodo:!1,editingTodoId:"",addNewTodo:"",isDonePercentages:[],todoCount:[],isRemove:!1,checklistId:""}},created(){},mounted(){},methods:{createTodo(t){this.addNewTodo=t},addTodo(t){console.log(this.newTodo),!(!this.newTodo||!this.newTodo.length)&&(this.$emit("addTodo",this.newTodo,t),this.newTodo="")},removeChecklist(t){this.$emit("removeChecklist",t)},updateTodo(t,e,i){i.stopPropagation();const l=i.currentTarget.textContent;if(!l||!l.length){this.editingTodoId="",this.addNewTodo="";return}this.$emit("updateTodo",t,e,l),this.editingTodoId="",this.addNewTodo=""},removeTodo(t,e){this.$emit("removeTodo",t,e)},openUpdateBar(t){this.editingTodoId=t,this.addNewTodo=""},closeCreateTodo(){this.editingTodoId="",this.addNewTodo=""},checkboxValue(t,e,i){const l=e.id,r=i.target.checked;this.$emit("updateTodoDone",t,l,r)}},computed:{progressBar(){let t=[];return this.task.checklists.forEach(e=>{let i=0,l=e.todos.length;if(l===0){t.push(0);return}e.todos.forEach(s=>{s.isDone&&i++});const r=i/l*100;t.push(r.toFixed(0))}),this.isDonePercentages=t,t},todoDone(){return this.task.checklists.forEach(t=>{t.todos.filter(e=>{if(e.isDone)return"task-done"})})}},unmounted(){}},ni={key:0,class:"td-checklist-preview"},ai={class:"checklist-title-container"},li={class:"checklist-title"},di=["onClick"],ci={class:"progress-bar-percentage"},ui={class:"progress-bar-container flex"},hi={class:"checklist-pb-full"},mi={class:"checklist-todo-title"},pi=o("label",{class:"todo-content-edit pointer",for:"todo.id"},null,-1),gi=["onClick","checked"],_i=["onClick","onBlur","onUpdate:modelValue"],bi={key:0,class:"update-todo-btn-container"},vi={class:"update-todo-btn flex"},fi=o("a",{class:"update-todo-text btn"},"Save",-1),ki={class:"remove-todo-btn-wrapper"},yi=["onMousedown"],Ci={key:0,class:"add-todo-container"},wi=["onClick"],Ti={class:"todo-btn-container"},Ii=["onClick"],Si={class:"close-btn-wrapper"};function Bi(t,e,i,l,r,s){const u=F("focus");return i.task?(n(),a("section",ni,[(n(!0),a(f,null,k(i.task.checklists,(c,h)=>(n(),a("div",{key:h},[o("div",ai,[o("h3",li,b(c.title),1),o("a",{class:"delete-checklist btn",onClick:y(d=>s.removeChecklist(c.id),["stop"])},"Delete",8,di)]),o("span",ci,b(s.progressBar[h])+"%",1),o("div",ui,[o("div",hi,[o("div",{class:E(["checklist-progress-bar",{green:s.progressBar[h]==="100"}]),style:$({width:s.progressBar[h]+"%",opacity:s.progressBar[h]})},null,6)])]),(n(!0),a(f,null,k(c.todos,d=>(n(),a("div",{key:d.id},[o("div",mi,[pi,o("input",{onClick:y(p=>s.checkboxValue(c.id,d,p),["stop"]),class:"checkbox-input pointer",type:"checkbox",name:"todo.isDone",id:"todo.id",value:"todo.isDone",checked:d.isDone},null,8,gi),x(o("textarea",{onClick:y(p=>s.openUpdateBar(d.id),["stop"]),class:"todo-clickable-area",onBlur:p=>s.updateTodo(c.id,d.id,p),spellcheck:"false",cols:"100",rows:"20","onUpdate:modelValue":p=>d.title=p,ref_for:!0,ref:"textarea"},b(d.title),41,_i),[[D,d.title]]),r.editingTodoId===d.id?(n(),a("div",bi,[o("div",vi,[fi,o("span",{onClick:e[0]||(e[0]=(...p)=>s.closeCreateTodo&&s.closeCreateTodo(...p)),class:"close-update pointer"})]),o("div",ki,[o("span",{onMousedown:p=>s.removeTodo(c.id,d.id),class:"remove-todo-btn pointer"},null,40,yi)])])):m("",!0)])]))),128)),r.addNewTodo?m("",!0):(n(),a("div",Ci,[o("button",{class:"add-an-item btn",onClick:y(d=>s.createTodo(c.id),["stop"])},"Add an item",8,wi)])),r.addNewTodo===c.id?(n(),a("div",{key:1,class:"add-item-container",onBlur:e[3]||(e[3]=(...d)=>s.createTodo&&s.createTodo(...d))},[o("div",null,[x(o("textarea",{class:"add-item-input",placeholder:"Add an item",type:"text","onUpdate:modelValue":e[1]||(e[1]=d=>r.newTodo=d),cols:"30",rows:"10"},null,512),[[u],[D,r.newTodo]]),o("div",Ti,[o("button",{class:"add-todo btn",onClick:y(d=>s.addTodo(c.id),["stop"])},"Add",8,Ii),o("div",Si,[o("a",{onClick:e[2]||(e[2]=y((...d)=>s.closeCreateTodo&&s.closeCreateTodo(...d),["stop"])),class:"close-add-todo-btn pointer"})])])])],32)):m("",!0)]))),128))])):m("",!0)}var xi=T(ii,[["render",Bi]]);const $i={props:{activity:Object},data(){return{guestUser:U.getGuestUser()}},created(){},computed:{activityTime(){return Be(new Date(this.activity.createdAt),new Date(Date.now()),{includeSeconds:!0,addSuffix:!0})}},components:{userAvatar:R}},Di={class:"activity-preview flex"},Ui={class:"activity-details flex"},Li={class:"activity-username-txt-container flex"},Ai={class:"activity-username"},Oi={class:"activity-txt"},Mi={class:"activity-time"};function Ni(t,e,i,l,r,s){var c;const u=g("user-avatar");return n(),a("section",Di,[I(u,{user:i.activity.byMember||r.guestUser},null,8,["user"]),o("div",Ui,[o("div",Li,[o("h3",Ai,b(((c=i.activity.byMember)==null?void 0:c.fullname)||r.guestUser.fullname),1),o("p",Oi,b(i.activity.txt),1)]),o("p",Mi,b(s.activityTime),1)])])}var ve=T($i,[["render",Ni]]);const Fi={name:"attached-img-preview",props:{attachment:String,idx:Number},methods:{deleteAttachment(){this.$emit("deleteAttachment",this.idx)},makeCover(){this.$emit("makeCover",this.attachment)}}},Ei={class:"attached-img-preview"},Gi=["src"],Ri={class:"attachment-options-container flex"},Ji=o("div",{class:"make-cover-icon"},null,-1);function ji(t,e,i,l,r,s){return n(),a("section",Ei,[o("img",{src:i.attachment,alt:""},null,8,Gi),o("div",Ri,[Ji,o("p",{class:"make-cover pointer",onClick:e[0]||(e[0]=(...u)=>s.makeCover&&s.makeCover(...u))},"Make Cover"),o("p",{class:"pointer",onClick:e[1]||(e[1]=(...u)=>s.deleteAttachment&&s.deleteAttachment(...u))},"Delete")])])}var Pi=T(Fi,[["render",ji]]),Vi="/assets/arrow-down.9f6ee7c2.svg",qi="/assets/loading-task.05eb7451.gif";const Wi={name:"task-details",emits:["updateBoard","addLabelToBoard","updateBoardLabels"],data(){return{task:null,imgUrls:[],currBoard:null,currGroup:null,addingDescription:!1,newDescription:"",detailsShown:!1,checklistTitle:"",handles:{isLabel:!1,isAttachOn:!1,isDatesOn:!1,isMembers:!1,isCover:!1,isDelete:!1,isChecklist:!1}}},async created(){await this.loadTask(),M.on("someone updated",this.boardUpdated)},unmounted(){M.off("someone updated",this.boardUpdated)},methods:{async loadTask(){var r;const{boardId:t,groupId:e,taskId:i}=this.$route.params;this.currBoard=await this.$store.dispatch({type:"loadBoard",boardId:t}),this.currGroup=this.currBoard.groups.find(s=>s.id===e);const l=(r=this.currGroup.tasks)==null?void 0:r.find(s=>s.id===i);this.task=JSON.parse(JSON.stringify(l)),this.newDescription=this.task.description,this.imgUrls=this.task.attachments},boardUpdated(){this.loadTask()},moveToBoard(){const t=this.$store.getters.getCurrBoard;this.$router.push(`/board/${t._id}`)},async addStyle(t){this.task.style=t,await this.saveTask("Updated style"),this.loadTask()},openCmp(t){for(let e in this.handles)this.handles[e]=!1;this.handles[t]=!0},closeCmp(){for(let t in this.handles)this.handles[t]=!1},async saveTaskTitle(t){const e=t.currentTarget.textContent;!e||e===this.task.title||(this.task.title=e,await this.saveTask("Updated task title"),this.loadTask())},async saveDate(t){this.task.dueDate=t,await this.saveTask("Updated due date"),this.closeCmp(),this.loadTask()},async saveTask(t){const e={id:O.makeId(),txt:t,groupId:this.currGroup.id,createdAt:Date.now(),byMember:this.$store.getters.loggedinUser||this.$store.getters.getGuestUser,task:{id:this.task.id,title:this.task.title}},i=await this.$store.dispatch({type:"saveTask",boardId:this.currBoard._id,groupId:this.currGroup.id,task:this.task,activity:e});this.$emit("updateBoard",i)},addDescription(){this.task.description="",this.addingDescription=!0},clearForm(){this.addingDescription=!1,this.newDescription=""},async saveDescription(){this.task.description=this.newDescription,await this.saveTask("Updated Description"),this.loadTask()},async addLabelToTask(t){this.task.labelIds||(this.task.labelIds=[]),this.task.labelIds.includes(t)?this.task.labelIds=this.task.labelIds.filter(e=>e!==t):this.task.labelIds.push(t),await this.saveTask("Changed Labels"),this.loadTask()},async updateBoardLabels(t){const e=await this.$store.dispatch({type:"editBoard",boardId:this.currBoard._id,changeType:"update labels",val:t});await this.$emit("updateBoard",e)},async toggleMemberInTask(t){this.task.members||(this.task.members=[]);const e=this.task.members.findIndex(i=>i._id===t._id);e===-1?(this.task.members.push(t),this.task.members.isCheck=!0):(this.task.members.splice(e,1),this.task.members.isCheck=!1),await this.saveTask("Added member"),this.loadTask()},async toggleDueDateDone(){this.task.dueDate.isCompleted=!this.task.dueDate.isCompleted,await this.saveTask("updated due date status"),this.loadTask()},async attachImg(t){const e=await this.$store.dispatch({type:"attachImg",ev:t});this.task.attachments||(this.task.attachments=[]),this.task.attachments.push(e.url),this.task.style.uploadedImg="",this.task.style.bgClr="",this.task.style.bgImg=e.url,await this.saveTask("Added image"),this.loadTask()},async deleteAttachment(t){this.task.attachments.splice(t,1),await this.saveTask("Deleted attachment"),this.loadTask()},async makeCover(t){this.task.style.bgImg=t,this.task.style.bgClr="",this.task.style.uploadedImg="",await this.saveTask("Updated cover photo"),this.loadTask()},async removeTask(t){const e={id:O.makeId(),txt:t,groupId:this.currGroup.id,createdAt:Date.now(),byMember:this.$store.getters.loggedinUser||this.$store.getters.getGuestUser,task:{id:this.task.id,title:this.task.title}},i=await this.$store.dispatch({type:"removeTask",boardId:this.currBoard._id,groupId:this.currGroup.id,task:this.task,activity:e});this.$emit("updateBoard",i),this.moveToBoard()},setActivities(){this.taskActivities=this.currBoard.activities.filter(t=>{var e;return((e=t.task)==null?void 0:e.id)===this.task.id})},async createChecklist(t){this.task.checklists||(this.task.checklists=[]);const e={id:O.makeId(),title:t,todos:[]};this.task.checklists.push(e),await this.saveTask("Added checklist"),this.loadTask(),this.closeCmp()},async addTodo(t,e){if(!t)return;this.task.checklists.find(l=>l.id===e).todos.push({id:O.makeId(),title:t,isDone:!1}),await this.saveTask("Added todo"),this.loadTask()},async removeChecklist(t){const e=this.task.checklists.findIndex(i=>i.id===t);this.task.checklists.splice(e,1),await this.saveTask("Removed checklist"),this.loadTask()},async updateTodo(t,e,i){const l=this.task.checklists.find(u=>u.id===t),r=l.todos.find(u=>u.id===e);if(!r)return;r.title=i;const s=l.todos.findIndex(u=>u.id===e);l.todos.splice(s,1,r),await this.saveTask("Updated todo"),this.loadTask()},async updateTodoDone(t,e,i){const l=this.task.checklists.find(u=>u.id===t),r=l.todos.find(u=>u.id===e);r.isDone=i;const s=l.todos.findIndex(u=>u.id===e);l.todos.splice(s,1,r),await this.saveTask("Updated todo"),this.loadTask()},async removeTodo(t,e){const i=this.task.checklists.find(r=>r.id===t),l=i.todos.findIndex(r=>r.id===e);console.log(l),i.todos.splice(l,1),await this.saveTask("removeTodo"),this.loadTask()}},computed:{areDetailsShown(){return this.detailsShown?"Hide Details":"Show Details"},labelsToDisplay(){return this.currBoard.labels.filter(e=>{var i;if((i=this.task.labelIds)!=null&&i.includes(e.id))return e})},formattedDate(){var t=new Date(this.task.dueDate.dueDate);return t.toString().slice(4,21)},dueDateCheckBox(){return this.task.dueDate.isCompleted},overdue(){if(new Date(this.task.dueDate.dueDate).getTime()<Date.now())return!0},coverStyle(){return this.task.style.uploadedImg?{"background-image":`url(${this.task.style.uploadedImg})`,height:"160px","background-color":"#ccd6e0","border-radius":"3px 3px 0 0"}:this.task.style.bgImg?{"background-image":`url(${this.task.style.bgImg})`,height:"160px","background-color":"#ccd6e0","border-radius":"3px 3px 0 0"}:this.task.style.bgClr?{"background-color":this.task.style.bgClr,height:"100px","border-radius":"3px 3px 0 0"}:{display:"none"}},taskActivities(){return this.currBoard.activities.filter(t=>{var e;return((e=t.task)==null?void 0:e.id)===this.task.id})}},components:{userAvatar:R,attachmentPreview:ro,datePreview:ho,labelPreview:zo,membersPreview:hr,coverUnsplash:Yr,deleteCmp:Y,createChecklist:ri,checklistActive:xi,activityPreview:ve,attachedImgPreview:Pi}},Hi={key:1,class:"task-details-main-content"},Yi={class:"task-details-container"},zi={class:"task-title-container"},Xi={class:"task-group-title"},Qi=L(" in list "),Zi={class:"show-member-label flex"},Ki={key:0,class:"edit-members-container"},en=o("p",{class:"members-header"},"Members",-1),tn={class:"members-container flex"},sn={key:1,class:"edit-labels-container"},on=o("p",{class:"labels-header"},"Labels",-1),rn={class:"labels-container flex"},nn={key:2,class:"due-date-container"},an=o("p",{class:"due-date-title"},"Due date",-1),ln={class:"displayed-date-checkbox"},dn=["src"],cn={key:0,class:"completed-overdue-label l101-label"},un={key:1,class:"completed-overdue-label l104-label"},hn=o("img",{src:Vi,alt:""},null,-1),mn={class:"edit-description-container"},pn={key:0,class:"description-container"},gn={class:"description-header-container flex"},_n=o("p",{class:"description-header"},"Description",-1),bn={class:"task-description"},vn={key:1,class:"add-edit-description-container"},fn=o("p",{class:"description-header"},"Description",-1),kn={key:1,class:"add-description-container"},yn={class:"add-description-buttons-container flex"},Cn={key:0,class:"img-container"},wn=o("p",{class:"img-container-header"},"Attachments",-1),Tn={class:"activities"},In={class:"activity-details-header"},Sn=o("p",{class:"activity-header"},"Activity",-1),Bn={key:0,class:"activities-list"},xn=o("p",{class:"add-task-buttons-title"},"Add to card",-1),$n={class:"just-buttons-container"},Dn=o("h3",{class:"td-actions"},"Actions",-1),Un=o("span",{class:"td-delete-icon"},null,-1),Ln=o("span",null,"Delete",-1),An=[Un,Ln],On={key:2,class:"loading-task-details",src:qi,alt:""};function Mn(t,e,i,l,r,s){var Q,Z,K,ee,te,se,oe,re,ie;const u=g("user-avatar"),c=g("attached-img-preview"),h=g("checklist-active"),d=g("activity-preview"),p=g("members-preview"),S=g("label-preview"),v=g("create-checklist"),G=g("date-preview"),B=g("attachment-preview"),ke=g("cover-unsplash"),ye=g("delete-cmp"),Ce=F("focus");return n(),a("div",{class:"task-details-dark",onClick:e[23]||(e[23]=(..._)=>s.moveToBoard&&s.moveToBoard(..._))},[o("section",{onClick:e[22]||(e[22]=y(()=>{},["stop"])),class:"task-details-page"},[o("button",{class:"go-back-btn",onClick:e[0]||(e[0]=(..._)=>s.moveToBoard&&s.moveToBoard(..._))}),r.task?(n(),a("div",{key:0,style:$(s.coverStyle),class:"task-cover-img"},null,4)):m("",!0),r.task?(n(),a("div",Hi,[o("div",Yi,[o("h3",zi,[o("p",{class:"task-title",contenteditable:"true",onBlur:e[1]||(e[1]=(..._)=>s.saveTaskTitle&&s.saveTaskTitle(..._))},b(r.task.title),33)]),o("p",Xi,[Qi,o("span",null,b(r.currGroup.title),1)]),o("section",Zi,[(Q=r.task.members)!=null&&Q.length?(n(),a("div",Ki,[en,o("div",tn,[(n(!0),a(f,null,k(r.task.members,_=>(n(),C(u,{"v-if":r.task.members,key:_._id,user:_},null,8,["v-if","user"]))),128)),o("button",{class:"avatar-btn flex",onClick:e[2]||(e[2]=y(_=>s.openCmp("isMembers"),["stop"]))})])])):m("",!0),(Z=s.labelsToDisplay)!=null&&Z.length?(n(),a("div",sn,[on,o("div",rn,[(n(!0),a(f,null,k(s.labelsToDisplay,_=>(n(),a("div",{key:_.id,class:"label-show flex",onClick:e[3]||(e[3]=y(ne=>s.openCmp("isLabel"),["stop"])),style:$({backgroundColor:_.color})},b(_.title),5))),128)),o("button",{class:"label-show-btn flex",onClick:e[4]||(e[4]=y(_=>s.openCmp("isLabel"),["stop"]))})])])):m("",!0),r.task.dueDate?(n(),a("div",nn,[an,o("div",ln,[o("input",{type:"checkbox",onClick:e[5]||(e[5]=(..._)=>s.toggleDueDateDone&&s.toggleDueDateDone(..._)),class:"due-date-checkbox",src:s.dueDateCheckBox},null,8,dn),o("div",{class:"date-label-container flex",onClick:e[6]||(e[6]=y(_=>s.openCmp("isDatesOn"),["stop"]))},[o("span",null,b(s.formattedDate),1),r.task.dueDate.isCompleted?(n(),a("span",cn,"Completed")):m("",!0),s.overdue&&!r.task.dueDate.isCompleted?(n(),a("span",un,"Overdue")):m("",!0),hn])])])):m("",!0)]),o("section",mn,[r.task.description?(n(),a("div",pn,[o("div",gn,[_n,o("button",{onClick:e[7]||(e[7]=(..._)=>s.addDescription&&s.addDescription(..._)),class:"edit-description-btn btn"}," Edit ")]),o("p",bn,b(r.task.description),1)])):(n(),a("div",vn,[fn,r.addingDescription?(n(),a("div",kn,[x(o("textarea",{"onUpdate:modelValue":e[9]||(e[9]=_=>r.newDescription=_),class:"description-text-area",placeholder:"Add a more detailed description..."},null,512),[[Ce],[D,r.newDescription]]),o("div",yn,[o("button",{class:"save-description-btn btn",onClick:e[10]||(e[10]=(..._)=>s.saveDescription&&s.saveDescription(..._))}," Save "),o("button",{class:"delete-description-btn",onClick:e[11]||(e[11]=(..._)=>s.clearForm&&s.clearForm(..._))})])])):(n(),a("div",{key:0,class:"fake-text-area",onClick:e[8]||(e[8]=(..._)=>s.addDescription&&s.addDescription(..._))}," Add a more detailed description... "))]))]),((ee=(K=r.task)==null?void 0:K.attachments)==null?void 0:ee.length)&&((se=(te=r.task)==null?void 0:te.attachments)==null?void 0:se.length)>0?(n(),a("section",Cn,[wn,(n(!0),a(f,null,k(r.task.attachments,(_,ne)=>(n(),C(c,{key:ne,attachment:_,onMakeCover:s.makeCover,onDeleteAttachment:s.deleteAttachment},null,8,["attachment","onMakeCover","onDeleteAttachment"]))),128))])):m("",!0),(oe=r.task.checklists)!=null&&oe.length?(n(),C(h,{key:1,task:r.task,onAddTodo:s.addTodo,onRemoveChecklist:s.removeChecklist,onUpdateTodo:s.updateTodo,onUpdateTodoDone:s.updateTodoDone,onRemoveTodo:s.removeTodo},null,8,["task","onAddTodo","onRemoveChecklist","onUpdateTodo","onUpdateTodoDone","onRemoveTodo"])):m("",!0),o("section",Tn,[o("div",In,[Sn,(re=r.currBoard.activities)!=null&&re.length?(n(),a("button",{key:0,class:"details-shown-btn btn",onClick:e[12]||(e[12]=_=>r.detailsShown=!r.detailsShown)},b(s.areDetailsShown),1)):m("",!0)]),r.detailsShown?(n(),a("div",Bn,[(n(!0),a(f,null,k(s.taskActivities,_=>(n(),C(d,{key:_.id,activity:_},null,8,["activity"]))),128))])):m("",!0)])]),o("nav",{onClick:e[21]||(e[21]=y(()=>{},["stop"])),class:"add-task-buttons-container"},[xn,o("div",$n,[o("button",{onClick:e[13]||(e[13]=y(_=>s.openCmp("isMembers"),["stop"])),class:"members-btn btn",title:"Members"}," Members "),r.handles.isMembers?(n(),C(p,{key:0,boardMembers:r.currBoard.members,task:r.task,onCloseCmp:s.closeCmp,onToggleMemberInTask:s.toggleMemberInTask},null,8,["boardMembers","task","onCloseCmp","onToggleMemberInTask"])):m("",!0),o("button",{onClick:e[14]||(e[14]=y(_=>s.openCmp("isLabel"),["stop"])),class:"labels-btn btn",title:"Labels"}," Labels "),r.handles.isLabel?(n(),C(S,{key:1,boardLabels:r.currBoard.labels,taskLabelIds:r.task.labelIds,onCloseCmp:s.closeCmp,onAddLabelToTask:s.addLabelToTask,onRemoveLabelFromBoard:t.removeLabelFromBoard,onUpdateBoardLabels:s.updateBoardLabels},null,8,["boardLabels","taskLabelIds","onCloseCmp","onAddLabelToTask","onRemoveLabelFromBoard","onUpdateBoardLabels"])):m("",!0),o("button",{class:"checklist-btn btn",title:"Checklist",onClick:e[15]||(e[15]=y(_=>s.openCmp("isChecklist"),["stop"]))}," Checklist "),r.handles.isChecklist?(n(),C(v,{key:2,onCloseCmp:s.closeCmp,onCreateChecklist:s.createChecklist},null,8,["onCloseCmp","onCreateChecklist"])):m("",!0),o("button",{onClick:e[16]||(e[16]=y(_=>s.openCmp("isDatesOn"),["stop"])),class:"dates-btn btn",title:"Dates"}," Dates "),r.handles.isDatesOn?(n(),C(G,{key:3,dueDate:((ie=r.task.dueDate)==null?void 0:ie.dueDate)||Date.now(),onSaveDate:s.saveDate,onCloseCmp:s.closeCmp},null,8,["dueDate","onSaveDate","onCloseCmp"])):m("",!0),o("button",{onClick:e[17]||(e[17]=y(_=>s.openCmp("isAttachOn"),["stop"])),class:"attachment-img btn",title:"Attachment"}," Attachment "),r.handles.isAttachOn?(n(),C(B,{key:4,imgUrls:r.imgUrls,onAttachImg:s.attachImg,onCloseCmp:s.closeCmp},null,8,["imgUrls","onAttachImg","onCloseCmp"])):m("",!0),o("button",{onClick:e[18]||(e[18]=y(_=>s.openCmp("isCover"),["stop"])),class:"cover-btn btn font-cmp-btn",title:"Cover"}," Cover "),r.handles.isCover?(n(),C(ke,{key:5,style:$(r.task.style),title:r.task.title,attachments:r.task.attachments,onCloseCmp:s.closeCmp,onAddStyle:s.addStyle},null,8,["style","title","attachments","onCloseCmp","onAddStyle"])):m("",!0)]),Dn,o("a",{onClick:e[19]||(e[19]=y(_=>s.openCmp("isDelete"),["stop"])),class:"td-delete-btn btn pointer"},An),r.handles.isDelete?(n(),C(ye,{key:0,type:"task",onRemove:e[20]||(e[20]=_=>s.removeTask("removed task")),onCloseCmp:s.closeCmp},null,8,["onCloseCmp"])):m("",!0)])])):(n(),a("img",On))])])}var fe=T(Wi,[["render",Mn]]);const Nn={props:{task:Object,groupId:String,isLabelTitle:Boolean},data(){return{boardId:null}},components:{userAvatar:R,taskDetails:fe},methods:{toTaskDetails(t,e,i){this.$router.push(`/board/${t}/${e}/${i}`)},toggleLabelTitle(){this.$emit("toggleLabelTitle")}},created(){const{boardId:t}=this.$route.params;this.boardId=t},computed:{formattedDate(){var t=new Date(this.task.dueDate.dueDate);return t.toString().slice(4,10)},isTaskOverdue(){if(new Date(this.task.dueDate.dueDate).getTime()<Date.now())return this.task.dueDate.isCompleted?"l101-label":"l104-label"},isChecklistDone(){var i;let t=0,e=0;return(i=this.task.checklists)==null||i.forEach(l=>{t+=l.todos.length,l.todos.filter(r=>{r.isDone&&e++})}),t===e},labelsToDisplay(){return this.$store.getters.getCurrBoard.labels.filter(e=>{if(this.task.labelIds.includes(e.id))return e})},attachmentCount(){var t;return(t=this.task.attachments)==null?void 0:t.length},checkListsCount(){var i,l;var t=0;(i=this.task.checklists)==null||i.forEach(r=>t+=r.todos.length);var e=0;return(l=this.task.checklists)==null||l.forEach(r=>{e+=r.todos.filter(u=>u.isDone).length}),`${e}/${t}`},openLabel(){return{open:this.isLabelTitle}},taskImgUrl(){return this.task.style.uploadedImg?this.task.style.uploadedImg:this.task.style.bgImg?this.task.style.bgImg:void 0},fullCoverStyle(){var t;return this.task.style.uploadedImg?{backgroundImage:`url(${this.task.style.uploadedImg})`,height:"220px",backgroundColor:"#ccd6e0"}:this.task.style.bgImg?{backgroundImage:`url(${this.task.style.bgImg})`,height:"220px",backgroundColor:"#ccd6e0"}:{"background-color":((t=this.task.style)==null?void 0:t.bgClr)||"#FFFFFF",height:"54px"}},fullCoverTxt(){return this.task.style.uploadedImg||this.task.style.bgImg?"is-img":O.isDarkColor(this.task.style.bgClr)?"is-dark-bg":"is-light-bg"},coverStyle(){return this.task.style.bgClr?{"background-color":this.task.style.bgClr,height:"32px"}:{display:"none"}}}},Fn={key:1,class:"top-cover-selected"},En=["src"],Gn={class:"task-preview-icons"},Rn={class:"task-content"},Jn={class:"task-snapshot flex"},jn={key:0,class:"description-img-preview",title:"Card description"},Pn=o("span",{class:""},null,-1),Vn={key:2,class:"attachment-img-preview",title:"Attachment"},qn={class:"user-avatar-pos flex"};function Wn(t,e,i,l,r,s){var c,h,d,p,S;const u=g("user-avatar");return n(),a("div",{onClick:e[2]||(e[2]=v=>s.toTaskDetails(this.boardId,this.groupId,this.task.id)),class:"task-preview-container"},[this.task.style.isFullCover?(n(),a("div",{key:0,style:$(s.fullCoverStyle),class:"full-cover-selected"},[o("p",{class:E([s.fullCoverTxt,"full-cover-title"])},b(i.task.title),3)],4)):(n(),a("div",Fn,[o("div",{style:$(s.coverStyle),class:"task-preview-cover"},null,4),s.taskImgUrl&&!i.task.style.bgClr?(n(),a("img",{key:0,class:"top-cover-img",src:s.taskImgUrl,alt:"",draggable:"false"},null,8,En)):m("",!0),o("div",Gn,[(c=i.task.labelIds)!=null&&c.length?(n(),a("div",{key:0,class:"labels-container",onClick:e[1]||(e[1]=y((...v)=>t.showLabelTitle&&t.showLabelTitle(...v),["stop"]))},[(n(!0),a(f,null,k(s.labelsToDisplay,v=>(n(),a("div",{key:v.id,class:E(["task-preview-label",s.openLabel]),style:$({backgroundColor:v.color}),onClick:e[0]||(e[0]=y((...G)=>s.toggleLabelTitle&&s.toggleLabelTitle(...G),["stop"]))},[i.isLabelTitle?(n(),a("span",{key:0,class:E(s.openLabel)},b(v.title),3)):m("",!0)],6))),128))])):m("",!0),o("div",Rn,b(i.task.title),1),o("div",Jn,[(h=i.task.description)!=null&&h.length?(n(),a("div",jn)):m("",!0),(d=i.task.checklists)!=null&&d.length?(n(),a("div",{key:1,class:E(["checklists-img-preview",{"todo-done":s.isChecklistDone}]),title:"Checklist items"},[o("span",{class:E(["checklist-img-font flex",{white:s.isChecklistDone}])},null,2),Pn,L(" "+b(s.checkListsCount),1)],2)):m("",!0),(p=i.task.attachments)!=null&&p.length?(n(),a("div",Vn,b(s.attachmentCount),1)):m("",!0),(S=i.task.dueDate)!=null&&S.dueDate?(n(),a("div",{key:3,class:E(["date-img-preview",s.isTaskOverdue])},b(s.formattedDate),3)):m("",!0),o("div",qn,[(n(!0),a(f,null,k(i.task.members,v=>{var G;return n(),C(u,{class:"user-avatar","v-if":(G=i.task.members)==null?void 0:G.length,key:v._id,user:v},null,8,["v-if","user"])}),128))])])])]))])}var Hn=T(Nn,[["render",Wn]]);const Yn={props:{group:Object,isLabelTitle:Boolean},components:{taskPreview:Hn,deleteCmp:Y,Container:me,Draggable:pe},data(){return{isAdding:!1,newTaskTitle:"",isRemove:!1}},methods:{getPayload(t){return()=>t},onDrop(t){typeof t.removedIndex!="number"&&typeof t.addedIndex!="number"||this.$emit("dropped",{ev:t,groupToId:this.group.id})},async saveIfTxt(){await O.delay(100),this.newTaskTitle?this.addTask():this.clearForm()},clearForm(){this.isAdding=!1,this.newTaskTitle=""},async openAddTask(){this.isAdding=!0,await xe();var t=this.$refs.list,e=t.offsetTop;t.scrollTo(0,e+t.scrollHeight)},addTask(){if(this.newTaskTitle){const t=A.getEmptyTask();t.title=this.newTaskTitle,this.$emit("saveGroup",{groupId:this.group.id,type:"add task",newValue:t}),this.clearForm()}else{this.isAdding=!1;return}},saveTitle(t){const e=t.currentTarget.textContent;e!==this.group.title&&this.$emit("saveGroup",{groupId:this.group.id,type:"save group title",newValue:e})},toggleLabelTitle(){this.$emit("toggleLabelTitle")},toggleRemove(){this.isRemove=!this.isRemove},removeGroup(){this.$emit("removeGroup",this.group.id)}},computed:{calcHeight(){return{add:this.isAdding}}}},zn={class:"groups-border"},Xn={class:"outside-group flex"},Qn={key:1,class:"add-task-container"},Zn={class:"add-task-buttons-container flex"},Kn={class:"bottom-outside-group"};function ea(t,e,i,l,r,s){var S;const u=g("delete-cmp"),c=g("task-preview"),h=g("Draggable"),d=g("Container"),p=F("focus");return n(),a("section",zn,[o("div",Xn,[o("p",{class:"group-title pointer",contenteditable:"true",onBlur:e[0]||(e[0]=(...v)=>s.saveTitle&&s.saveTitle(...v))},b(i.group.title),33),o("span",{class:"remove-group-btn",onClick:e[1]||(e[1]=(...v)=>s.toggleRemove&&s.toggleRemove(...v))})]),r.isRemove?(n(),C(u,{key:0,type:"list",onRemove:s.removeGroup,onCloseCmp:s.toggleRemove},null,8,["onRemove","onCloseCmp"])):m("",!0),o("div",{class:E(["group-container",s.calcHeight]),ref:"list"},[(S=i.group.tasks)!=null&&S.length?(n(),C(d,{key:0,class:"tasks-container","group-name":"group",orientation:"vertical","get-child-payload":s.getPayload(i.group.id),onDrop:s.onDrop},{default:w(()=>[(n(!0),a(f,null,k(i.group.tasks,v=>(n(),C(h,{class:"draggable-container middle-group-list",key:v.id},{default:w(()=>[I(c,{task:v,groupId:i.group.id,isLabelTitle:i.isLabelTitle,onToggleLabelTitle:s.toggleLabelTitle},null,8,["task","groupId","isLabelTitle","onToggleLabelTitle"])]),_:2},1024))),128))]),_:1},8,["get-child-payload","onDrop"])):m("",!0),r.isAdding?(n(),a("div",Qn,[x(o("textarea",{onBlur:e[2]||(e[2]=y((...v)=>s.saveIfTxt&&s.saveIfTxt(...v),["stop"])),"onUpdate:modelValue":e[3]||(e[3]=v=>r.newTaskTitle=v),placeholder:"Enter a title for this card..."},null,544),[[p],[D,r.newTaskTitle]]),o("div",Zn,[o("button",{class:"adding-task-btn btn",ref:"bottom",onClick:e[4]||(e[4]=(...v)=>s.addTask&&s.addTask(...v))},"Add card",512),o("button",{class:"delete-task-btn",onClick:e[5]||(e[5]=(...v)=>s.clearForm&&s.clearForm(...v))})])])):m("",!0)],2),o("div",Kn,[r.isAdding?m("",!0):(n(),a("div",{key:0,class:"add-task-btn",onClick:e[6]||(e[6]=(...v)=>s.openAddTask&&s.openAddTask(...v))},"Add a card"))])])}var ta=T(Yn,[["render",ea]]);const sa={props:{board:Object},data(){return{filterBy:{txt:""}}},methods:{setFilter(){this.$emit("setFilter",this.filterBy)}},computed:{checkBox(){return"../../src/assets/svgs/empty-checkbox.svg"}},components:{userAvatar:R}},oa={class:"board-filter"},ra={class:"cmp-header"},ia=o("p",{class:"cmp-container-title"},"Filter",-1),na=o("span",null,null,-1),aa=[na],la=o("hr",{class:"thin-hr"},null,-1),da={class:"filter-search-container"},ca=o("p",{class:"filter-section-title"},"Keyword",-1),ua=o("p",{class:"search-description"},"Search cards, members, labels, and more.",-1),ha={class:"filter-member-container"},ma=o("p",{class:"filter-section-title"},"Members",-1),pa={class:"filter-no-member flex"},ga=["src"],_a=o("div",{class:"filter-no-user-avatar flex"},null,-1),ba=o("p",{class:"filter-user-name"},"No members",-1),va=o("input",{type:"checkbox",value:"no",hidden:""},null,-1),fa={class:"filter-members-list"},ka=["src"],ya={class:"filter-user-name"},Ca=["value"];function wa(t,e,i,l,r,s){const u=g("user-avatar"),c=F("focus"),h=F("modal");return n(),a("section",oa,[o("div",ra,[ia,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=d=>t.$emit("closeCmp"))},aa)]),la,o("label",da,[ca,x(o("input",{type:"text",class:"search-input",placeholder:"Enter a keyword...",onInput:e[1]||(e[1]=(...d)=>s.setFilter&&s.setFilter(...d))},null,544),[[c],[h,r.filterBy.txt]]),ua]),o("div",ha,[ma,o("label",pa,[o("img",{class:"checkbox-icon",src:s.checkBox},null,8,ga),_a,ba,va]),o("div",fa,[(n(!0),a(f,null,k(i.board.members,d=>(n(),a("label",{key:d._id,class:"filter-member flex"},[o("img",{class:"checkbox-icon",src:s.checkBox},null,8,ka),I(u,{user:d},null,8,["user"]),o("p",ya,b(d.fullname),1),o("input",{type:"checkbox",value:d._id,hidden:""},null,8,Ca)]))),128))])])])}var Ta=T(sa,[["render",wa]]),Ia="/assets/photos.2b952301.jpg",Sa="/assets/colors.05334064.jpg";const Ba={props:{board:Object},data(){return{filterBy:"",handles:{isAbout:!1,isSearch:!1,isChangeBg:!1,isShowActivities:!1},bgOptions:{isChangClr:!1,isChangImg:!1},bgClr:"",bgImg:"",bgColors:[{id:"l101",color:"#61bd4f",isSelected:!1},{id:"l102",color:"#f2d600",isSelected:!1},{id:"l103",color:"#ff9f1a",isSelected:!1},{id:"l104",color:"#eb5a46",isSelected:!1},{id:"l105",color:"#c377e0",isSelected:!1},{id:"l106",color:"#0079bf",isSelected:!1},{id:"l107",color:"#00c2e0",isSelected:!1},{id:"l108",color:"#51e898",isSelected:!1},{id:"l109",color:"#ff78cb",isSelected:!1},{id:"l110",color:"#344563",isSelected:!1}],search:"",photos:[],isLoading:!1,attachments:[]}},methods:{searchPhoto(t){const e="Y2X6Y_wdMpqvaYX_4jgO-dOBqVAsQMQpihsIFNOAX5E";let i=20,l=t;l||(l=this.search),q.get(`https://api.unsplash.com/search/photos?page=1&per_page=${i}&query=${l}&client_id=${e}`).then(r=>{this.photos=r.data.results}).catch(r=>{console.log(r)})},waitSearch:he.debounce(function(){this.searchPhoto()},1e3),toggleMenuContent(t){if(this.bgOptions.isChangClr||this.bgOptions.isChangImg){this.toggleBgOption();return}for(let e in this.handles)this.handles[e]=!1;typeof t=="string"&&(this.handles[t]=!0)},toggleBgOption(t){for(const e in this.bgOptions)this.bgOptions[e]=!1;typeof t=="string"&&(this.bgOptions[t]=!0,t==="isChangImg"&&this.searchPhoto(this.board.title))},selectBg(t,e){this.$emit("editBoard",t,e)},async onAttachImg(t){this.isLoading=!0;const e=await this.$emit("attachImg",t);this.attachments.push(e),this.isLoading=!1}},computed:{activitiesToDisplay(){const t=this.board.activities.sort((e,i)=>e.createdAt>i.createdAt?-1:1);return this.handles.isShowActivities?t:t.slice(0,20)},cmpTitle(){return this.handles.isAbout?"About":this.handles.isSearch?"Search":this.bgOptions.isChangClr?"Colors":this.bgOptions.isChangImg?"Photos":this.handles.isChangeBg?"Change background":this.handles.isShowActivities?"Activity":"Menu"}},components:{activityPreview:ve,listSlot:V}},xa={class:"board-menu"},$a={class:"cmp-header"},Da=o("span",null,null,-1),Ua=[Da],La={class:"cmp-container-title"},Aa=o("span",null,null,-1),Oa=[Aa],Ma=o("hr",{class:"thin-hr"},null,-1),Na={class:"menu-content"},Fa={key:0,class:"menu-options flex"},Ea=o("span",{class:"trello-icon"},null,-1),Ga=o("div",null,[o("p",{class:"menu-option-about"},"About this board"),o("p",{class:"menu-option-about-description"},"Add description to your board")],-1),Ra=[Ea,Ga],Ja=o("img",{class:"board-bg-preview",src:_e},null,-1),ja=o("p",{class:"menu-option-bgc"},"Change background",-1),Pa=[Ja,ja],Va=o("hr",{class:"thin-hr"},null,-1),qa={key:1,class:"menu-activities-container"},Wa={class:"activities-list"},Ha={key:2,class:"change-bg-container"},Ya={key:0,class:"change-bg-choose"},za={class:"photos-colors-options flex"},Xa=o("img",{class:"photos-option",src:Ia},null,-1),Qa=o("p",{class:"photos-option-title"},"Photos",-1),Za=[Xa,Qa],Ka=o("img",{class:"colors-option",src:Sa},null,-1),el=o("p",{class:"color-option-title"},"Colors",-1),tl=[Ka,el],sl=o("hr",{class:"thin-hr"},null,-1),ol=o("p",{class:"custom-option-title"},"Custom",-1),rl={class:"customs-container flex"},il={class:"custom-input-label"},nl=o("div",{class:"custom-option"},[o("span")],-1),al={class:"options-list"},ll=["onClick"],dl={key:1,class:"change-bg-img-screen"},cl=["src","onClick"];function ul(t,e,i,l,r,s){const u=g("activity-preview"),c=g("list-slot"),h=F("focus");return n(),a("section",xa,[o("div",$a,[r.handles.isAbout||r.handles.isChangeBg||r.handles.isShowActivities?(n(),a("a",{key:0,class:"back-to-cmp-btn",onClick:e[0]||(e[0]=(...d)=>s.toggleMenuContent&&s.toggleMenuContent(...d))},Ua)):m("",!0),o("p",La,b(s.cmpTitle),1),o("a",{class:"close-cmp-btn",onClick:e[1]||(e[1]=d=>t.$emit("closeCmp"))},Oa)]),Ma,o("section",Na,[!r.handles.isAbout&&!r.handles.isChangeBg&&!r.handles.isShowActivities?(n(),a("div",Fa,[o("div",{class:"menu-option",onClick:e[2]||(e[2]=d=>s.toggleMenuContent("isAbout"))},Ra),o("div",{class:"menu-option",onClick:e[3]||(e[3]=d=>s.toggleMenuContent("isChangeBg"))},Pa),Va])):m("",!0),!r.handles.isAbout&&!r.handles.isChangeBg?(n(),a("section",qa,[r.handles.isShowActivities?m("",!0):(n(),a("p",{key:0,class:"activity-header",onClick:e[4]||(e[4]=d=>s.toggleMenuContent("isShowActivities"))},"Activity")),o("div",Wa,[(n(!0),a(f,null,k(s.activitiesToDisplay,d=>(n(),C(u,{key:d.id,activity:d},null,8,["activity"]))),128))]),r.handles.isShowActivities?m("",!0):(n(),a("a",{key:1,class:"show-allActivities",onClick:e[5]||(e[5]=d=>s.toggleMenuContent("isShowActivities"))},"View all activity"))])):m("",!0),r.handles.isChangeBg?(n(),a("section",Ha,[!r.bgOptions.isChangClr&&!r.bgOptions.isChangImg?(n(),a("div",Ya,[o("div",za,[o("div",{class:"photos-option-container",onClick:e[6]||(e[6]=d=>s.toggleBgOption("isChangImg"))},Za),o("div",{class:"colors-option-container",onClick:e[7]||(e[7]=d=>s.toggleBgOption("isChangClr"))},tl)]),sl,ol,o("div",rl,[o("label",il,[o("input",{type:"file",onChange:e[8]||(e[8]=(...d)=>s.onAttachImg&&s.onAttachImg(...d)),hidden:""},null,32),nl])])])):m("",!0),o("div",al,[r.bgOptions.isChangClr?(n(),C(c,{key:0},{list:w(()=>[(n(!0),a(f,null,k(r.bgColors,d=>(n(),a("div",{key:d.id,class:"colors-option",style:$({backgroundColor:d.color}),onClick:p=>s.selectBg("bgClr",d.color)},null,12,ll))),128))]),_:1})):m("",!0),r.bgOptions.isChangImg?(n(),a("div",dl,[x(o("input",{type:"text",placeholder:"Search Unsplash for photos",class:"unsplash-search","onUpdate:modelValue":e[9]||(e[9]=d=>r.search=d),onInput:e[10]||(e[10]=(...d)=>s.waitSearch&&s.waitSearch(...d))},null,544),[[h],[D,r.search]]),I(c,null,{list:w(()=>[(n(!0),a(f,null,k(r.photos,(d,p)=>(n(),a("img",{key:p,class:"photos-option",src:d.urls.thumb,alt:"img",onClick:S=>s.selectBg("bgImg",d)},null,8,cl))),128))]),_:1})])):m("",!0)])])):m("",!0)])])}var hl=T(Ba,[["render",ul]]);const ml={name:"invite-user",props:{members:Array},components:{userAvatar:R},data(){return{users:null,selected:[]}},async created(){await this.$store.dispatch({type:"loadUsers"}),this.users=this.$store.getters.users},methods:{addMemberToBoard(){if(!this.selected.length)return;const t=this.users.filter(e=>{if(this.selected.includes(e._id))return e});this.$emit("addMemberToBoard","add members",t)}},computed:{}},pl={key:0,class:"invite-user"},gl={class:"invite-user-header"},_l=o("p",{class:"invite-user-title"},"Invite to board",-1),bl=o("span",null,null,-1),vl=[bl],fl=o("hr",{class:"thin-hr"},null,-1),kl={class:"invite-content"},yl={class:"select-container"},Cl={class:"members-container"},wl=o("h4",{class:"members-preview-title"},"Board members",-1),Tl={class:"board-members-container"},Il={class:"member-fullname"};function Sl(t,e,i,l,r,s){const u=g("el-option"),c=g("el-select"),h=g("user-avatar");return r.users?(n(),a("section",pl,[o("div",gl,[_l,o("a",{class:"close-cmp-btn",onClick:e[0]||(e[0]=d=>t.$emit("closeCmp"))},vl)]),fl,o("div",kl,[o("div",yl,[I(c,{modelValue:r.selected,"onUpdate:modelValue":e[1]||(e[1]=d=>r.selected=d),multiple:"",placeholder:"Select user",style:{width:"100%"}},{default:w(()=>[(n(!0),a(f,null,k(r.users,d=>(n(),C(u,{key:d._id,label:d.fullname,value:d._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o("button",{class:"add-members-btn",onClick:e[2]||(e[2]=(...d)=>s.addMemberToBoard&&s.addMemberToBoard(...d))}," Invite ")]),o("div",Cl,[wl,o("ul",Tl,[(n(!0),a(f,null,k(i.members,d=>(n(),a("li",{class:"board-member",key:d._id},[I(h,{user:d},null,8,["user"]),o("div",Il,b(d.fullname)+b(`(${d.username})`),1)]))),128))])])])])):m("",!0)}var Bl=T(ml,[["render",Sl]]),z="/assets/full-star.b170b7f3.png",X="/assets/empty-star.b48fd479.png";const xl={name:"board-details",data(){return{board:null,dndInfo:{},isLabelTitle:!1,isOpenFilter:!1,isOpenMenu:!1,isOpenInvite:!1}},components:{boardGroup:ta,userAvatar:R,Container:me,Draggable:pe,boardFilter:Ta,boardMenu:hl,inviteUser:Bl},async created(){this.unsubscribe=qs.on("show-msg",this.showMsg);const{boardId:t}=this.$route.params;this.topic=t,M.emit("board topic",this.topic),M.on("someone updated",this.boardUpdated)},unmounted(){M.off("someone updated",this.boardUpdated)},methods:{onDrop(t){const e=this.board.groups.splice(t.removedIndex,1)[0];this.board.groups.splice(t.addedIndex,0,e),this.saveBoard()},dropCard({ev:t,groupToId:e}){this.dndInfo.groupFromId=t.payload,t.payload!==e&&(this.dndInfo.groupToId=e),(t.removedIndex||typeof t.removedIndex=="number")&&(this.dndInfo.removedIndex=t.removedIndex),(t.addedIndex||typeof t.addedIndex=="number")&&(this.dndInfo.addedIndex=t.addedIndex),(this.dndInfo.addedIndex||typeof this.dndInfo.addedIndex=="number")&&(this.dndInfo.removedIndex||typeof this.dndInfo.removedIndex=="number")&&this.moveTask()},moveTask(){const t=this.board.groups.find(l=>l.id===this.dndInfo.groupFromId),e=this.dndInfo.groupToId?this.board.groups.find(l=>l.id===this.dndInfo.groupToId):t,i=t.tasks.splice(this.dndInfo.removedIndex,1)[0];e.tasks.splice(this.dndInfo.addedIndex,0,i),this.saveBoard(),this.dndInfo={}},async loadBoard(t){this.board=await this.$store.dispatch({type:"loadBoard",boardId:t})},async saveBoard(t){if(t){const e={id:O.makeId(),txt:t,createdAt:Date.now(),byMember:this.$store.getters.loggedinUser||this.$store.getters.getGuestUser};this.board.activities.push(e)}this.board=await this.$store.dispatch({type:"saveBoard",board:JSON.parse(JSON.stringify(this.board))})},async editBoard(t,e){console.log(t),console.log(e);try{this.board=await this.$store.dispatch({type:"editBoard",boardId:this.board._id,changeType:t,val:e})}catch{}},async attachImg(t){const{url:e}=await this.$store.dispatch({type:"attachImg",ev:t});return await this.editBoard("bgImg",e),e},async addGroup(){const t=A.getEmptyGroup();this.board.groups.push(t),this.saveBoard("Added a new group")},async saveGroup({groupId:t,type:e,newValue:i}){const l=JSON.parse(JSON.stringify(this.board.groups.find(s=>s.id===t)));switch(e){case"save group title":l.title=i;break;case"add task":l.tasks.push(i);break}const r={id:O.makeId(),txt:e,createdAt:Date.now(),byMember:this.$store.getters.loggedinUser||this.$store.getters.getGuestUser,group:{id:l.id,title:l.title}};this.board=await this.$store.dispatch({type:"saveGroup",boardId:this.board._id,group:l,activity:r})},async removeGroup(t){const e={id:O.makeId(),txt:"remove group",createdAt:Date.now(),byMember:this.$store.getters.loggedinUser||this.$store.getters.getGuestUser,group:{id:t}};this.board=await this.$store.dispatch({type:"removeGroup",boardId:this.board._id,groupId:t,activity:e})},toggleLabelTitle(){this.isLabelTitle=!this.isLabelTitle},toggleFilter(){this.isOpenFilter=!this.isOpenFilter},setFilter(t){this.$store.commit({type:"setFilter",filterBy:t})},boardUpdated(){this.loadBoard(this.board._id)},toggleMenu(){this.isOpenMenu=!this.isOpenMenu},moveToDashboard(t){this.$router.push(`/${t}/dashboard`)}},computed:{isStarred(){return this.board.isFavorite?"filled":"stroke"},background(){var i,l,r,s;const t=((r=(l=(i=this.board.style)==null?void 0:i.bgImg)==null?void 0:l.urls)==null?void 0:r.regular)||"",e=((s=this.board.style)==null?void 0:s.bgClr)||"";return{backgroundImage:`url(${t})`,backgroundColor:e}},updatedBoardFromStore(){return this.$store.getters.boards}},watch:{"$route.params.boardId":{immediate:!0,handler(){const{boardId:t}=this.$route.params;!t||this.loadBoard(t)}}},unmounted(){this.unsubscribe()}},$l={class:"board-header flex"},Dl={class:"board-title-container flex"},Ul=o("button",{class:"btn-board-details btn-board"},"Board",-1),Ll={key:0,class:"star",src:z,alt:""},Al={key:1,class:"star",src:X},Ol={class:"members-nav-bar flex"},Ml={class:"board-members-container flex"},Nl={class:"board-header-nav flex"},Fl={class:"groups-layout"},El={class:"groups-container flex"},Gl=o("span",null,null,-1),Rl=L(" Add another list "),Jl=[Gl,Rl];function jl(t,e,i,l,r,s){const u=g("router-view"),c=g("user-avatar"),h=g("invite-user"),d=g("board-filter"),p=g("board-menu"),S=g("board-group"),v=g("Draggable"),G=g("Container");return r.board?(n(),a("section",{key:0,class:"board-container",style:$(s.background)},[I(u,{onUpdateBoard:e[0]||(e[0]=B=>s.loadBoard(r.board._id))}),o("header",$l,[o("div",Dl,[Ul,o("div",{class:"board-title",contenteditable:"true",onBlur:e[1]||(e[1]=B=>s.editBoard("board title",B))},b(r.board.title),33),o("button",{class:"star-btn btn-board btn",onClick:e[2]||(e[2]=y(B=>s.editBoard("toggle favorite"),["stop"]))},[r.board.isFavorite?(n(),a("img",Ll)):(n(),a("img",Al))])]),o("div",Ol,[o("div",Ml,[(n(!0),a(f,null,k(r.board.members,B=>(n(),C(c,{"v-if":r.board.members,key:B._id,user:B},null,8,["v-if","user"]))),128))]),o("button",{class:"invite-btn btn-board btn",onClick:e[3]||(e[3]=B=>r.isOpenInvite=!r.isOpenInvite)}," Invite "),r.isOpenInvite?(n(),C(h,{key:0,members:r.board.members,onCloseCmp:e[4]||(e[4]=B=>r.isOpenInvite=!r.isOpenInvite),onAddMemberToBoard:s.editBoard},null,8,["members","onAddMemberToBoard"])):m("",!0)]),o("nav",Nl,[o("button",{class:"filter-btn btn-board btn",onClick:e[5]||(e[5]=(...B)=>s.toggleFilter&&s.toggleFilter(...B))}," Filter "),r.isOpenFilter?(n(),C(d,{key:0,board:r.board,onCloseCmp:s.toggleFilter,onSetFilter:s.setFilter},null,8,["board","onCloseCmp","onSetFilter"])):m("",!0),o("button",{class:"show-menu-btn btn-board btn",onClick:e[6]||(e[6]=(...B)=>s.toggleMenu&&s.toggleMenu(...B))}," Show menu "),r.isOpenMenu?(n(),C(p,{key:1,board:r.board,onCloseCmp:s.toggleMenu,onEditBoard:s.editBoard,onAttachImg:s.attachImg},null,8,["board","onCloseCmp","onEditBoard","onAttachImg"])):m("",!0)])]),o("div",Fl,[o("article",El,[I(G,{onDrop:s.onDrop,orientation:"horizontal"},{default:w(()=>[(n(!0),a(f,null,k(r.board.groups,B=>(n(),C(v,{class:"draggable-container flex",key:B.id},{default:w(()=>[I(S,{group:B,isLabelTitle:r.isLabelTitle,onDropped:s.dropCard,onSaveGroup:s.saveGroup,onToggleLabelTitle:s.toggleLabelTitle,onRemoveGroup:s.removeGroup},null,8,["group","isLabelTitle","onDropped","onSaveGroup","onToggleLabelTitle","onRemoveGroup"])]),_:2},1024))),128))]),_:1},8,["onDrop"]),o("div",{class:"add-group",onClick:e[7]||(e[7]=(...B)=>s.addGroup&&s.addGroup(...B))},Jl)])])],4)):m("",!0)}var Pl=T(xl,[["render",jl]]);const Vl={name:"work-space",data(){return{isFavorite:!1,isCreateBoard:!1}},methods:{toBoardDetails(t){this.$router.push(`/board/${t}`)},async toggleFavorite(t){this.$store.dispatch({type:"editBoard",boardId:t,changeType:"toggle favorite"})},async removeBoard(t){this.$store.dispatch({type:"removeBoard",boardId:t})}},computed:{boards(){return this.$store.getters.boards},favoriteBoards(){return this.$store.getters.favoriteBoards},cardBackground(){var t;return this.board.style.bgImg?{backgroundImage:`url(${(t=board.style)==null?void 0:t.bgImg})`}:this.board.style.bgClr?{backgroundColor:`(${this.board.style.bgClr})`}:""}},components:{createBoard:be}},ql={class:"workspace-page-container"},Wl={class:"all-boards-container"},Hl=o("h1",null,"Favorite boards",-1),Yl={class:"favorite-boards flex"},zl=["onClick"],Xl={class:"favorite-board-title"},Ql=["onClick"],Zl={key:0,class:"ws-full-star",src:z},Kl={key:1,class:"ws-empty-star",src:X},ed=o("h3",{class:"all-boards-title"},"All boards",-1),td={class:"saved-boards"},sd=["onClick"],od={class:"title"},rd=["onClick"],id={key:0,class:"ws-full-star",src:z},nd={key:1,class:"ws-empty-star",src:X};function ad(t,e,i,l,r,s){const u=g("create-board");return n(),a("main",ql,[o("section",Wl,[o("section",null,[Hl,o("ul",Yl,[(n(!0),a(f,null,k(s.favoriteBoards,c=>{var h,d,p,S;return n(),a("li",{key:c._id,onClick:v=>s.toBoardDetails(c._id),class:"board-preview img-pos style-font",style:$({backgroundImage:`url(${((p=(d=(h=c.style)==null?void 0:h.bgImg)==null?void 0:d.urls)==null?void 0:p.thumb)||""})`,backgroundColor:((S=c.style)==null?void 0:S.bgClr)||""})},[o("h2",Xl,b(c.title),1),o("a",{class:"star-container",onClick:y(v=>s.toggleFavorite(c._id),["stop"])},[c.isFavorite?(n(),a("img",Zl)):(n(),a("img",Kl))],8,Ql)],12,zl)}),128))])]),ed,o("article",td,[(n(!0),a(f,null,k(s.boards,c=>{var h,d,p,S;return n(),a("div",{key:c._id,onClick:v=>s.toBoardDetails(c._id),class:"board-preview img-pos style-font",style:$({backgroundImage:`url(${((p=(d=(h=c.style)==null?void 0:h.bgImg)==null?void 0:d.urls)==null?void 0:p.thumb)||""})`,backgroundColor:((S=c.style)==null?void 0:S.bgClr)||""})},[o("h2",od,b(c.title),1),o("a",{class:"star-container",onClick:y(v=>s.toggleFavorite(c._id),["stop"])},[c.isFavorite?(n(),a("img",id)):(n(),a("img",nd))],8,rd)],12,sd)}),128)),o("button",{onClick:e[0]||(e[0]=c=>r.isCreateBoard=!0),class:"board-preview justify-center add-card"}," Create new board "),r.isCreateBoard?(n(),C(u,{key:0,onCloseCmp:e[1]||(e[1]=c=>r.isCreateBoard=!1)})):m("",!0)])])])}var ld=T(Vl,[["render",ad]]);const dd={name:"home",data(){return{loginCred:{username:"",password:""},signupCred:{fullname:"",username:"",password:""},isSignIn:!0,msg:""}},computed:{loggedinUser(){return this.$store.getters.loggedinUser},loginSignUpButton(){return this.isSignIn?"Sign up for an account":"Back"}},created(){this.loadUsers()},methods:{async doLogin(){if(!this.loginCred.username){this.msg="Please enter username/password";return}try{await this.$store.dispatch({type:"login",userCred:this.loginCred}),this.$router.push("/board")}catch{this.msg="Failed to login"}},doLogout(){this.$store.dispatch({type:"logout"})},async doSignup(){if(!this.signupCred.fullname||!this.signupCred.password||!this.signupCred.username){this.msg="Please fill out all of the form details";return}try{await this.$store.dispatch({type:"signup",userCred:this.signupCred}),this.$router.push("/board")}catch{this.msg="Failed to sign up new user"}},toggleLoginSignUp(){this.isSignIn=!this.isSignIn},async removeUser(t){try{await this.$store.dispatch({type:"removeUser",userId:t}),this.msg="User removed"}catch{this.msg="Failed to remove user"}},async guestLogin(){try{await this.$store.dispatch({type:"login",userCred:{username:"Guest",password:"123"}}),this.$router.push("/board")}catch(t){console.log(t),this.msg="Failed to do guest login"}},loadUsers(){this.$store.dispatch({type:"loadUsers"})}}},cd={class:"login-page"},ud=o("h1",{class:"login-logo-header"},[o("div",{class:"login-icon"},[o("span")]),L(" Mellow ")],-1),hd={class:"main-login-container"},md=o("p",{class:"login-welcome-msg"},"Log in to Mellow",-1),pd={key:1,class:"login-form-container"},gd=o("button",{class:"login-button"},"Log In",-1),_d=o("div",{class:"or-div"},"OR",-1),bd=o("button",{class:"login-button"},"Login",-1),vd=o("hr",{class:"thin-hr"},null,-1),fd={class:"signup-select-container"},kd=o("span",{class:"trello-dot"},null,-1);function yd(t,e,i,l,r,s){return n(),a("section",cd,[ud,o("div",hd,[md,s.loggedinUser?(n(),a("button",{key:0,class:"log-out-button",onClick:e[0]||(e[0]=(...u)=>s.doLogout&&s.doLogout(...u))}," Logout "+b(s.loggedinUser.username),1)):(n(),a("section",pd,[r.isSignIn?(n(),a("form",{key:0,class:"sign-in-form",onSubmit:e[4]||(e[4]=y((...u)=>s.doLogin&&s.doLogin(...u),["prevent"]))},[x(o("input",{class:"login-form-input",type:"text","onUpdate:modelValue":e[1]||(e[1]=u=>r.loginCred.username=u),placeholder:"Enter username"},null,512),[[D,r.loginCred.username]]),x(o("input",{class:"login-form-input",type:"password","onUpdate:modelValue":e[2]||(e[2]=u=>r.loginCred.password=u),placeholder:"Enter password"},null,512),[[D,r.loginCred.password]]),gd,_d,o("button",{class:"login-button guest",onClick:e[3]||(e[3]=(...u)=>s.guestLogin&&s.guestLogin(...u))}," Login as Guest ")],32)):m("",!0),r.isSignIn?m("",!0):(n(),a("form",{key:1,class:"sign-up-form",onSubmit:e[8]||(e[8]=y((...u)=>s.doSignup&&s.doSignup(...u),["prevent"]))},[x(o("input",{class:"login-form-input",type:"text","onUpdate:modelValue":e[5]||(e[5]=u=>r.signupCred.fullname=u),placeholder:"Enter your full name"},null,512),[[D,r.signupCred.fullname]]),x(o("input",{class:"login-form-input",type:"text","onUpdate:modelValue":e[6]||(e[6]=u=>r.signupCred.username=u),placeholder:"Enter username"},null,512),[[D,r.signupCred.username]]),x(o("input",{class:"login-form-input",type:"password","onUpdate:modelValue":e[7]||(e[7]=u=>r.signupCred.password=u),placeholder:"Enter password"},null,512),[[D,r.signupCred.password]]),bd],32)),vd,o("div",fd,[o("a",{class:"sign-up-toggle",onClick:e[9]||(e[9]=(...u)=>s.toggleLoginSignUp&&s.toggleLoginSignUp(...u))}," Can't log in?"),kd,o("a",{class:"sign-up-toggle",onClick:e[10]||(e[10]=(...u)=>s.toggleLoginSignUp&&s.toggleLoginSignUp(...u))},b(s.loginSignUpButton),1)])]))])])}var Cd=T(dd,[["render",yd]]);const wd=$e({history:De("/"),routes:[{path:"/",name:"home",component:Cs},{path:"/login",name:"login",component:Cd},{path:"/board",name:"work-space",component:ld},{path:"/board/:boardId",name:"board-details",component:Pl,children:[{path:":groupId/:taskId",name:"task-details",component:fe}]},{path:"/about",name:"about",component:xs}]});var Td={state:{boards:[],currBoard:null,filterBy:null},getters:{boards({boards:t}){return JSON.parse(JSON.stringify(t))},favoriteBoards({boards:t}){return t.filter(e=>e.isFavorite)},getCurrBoard({currBoard:t}){return JSON.parse(JSON.stringify(t))}},mutations:{setFilter(t,{filterBy:e}){t.filterBy=e},setBoards(t,{boards:e}){t.boards=e},addBoard(t,{board:e}){t.boards.push(e)},removeBoard(t,{boardId:e}){t.boards=t.boards.filter(i=>i._id!==e)},setCurrBoard(t,{board:e}){t.currBoard=JSON.parse(JSON.stringify(e))},setFavorite(t,{updatedBoard:e}){const i=t.boards.findIndex(l=>l._id===e._id);t.boards.splice(i,1,e)},saveBoard(t,{savedBoard:e}){const i=t.boards.findIndex(l=>l._id===e._id);t.boards.splice(i,1,e)},saveGroup(t,{boardId:e,group:i}){const l=t.boards.find(s=>s._id===e),r=l.groups.findIndex(s=>s.id===i.id);if(r===-1)return l.groups.push(i);l.groups.splice(r,1,i),t.currBoard=l},saveTask(t,{boardId:e,groupId:i,task:l}){const r=t.boards.find(c=>c._id===e),s=r.groups.find(c=>c.id===i),u=s.tasks.findIndex(c=>c.id===l.id);if(u===-1)return s.tasks.push(l);s.tasks.splice(u,1,l),t.currBoard=r},removeTask(t,{board:e,group:i,taskIdx:l}){i.tasks.splice(l,1),t.currBoard=e},removeGroup(t,{board:e,groupIdx:i}){e.groups.splice(i,1),t.currBoard=e}},actions:{async loadBoards({commit:t}){try{const e=await A.query();t({type:"setBoards",boards:e})}catch(e){console.log("board module loadBoards cant load boards now",e)}},async loadBoard({commit:t},{boardId:e}){try{const i=await A.getById(e);return t({type:"setCurrBoard",board:i}),JSON.parse(JSON.stringify(i))}catch(i){console.log("board module loadBoard cant load board now",i)}},async addBoard({commit:t},{title:e,bgClr:i,bgImg:l}){try{const r=A.getEmptyBoard();r.title=e,r.style.bgClr=i,r.style.bgImg=l;const s=await A.save(r);return t({type:"addBoard",board:s}),s._id}catch(r){console.log("board module addBoard cant load boards now",r)}},async removeBoard({commit:t},{boardId:e}){try{await A.remove(e),t({type:"removeBoard",boardId:e})}catch(i){console.log("board module removeBoard cant load boards now",i)}},async removeTask({commit:t,state:e},{boardId:i,groupId:l,task:r,activity:s}){try{const u=e.boards.find(S=>S._id===i),c=u.groups.find(S=>S.id===l),h=c.tasks.findIndex(S=>S.id===r.id);await t({type:"removeTask",board:u,group:c,taskIdx:h});const d=JSON.parse(JSON.stringify(e.currBoard)),p=await A.save(d,s);return t({type:"saveBoard",savedBoard:p}),JSON.parse(JSON.stringify(p))}catch(u){console.log("board module removeTask cant remove task now",u)}},async removeGroup({commit:t,state:e},{boardId:i,groupId:l,activity:r}){try{const s=e.boards.find(d=>d._id===i),u=s.groups.findIndex(d=>d.id===l);await t({type:"removeGroup",board:s,groupIdx:u});const c=JSON.parse(JSON.stringify(e.currBoard)),h=await A.save(c,r);return t({type:"saveBoard",savedBoard:h}),JSON.parse(JSON.stringify(h))}catch(s){console.log("board module removeGroup cant remove group now",s)}},async editBoard({state:t,dispatch:e},{boardId:i,changeType:l,val:r}){try{const s=JSON.parse(JSON.stringify(t.boards.find(h=>h._id===i)));let u;switch(l){case"bgClr":s.style[l]=r,s.style.bgImg="",u="background";break;case"bgImg":s.style[l]=r,s.style.bgClr="",u="background";break;case"board title":s.title=r.currentTarget.textContent,u="title";break;case"toggle favorite":s.isFavorite=!s.isFavorite,u="toggle favorite";break;case"add members":let h=s.members.map(d=>d._id);r.forEach(d=>{h!=null&&h.includes(d._id)||s.members.push(JSON.parse(JSON.stringify(d)))}),u="members";break;case"update labels":if(typeof r=="string"){const d=s.labels.findIndex(p=>p.id===r);s.labels.splice(d,1)}else{const d=s.labels.findIndex(p=>p.id===r.id);d===-1?s.labels.push(r):s.labels.splice(d,1,r)}u="labels";break}const c={id:O.makeId(),txt:`Change board ${u}`,createdAt:Date.now(),byMember:t.loggedinUser||t.guestUser};return await e({type:"saveBoard",board:JSON.parse(JSON.stringify(s),c)})}catch(s){throw console.log("board module editBoard cant edit board now",s),s}},async saveBoard({commit:t},{board:e,activity:i}){try{const l=await A.save(e,i);return t({type:"saveBoard",savedBoard:l}),JSON.parse(JSON.stringify(l))}catch(l){throw console.log("board module saveBoard cant save board now",l),l}},async attachImg({commit:t},{ev:e}){try{return await A.uploadImg(e)}catch(i){console.log("board module attachImg cant attach img now",i)}},async saveTask({commit:t,state:e},{boardId:i,groupId:l,task:r,activity:s}){try{await t({type:"saveTask",boardId:i,groupId:l,task:r});const u=JSON.parse(JSON.stringify(e.currBoard)),c=await A.save(u,s);return t({type:"saveBoard",savedBoard:c}),JSON.parse(JSON.stringify(c))}catch(u){console.log("board module saveTask cant save task now",u)}},async saveGroup({commit:t,state:e},{boardId:i,group:l,activity:r}){try{await t({type:"saveGroup",boardId:i,group:l});const s=JSON.parse(JSON.stringify(e.currBoard)),u=await A.save(s,r);return t({type:"saveBoard",savedBoard:u}),JSON.parse(JSON.stringify(u))}catch(s){console.log("board module saveGroup cant save group now",s)}}}},Id={state:{loggedinUser:U.getLoggedinUser(),users:[],watchedUser:null,guestUser:U.getGuestUser()},getters:{users({users:t}){return JSON.parse(JSON.stringify(t))},loggedinUser({loggedinUser:t}){return t},watchedUser({watchedUser:t}){return t},getGuestUser({guestUser:t}){return t}},mutations:{setLoggedinUser(t,{user:e}){t.loggedinUser=e?de({},e):null,console.log("in mutation, ",t.loggedinUser)},setWatchedUser(t,{user:e}){t.watchedUser=e},setUsers(t,{users:e}){t.users=e},removeUser(t,{userId:e}){t.users=t.users.filter(i=>i._id!==e)},setGuestUser(t,{guestUser:e}){t.guestUser=e}},actions:{async login({commit:t},{userCred:e}){try{const i=await U.login(e);return t({type:"setLoggedinUser",user:i}),i}catch(i){throw console.log("userStore: Error in login",i),i}},async signup({commit:t},{userCred:e}){try{const i=await U.signup(e);return t({type:"setLoggedinUser",user:i}),i}catch(i){throw console.log("userStore: Error in signup",i),i}},async logout({commit:t}){try{await U.logout(),t({type:"setLoggedinUser",user:null})}catch(e){throw console.log("userStore: Error in logout",e),e}},async loadUsers({commit:t}){try{const e=await U.getUsers();t({type:"setUsers",users:e})}catch(e){throw console.log("userStore: Error in loadUsers",e),e}},async getUserById({commit:t},{userId:e}){try{const i=await U.getById(e);return console.log(i),JSON.parse(JSON.stringify(i))}catch(i){throw console.log("userStore: Error in getUserById",i),i}},async loadAndWatchUser({commit:t},{userId:e}){try{console.log("store");const i=await U.getById(e);t({type:"setWatchedUser",user:i}),M.off(ue),M.on(ue,l=>{t({type:"setWatchedUser",user:l})})}catch(i){throw console.log("userStore: Error in loadAndWatchUser",i),i}},async removeUser({commit:t},{userId:e}){try{await U.remove(e),t({type:"removeUser",userId:e})}catch(i){throw console.log("userStore: Error in removeUser",i),i}},async updateUser({commit:t},{user:e}){try{e=await U.update(e),t({type:"setUser",user:e})}catch(i){throw console.log("userStore: Error in updateUser",i),i}},loadGuestUser({commit:t}){const e=U.getGuestUser();t({type:"setGuestUser",guestUser:e})},async loadUsers({commit:t}){try{const e=await U.getUsers();t({type:"setUsers",users:e})}catch(e){throw console.log("userStore: Error in loadUsers",e),e}}}};const Sd=Ue({strict:!0,state:{},getters:{},mutations:{},actions:{},modules:{boardStore:Td,userStore:Id}}),Bd={mounted(t){t.focus()}};const J=Le(cs);J.directive("focus",Bd);J.use(Ae);J.use(Oe,{});J.use(Me,{accessKey:"Y2X6Y_wdMpqvaYX_4jgO-dOBqVAsQMQpihsIFNOAX5E",secret:"W5FeRrlFbgAz3i3d54dHnDm9okVhUeUIXZ6TyvZC_H4"});J.use(Ne);J.use(wd);J.use(Sd);J.mount("#app");
