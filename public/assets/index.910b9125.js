var z=Object.defineProperty;var I=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var F=(t,e,o)=>e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,P=(t,e)=>{for(var o in e||(e={}))J.call(e,o)&&F(t,o,e[o]);if(I)for(var o of I(e))K.call(e,o)&&F(t,o,e[o]);return t};import{_ as h,r as p,o as c,c as d,a as g,w,b as T,d as E,l as Y,t as y,e as S,f as U,g as r,h as m,v,i as x,F as C,j as O,k as A,m as j,C as H,n as Q,D as X,p as Z,q as ee,s as te,u as oe,x as se,y as re}from"./vendor.3d286dcb.js";const ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}};ne();const ie={},le={class:"app-header"},ae=T("Mr. Toy"),ue=T("Dashboard"),ce=T("App"),de=T("About");function pe(t,e,o,a,s,n){const l=p("router-link");return c(),d("section",le,[g(l,{to:"/"},{default:w(()=>[ae]),_:1}),g(l,{to:"/dashboard"},{default:w(()=>[ue]),_:1}),g(l,{to:"/toy"},{default:w(()=>[ce]),_:1}),g(l,{to:"/about"},{default:w(()=>[de]),_:1})])}var ye=h(ie,[["render",pe]]);const me={name:"app",created(){this.$store.dispatch({type:"loadToys"})},components:{appHeader:ye}};function ge(t,e,o,a,s,n){const l=p("app-header"),u=p("RouterView");return c(),d("section",null,[g(l),g(u)])}var he=h(me,[["render",ge]]);const _e="/api/";var ve=E.create({withCredentials:!0});const f={get(t,e){return V(t,"GET",e)},post(t,e){return V(t,"POST",e)},put(t,e){return V(t,"PUT",e)},delete(t,e){return V(t,"DELETE",e)}};async function V(t,e="GET",o=null){try{return(await ve({url:`${_e}${t}`,method:e,data:o,params:e==="GET"?o:null})).data}catch(a){throw console.log(`Had Issues ${e}ing to the backend, endpoint: ${t}, with data:`,o),console.dir(a),a.response&&a.response.status===401&&q.push("/"),a}}const fe="",b=we();b.setup();function we(){var t=null;return{async setup(){t=Y(fe)},on(o,a){t.on(o,a)},off(o,a=null){!t||(a?t.off(o,a):t.removeAllListeners(o))},emit(o,a){t.emit(o,a)},terminate(){t=null}}}const L="loggedinUser",_={login:Se,logout:Ue,signup:ke,getLoggedinUser:N,getUsers:Te,getById:be,remove:Ee,update:G,changeScore:Ce};window.userService=_;function Te(){return f.get("user")}async function be(t){return await f.get(`user/${t}`)}function Ee(t){return f.delete(`user/${t}`)}async function G(t){return t=await f.put(`user/${t._id}`,t),N()._id===t._id&&M(t),t}async function Se(t){const e=await f.post("auth/login",t);if(e)return M(e)}async function ke(t){const e=await f.post("auth/signup",t);return M(e)}async function Ue(){return sessionStorage.removeItem(L),await f.post("auth/logout")}async function Ce(t){const e=N();if(!e)throw new Error("Not loggedin");return e.score=e.score+t||t,await G(e),e.score}function M(t){return sessionStorage.setItem(L,JSON.stringify(t)),t}function N(){return JSON.parse(sessionStorage.getItem(L)||"null")}const $e={name:"home",data(){return{loginCred:{username:"",password:""},signupCred:{fullname:"",username:"",password:""}}},computed:{loggedinUser(){return this.$store.getters.loggedinUser}},created(){this.loadUsers()},methods:{async doLogin(){if(!this.loginCred.username){this.msg="Please enter username/password";return}try{await this.$store.dispatch({type:"login",userCred:this.loginCred}),this.$router.push("/")}catch(t){console.log(t),this.msg="Failed to login"}},doLogout(){this.$store.dispatch({type:"logout"})},async doSignup(){if(!this.signupCred.fullname||!this.signupCred.password||!this.signupCred.username){this.msg="Please fill up the form";return}await this.$store.dispatch({type:"signup",userCred:this.signupCred}),this.$router.push("/")},loadUsers(){this.$store.dispatch({type:"loadUsers"})},async removeUser(t){try{await this.$store.dispatch({type:"removeUser",userId:t}),this.msg="User removed"}catch{this.msg="Failed to remove user"}}}},xe=r("h1",null,"Home Page",-1),Be=r("br",null,null,-1),Oe=T("To Toy App"),Re={key:2},Ve=r("button",null,"Login",-1),De=r("button",null,"Login",-1),Ae=r("img",{src:"https://res.cloudinary.com/cajan22yoni/image/upload/v1647807495/toys_n8ec54.jpg",alt:""},null,-1);function Le(t,e,o,a,s,n){const l=p("router-link");return c(),d("section",null,[xe,n.loggedinUser?(c(),d("button",{key:0,onClick:e[0]||(e[0]=(...u)=>n.doLogout&&n.doLogout(...u))}," Logout "+y(n.loggedinUser.username),1)):S("",!0),Be,n.loggedinUser?(c(),U(l,{key:1,to:"/toy"},{default:w(()=>[Oe]),_:1})):(c(),d("section",Re,[r("form",{onSubmit:e[3]||(e[3]=x((...u)=>n.doLogin&&n.doLogin(...u),["prevent"]))},[m(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=u=>s.loginCred.username=u),placeholder:"Enter username"},null,512),[[v,s.loginCred.username]]),m(r("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=u=>s.loginCred.password=u),placeholder:"Enter password"},null,512),[[v,s.loginCred.password]]),Ve],32),r("form",{onSubmit:e[7]||(e[7]=x((...u)=>n.doSignup&&n.doSignup(...u),["prevent"]))},[m(r("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=u=>s.signupCred.fullname=u),placeholder:"Enter your full name"},null,512),[[v,s.signupCred.fullname]]),m(r("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=u=>s.signupCred.username=u),placeholder:"Enter username"},null,512),[[v,s.signupCred.username]]),m(r("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=u=>s.signupCred.password=u),placeholder:"Enter password"},null,512),[[v,s.signupCred.password]]),De],32)])),Ae])}var Me=h($e,[["render",Le]]);const Ne={name:"about",data(){return{center:{lat:32.088179,lng:34.790144},markers:[{position:{lat:32.088179,lng:34.790144}},{position:{lat:32.066278,lng:34.830301}},{position:{lat:32.093869,lng:34.882401}}]}}},Ie=r("h1",null,"About Page",-1),Fe=r("h3",null,"Our Locations:",-1),Pe=r("br",null,null,-1);function Ge(t,e,o,a,s,n){const l=p("GMapMarker"),u=p("GMapCluster"),i=p("GMapMap");return c(),d("section",null,[Ie,Fe,g(i,{center:s.center,zoom:12,"map-type-id":"terrain"},{default:w(()=>[g(u,null,{default:w(()=>[(c(!0),d(C,null,O(s.markers,($,W)=>(c(),U(l,{key:W,position:$.position,clickable:!0,draggable:!0,onClick:ho=>s.center=$.position},null,8,["position","onClick"]))),128))]),_:1})]),_:1},8,["center"]),Pe,r("button",{onClick:e[0]||(e[0]=$=>s.center=s.markers[0].position)},"Tel Aviv"),r("button",{onClick:e[1]||(e[1]=$=>s.center=s.markers[1].position)},"Ramat Gan"),r("button",{onClick:e[2]||(e[2]=$=>s.center=s.markers[2].position)},"Petach Tikva")])}var qe=h(Ne,[["render",Ge]]);const We={name:"toy-preview",props:{toy:Object},computed:{isInStock(){return this.toy.inStock?"Item is in stock":"Out of Stock"}},methods:{goToDetail(){this.$router.push(`/toy/${this.toy._id}`)},goToEdit(){this.$router.push(`/toy/edit/${this.toy._id}`)},removeCar(t){this.$emit("removeToy",t)}}},ze={class:"toy-preview"};function Je(t,e,o,a,s,n){return c(),d("li",ze,[r("h3",null,"Name: "+y(o.toy.name),1),r("p",null,"Price: "+y(o.toy.price),1),r("p",null,"Type: "+y(o.toy.labels),1),r("p",null,y(n.isInStock),1),r("button",{class:"btn",onClick:e[0]||(e[0]=(...l)=>n.goToEdit&&n.goToEdit(...l))},"Edit"),r("button",{class:"btn",onClick:e[1]||(e[1]=(...l)=>n.goToDetail&&n.goToDetail(...l))},"Details"),r("button",{class:"btn",onClick:e[2]||(e[2]=l=>n.removeCar(o.toy._id))},"Delete")])}var Ke=h(We,[["render",Je]]);const Ye={props:{toys:{type:Array,required:!0}},components:{toyPreview:Ke},methods:{removeToy(t){this.$emit("removeToy",t)}}},je={class:"toy-list clean-list"};function He(t,e,o,a,s,n){const l=p("toy-preview");return c(),d("ul",je,[(c(!0),d(C,null,O(o.toys,u=>(c(),U(l,{onRemoveToy:n.removeToy,toy:u,key:u._id},null,8,["onRemoveToy","toy"]))),128))])}var Qe=h(Ye,[["render",He]]);const Xe={name:"toy-filter",data(){return{filterBy:{name:"",inStock:"",labels:[],sortBy:""},options:[{value:"On wheels",label:"On wheels"},{value:"Box game",label:"Box game"},{value:"Art",label:"Art"},{value:"Baby",label:"Baby"},{value:"Doll",label:"Doll"},{value:"Puzzle",label:"Puzzle"},{value:"Outdoor",label:"Outdoor"}]}},methods:{setFilter(){this.$emit("setFilter",JSON.parse(JSON.stringify(this.filterBy)))}}},Ze={class:"toy-filter"},et=T(" Stock: "),tt=r("option",{value:""},"All",-1),ot=r("option",{value:"true"},"In stock",-1),st=r("option",{value:"false"},"Not in stock",-1),rt=[tt,ot,st],nt=T(" Labels: "),it={style:{display:"inline-block","margin-left":"20px"}},lt=T(" Sort By: "),at=r("option",{value:"time"},"Time",-1),ut=r("option",{value:"name"},"Name",-1),ct=r("option",{value:"price"},"Price",-1),dt=[at,ut,ct];function pt(t,e,o,a,s,n){const l=p("el-option"),u=p("el-select");return c(),d("section",Ze,[m(r("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>s.filterBy.name=i),onInput:e[1]||(e[1]=(...i)=>n.setFilter&&n.setFilter(...i)),type:"text",placeholder:"Search toy name..."},null,544),[[v,s.filterBy.name]]),r("label",null,[et,m(r("select",{onChange:e[2]||(e[2]=(...i)=>n.setFilter&&n.setFilter(...i)),"onUpdate:modelValue":e[3]||(e[3]=i=>s.filterBy.inStock=i)},rt,544),[[A,s.filterBy.inStock]])]),r("label",null,[nt,r("div",it,[g(u,{modelValue:s.filterBy.labels,"onUpdate:modelValue":e[4]||(e[4]=i=>s.filterBy.labels=i),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"Select",onChange:n.setFilter,style:{width:"240px"}},{default:w(()=>[(c(!0),d(C,null,O(s.options,i=>(c(),U(l,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),r("label",null,[lt,m(r("select",{onChange:e[5]||(e[5]=(...i)=>n.setFilter&&n.setFilter(...i)),"onUpdate:modelValue":e[6]||(e[6]=i=>s.filterBy.sortBy=i)},dt,544),[[A,s.filterBy.sortBy]])])])])}var yt=h(Xe,[["render",pt]]);const mt={name:"toy-app",data(){return{}},computed:{toys(){return this.$store.getters.toys}},created(){},methods:{setFilter(t){this.$store.dispatch({type:"filter",filterBy:t})},goToEdit(){this.$router.push("/toy/edit")},removeToy(t){this.$store.dispatch({type:"removeToy",id:t})}},components:{toyList:Qe,toyFilter:yt}},gt={class:"toy-app main-layout"};function ht(t,e,o,a,s,n){const l=p("toy-filter"),u=p("toy-list");return c(),d("section",gt,[r("button",{onClick:e[0]||(e[0]=(...i)=>n.goToEdit&&n.goToEdit(...i))},"Add A New Toy"),g(l,{onSetFilter:n.setFilter},null,8,["onSetFilter"]),n.toys?(c(),U(u,{key:0,onRemoveToy:n.removeToy,toys:n.toys},null,8,["onRemoveToy","toys"])):S("",!0)])}var _t=h(mt,[["render",ht]]);E.defaults.withCredentials=!0;const B="/api/toy/",k={query:vt,getById:ft,remove:wt,save:Tt,getEmptyToy:bt};async function vt(t){return(await E.get(B,{params:t})).data}async function ft(t){return(await E.get(B+t)).data}function wt(t){return E.delete(B+t)}async function Tt(t){return t._id?(await E.put(B+t._id,t)).data:(await E.post(B,t)).data}function bt(){return{name:"",price:0,labels:"",reviews:[],type:"",inStock:!0}}const Et={name:"toy-edit",data(){return{isNewToy:null,toyToEdit:null,reviewToEdit:{txt:"",toyId:null},options:[{value:"On wheels",label:"On wheels"},{value:"Box game",label:"Box game"},{value:"Art",label:"Art"},{value:"Baby",label:"Baby"},{value:"Doll",label:"Doll"},{value:"Puzzle",label:"Puzzle"},{value:"Outdoor",label:"Outdoor"}]}},async created(){const{id:t}=this.$route.params;if(t){this.isNewToy=!1,this.reviewToEdit.toyId=t;const e=await k.getById(t);this.toyToEdit=JSON.parse(JSON.stringify(e))}else this.isNewToy=!0,this.toyToEdit=k.getEmptyToy()},methods:{goBack(){this.$router.push("/toy")},async saveToy(){await this.$store.dispatch({type:"saveToy",toy:this.toyToEdit}),this.$router.push("/toy")},async addReview(){await this.$store.dispatch({type:"addReview",review:this.reviewToEdit}),this.reviewToEdit={txt:"",toyId:null},this.$router.push("/toy")}}},St={key:0,class:"toy-edit"},kt={class:"form-control"},Ut=r("label",{for:"name",class:"form-label"},"Toy Name",-1),Ct={class:"form-control"},$t=r("label",{for:"type",class:"form-label"},"Toy Type",-1),xt=r("option",{value:"adult"},"Adult",-1),Bt=r("option",{value:"fun"},"Fun",-1),Ot=r("option",{value:"educational"},"Educational",-1),Rt=[xt,Bt,Ot],Vt={class:"form-control"},Dt=r("label",{for:"price",class:"form-label"},"Toy price",-1),At={class:"form-control"},Lt=r("label",{for:"in-stock",class:"form-label"},"In Stock",-1),Mt={style:{display:"inline-block","margin-left":"20px"}},Nt={class:"btn-group"},It=r("button",null,"Save",-1),Ft={class:"add-review"},Pt=r("h2",null,"Add a Review:",-1),Gt=r("button",null,"Save",-1);function qt(t,e,o,a,s,n){const l=p("el-option"),u=p("el-select");return s.toyToEdit?(c(),d("section",St,[r("form",{onSubmit:e[6]||(e[6]=x((...i)=>n.saveToy&&n.saveToy(...i),["prevent"])),class:"form"},[r("div",kt,[Ut,m(r("input",{required:"","onUpdate:modelValue":e[0]||(e[0]=i=>s.toyToEdit.name=i),id:"name",type:"text",class:"form-input",placeholder:"Enter toy name here..."},null,512),[[v,s.toyToEdit.name]])]),r("div",Ct,[$t,m(r("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>s.toyToEdit.type=i)},Rt,512),[[A,s.toyToEdit.type]])]),r("div",Vt,[Dt,m(r("input",{required:"","onUpdate:modelValue":e[2]||(e[2]=i=>s.toyToEdit.price=i),id:"price",type:"number",class:"form-input"},null,512),[[v,s.toyToEdit.price,void 0,{number:!0}]])]),r("div",At,[Lt,m(r("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>s.toyToEdit.inStock=i),id:"in-stock",type:"checkbox",class:"form-input"},null,512),[[j,s.toyToEdit.inStock]]),r("div",Mt,[g(u,{modelValue:s.toyToEdit.labels,"onUpdate:modelValue":e[4]||(e[4]=i=>s.toyToEdit.labels=i),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"Select",style:{width:"240px"}},{default:w(()=>[(c(!0),d(C,null,O(s.options,i=>(c(),U(l,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),r("div",Nt,[It,r("button",{onClick:e[5]||(e[5]=(...i)=>n.goBack&&n.goBack(...i))},"Go Back")])],32),r("div",Ft,[s.isNewToy?S("",!0):(c(),d("form",{key:0,onSubmit:e[8]||(e[8]=x(i=>n.addReview(),["prevent"]))},[Pt,m(r("textarea",{placeholder:"Your Opinion Matters...","onUpdate:modelValue":e[7]||(e[7]=i=>s.reviewToEdit.txt=i)},null,512),[[v,s.reviewToEdit.txt]]),Gt],32))])])):S("",!0)}var Wt=h(Et,[["render",qt]]);const D={add:Kt,query:zt,remove:Jt};function zt(t){return f.get("review",t)}function Jt(t){return f.delete(`review/${t}`)}async function Kt(t){return await f.post("review",t)}const Yt={name:"toy-chat",data(){return{msg:{from:this.currUser,txt:""},msgs:[],topic:"",typingMsg:""}},created(){const{id:t}=this.$route.params;this.topic=t,b.emit("chat topic",this.topic),b.on("chat addMsg",this.addMsg),b.on("now typing",this.addTyping)},destroyed(){b.off("chat addMsg",this.addMsg),b.off("now typing",this.addTyping)},computed:{currUser(){var t;return((t=_.getLoggedinUser())==null?void 0:t.fullname)||"Guest"}},methods:{addMsg(t){this.msgs.push(t),this.typingMsg=""},addTyping(t){this.typingMsg=t+" is typing..."},sendMsg(){b.emit("chat newMsg",this.msg),this.msg={from:"Me",txt:""},this.typingMsg=""},userTyping(){b.emit("user typing",this.currUser)}}},jt={class:"container"},Ht=r("h2",null,"Lets Chat About Toys!",-1),Qt=r("hr",null,null,-1),Xt={key:0},Zt=r("button",null,"Send",-1);function eo(t,e,o,a,s,n){return c(),d("section",jt,[Ht,r("ul",null,[(c(!0),d(C,null,O(s.msgs,(l,u)=>(c(),d("li",{key:u},[r("span",null,y(l.from)+":",1),T(y(l.txt),1)]))),128))]),Qt,r("form",{onSubmit:e[2]||(e[2]=x((...l)=>n.sendMsg&&n.sendMsg(...l),["prevent"]))},[s.typingMsg?(c(),d("p",Xt,y(s.typingMsg),1)):S("",!0),m(r("input",{type:"text",onInput:e[0]||(e[0]=(...l)=>n.userTyping&&n.userTyping(...l)),"onUpdate:modelValue":e[1]||(e[1]=l=>s.msg.txt=l),placeholder:"Your msg"},null,544),[[v,s.msg.txt]]),Zt],32),r("pre",null,y(n.currUser),1)])}var to=h(Yt,[["render",eo]]);const oo={components:{toyChat:to},name:"toy-detail",data(){return{toy:null,reviews:null}},computed:{isInStock(){return this.toy.inStock?"Item is in stock":"Out of Stock"}},async created(){const{id:t}=this.$route.params,e=await k.getById(t);this.toy=e;const o={toyId:t},a=await D.query(o);console.log(a),console.log(this.toy),this.reviews=a},methods:{goBack(){this.$router.push("/toy")}}},so={key:0,class:"toy-details flex flex-col items-center gap-2"},ro={key:0,class:"reviews"};function no(t,e,o,a,s,n){const l=p("toy-chat");return c(),d(C,null,[s.toy?(c(),d("section",so,[r("article",null,[r("p",null,"ID: "+y(s.toy._id),1),r("p",null,"Name: "+y(s.toy.name),1),r("p",null,"Price: "+y(s.toy.price),1),r("p",null,"Labels: "+y(s.toy.label),1),s.reviews?(c(),d("div",ro,[r("p",null,"Reviews: "+y(s.reviews),1)])):S("",!0),r("p",null,y(n.isInStock),1)]),r("button",{onClick:e[0]||(e[0]=(...u)=>n.goBack&&n.goBack(...u))},"Back")])):S("",!0),g(l)],64)}var io=h(oo,[["render",no]]);H.register(...Q);const lo={components:{DoughnutChart:X},created(){this.toys=this.$store.getters.toys,this.testData.datasets[0].data=[this.educationalToys,this.funToys,this.adultToys]},computed:{educationalToys(){return this.toys.filter(e=>e.type==="educational").length/this.toys.length},funToys(){return this.toys.filter(e=>e.type==="fun").length/this.toys.length},adultToys(){return this.toys.filter(e=>e.type==="adult").length/this.toys.length}},data(){return{toys:null,testData:{labels:["Educational","Fun","Adult"],datasets:[{data:[],backgroundColor:["#77CEFF","#0079AF","#123E6B"]}]}}}},ao=r("h1",null,"Percent of Toys by Type",-1);function uo(t,e,o,a,s,n){const l=p("DoughnutChart");return c(),d("section",null,[ao,g(l,{chartData:s.testData},null,8,["chartData"])])}var co=h(lo,[["render",uo]]);const q=Z({history:ee(),linkActiveClass:"active",routes:[{path:"/",name:"home",component:Me},{path:"/toy",name:"toy-app",component:_t},{path:"/toy/:id",name:"toy-details",component:io},{path:"/toy/edit/:id?",name:"toy-edit",component:Wt},{path:"/dashboard",name:"dashboard",component:co},{path:"/about",name:"about",component:qe}]}),po={state:{toys:null,filterBy:null},getters:{toys(t){return JSON.parse(JSON.stringify(t.toys))}},mutations:{setToys(t,{toys:e}){t.toys=e},removeToy(t,{id:e}){const o=t.toys.findIndex(a=>a._id===e);t.toys.splice(o,1)},saveToy(t,{savedToy:e}){const o=t.toys.findIndex(a=>a._id===e._id);o!==-1?t.toys.splice(o,1,e):t.toys.push(e)},setFilter(t,{filterBy:e}){t.filterBy=e}},actions:{async loadToys({commit:t,state:e}){try{const o=await k.query(e.filterBy);t({type:"setToys",toys:o})}catch(o){console.log("toy module loadtoys cant load toys now",o)}},async removeToy({commit:t},{id:e}){try{await k.remove(e),t({type:"removeToy",id:e})}catch(o){console.log("toy module removetoy cant remove toy now",o)}},async saveToy({commit:t},{toy:e}){try{const o=await k.save(e);t({type:"saveToy",savedToy:o})}catch(o){console.log(o,"cant save now")}},filter({commit:t,dispatch:e},{filterBy:o}){t({type:"setFilter",filterBy:o}),e({type:"loadToys"})}}},yo={state:{reviews:[]},getters:{reviews({reviews:t}){return t}},mutations:{setReviews(t,{reviews:e}){t.reviews=e},addReview(t,{review:e}){t.reviews.push(e)},removeReview(t,{reviewId:e}){t.reviews=t.reviews.filter(o=>o._id!==e)}},actions:{async addReview(t,{review:e}){try{return e=await D.add(e),t.commit({type:"addReview",review:e}),t.dispatch({type:"increaseScore"}),e}catch(o){throw console.log("reviewStore: Error in addReview",o),o}},async loadReviews(t){try{const e=await D.query();t.commit({type:"setReviews",reviews:e}),socketService.off(SOCKET_EVENT_REVIEW_ADDED),socketService.on(SOCKET_EVENT_REVIEW_ADDED,o=>{console.log("Got review from socket",o),t.commit({type:"addReview",review:o})}),socketService.off(SOCKET_EVENT_REVIEW_ABOUT_YOU),socketService.on(SOCKET_EVENT_REVIEW_ABOUT_YOU,o=>{console.log("Review about me!",o)})}catch(e){throw console.log("reviewStore: Error in loadReviews",e),e}},async removeReview(t,{reviewId:e}){try{await D.remove(e),t.commit({type:"removeReview",reviewId:e})}catch(o){throw console.log("reviewStore: Error in removeReview",o),o}}}},mo={state:{loggedinUser:_.getLoggedinUser(),users:[],watchedUser:null},getters:{users({users:t}){return t},loggedinUser({loggedinUser:t}){return t},watchedUser({watchedUser:t}){return t}},mutations:{setLoggedinUser(t,{user:e}){t.loggedinUser=e?P({},e):null},setWatchedUser(t,{user:e}){t.watchedUser=e},setUsers(t,{users:e}){t.users=e},removeUser(t,{userId:e}){t.users=t.users.filter(o=>o._id!==e)},setUserScore(t,{score:e}){t.loggedinUser.score=e}},actions:{async login({commit:t},{userCred:e}){try{const o=await _.login(e);return t({type:"setLoggedinUser",user:o}),o}catch(o){throw console.log("userStore: Error in login",o),o}},async signup({commit:t},{userCred:e}){try{const o=await _.signup(e);return t({type:"setLoggedinUser",user:o}),o}catch(o){throw console.log("userStore: Error in signup",o),o}},async logout({commit:t}){try{await _.logout(),t({type:"setLoggedinUser",user:null})}catch(e){throw console.log("userStore: Error in logout",e),e}},async loadUsers({commit:t}){try{const e=await _.getUsers();t({type:"setUsers",users:e})}catch(e){throw console.log("userStore: Error in loadUsers",e),e}},async loadAndWatchUser({commit:t},{userId:e}){try{const o=await _.getById(e);t({type:"setWatchedUser",user:o}),socketService.off(SOCKET_EVENT_USER_UPDATED),socketService.on(SOCKET_EVENT_USER_UPDATED,a=>{t({type:"setWatchedUser",user:a})})}catch(o){throw console.log("userStore: Error in loadAndWatchUser",o),o}},async removeUser({commit:t},{userId:e}){try{await _.remove(e),t({type:"removeUser",userId:e})}catch(o){throw console.log("userStore: Error in removeUser",o),o}},async updateUser({commit:t},{user:e}){try{e=await _.update(e),t({type:"setUser",user:e})}catch(o){throw console.log("userStore: Error in updateUser",o),o}},async increaseScore({commit:t}){try{const e=await _.changeScore(100);t({type:"setUserScore",score:e})}catch(e){throw console.log("userStore: Error in increaseScore",e),e}}}},go=te({strict:!0,state:{},getters:{},mutations:{},actions:{},modules:{toyStore:po,reviewStore:yo,userStore:mo}});const R=oe(he);R.use(se,{load:{key:""}});R.use(q);R.use(go);R.use(re);R.mount("#app");
